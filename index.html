<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-Koa" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/07/13/Koa/" class="article-date">
  <time class="dt-published" datetime="2025-07-13T08:18:33.000Z" itemprop="datePublished">2025-07-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/07/13/Koa/">Koa</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Koa"><a href="#Koa" class="headerlink" title="Koa"></a>Koa</h1><p>Koa 是一个基于 Node.js 平台的下一代 web 开发框架，由 Express 的原班人马打造。它旨在提供一个更小、更富有表现力、更健壮的基础结构，用于构建 web 应用和 API。Koa 通过使用 async 函数，允许你丢弃回调函数，并极大地增强错误处理能力。Koa 的核心设计理念是中间件（middleware），它通过组合不同的中间件来处理 HTTP 请求。</p>
<p><strong>体积更小，基于async&#x2F;await、组合不同的中间件来处理 HTTP 请求</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Koa</span> = <span class="built_in">require</span>(<span class="string">&#x27;koa&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Koa</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 中间件示例</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> start = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">next</span>();</span><br><span class="line">  <span class="keyword">const</span> ms = <span class="title class_">Date</span>.<span class="title function_">now</span>() - start;</span><br><span class="line">  ctx.<span class="title function_">set</span>(<span class="string">&#x27;X-Response-Time&#x27;</span>, <span class="string">`<span class="subst">$&#123;ms&#125;</span>ms`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">async</span> (ctx) =&gt; &#123;</span><br><span class="line">  ctx.<span class="property">body</span> = <span class="string">&#x27;Hello World&#x27;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Server is running on http://localhost:3000&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>1. 轻量级框架</strong></p>
<p>Koa 的设计哲学是保持核心代码的简洁性，这使得它成为一个非常轻量级的框架。Koa 的核心代码只有几百行，开发者可以很容易地理解其工作原理，并根据需要进行扩展。</p>
<p><strong>2. 中间件机制</strong></p>
<p>Koa 的中间件机制是其最显著的特性之一。Koa 使用洋葱模型来处理中间件，这意味着请求会依次通过所有中间件，然后再依次返回。这种机制使得开发者可以非常灵活地组合和重用中间件。</p>
<p><strong>3. 异步流程控制</strong></p>
<p>Koa 使用 <code>async/await</code> 语法来处理异步操作，这使得异步代码的编写更加简洁和可读。相比于传统的回调函数或 Promise 链，<code>async/await</code> 语法可以避免回调地狱，使代码更加易于维护。</p>
<p><strong>4. 上下文对象</strong></p>
<p>Koa 提供了一个上下文对象（Context），它封装了 Node.js 的 <code>request</code> 和 <code>response</code> 对象。通过上下文对象，开发者可以更方便地访问请求参数、设置响应头、发送响应体等操作。</p>
<p><strong>5. 错误处理</strong></p>
<p>Koa 提供了统一的错误处理机制。开发者可以通过中间件捕获和处理错误，避免错误直接导致应用程序崩溃。Koa 还提供了一个全局的错误事件监听器，可以捕获未处理的异常。</p>
<p><strong>6. 无捆绑中间件</strong></p>
<p>Koa 本身不捆绑任何中间件，这意味着开发者可以根据项目的需求自由选择和组合中间件。这种设计使得 Koa 非常灵活，开发者可以根据具体需求定制自己的中间件栈。</p>
<h2 id="Koa与Express-的区别"><a href="#Koa与Express-的区别" class="headerlink" title="Koa与Express 的区别"></a>Koa与Express 的区别</h2><p>Koa 和 Express 是 Node.js 中两个非常流行的 Web 框架，它们的主要区别如下：</p>
<ol>
<li><strong>中间件机制</strong>：<ul>
<li><strong>Express</strong>：使用传统的回调函数方式处理中间件，支持链式调用。</li>
<li><strong>Koa</strong>：使用 ES6 的 <code>async/await</code> 语法，中间件通过 <code>await next()</code> 来控制流程。</li>
</ul>
</li>
<li><strong>错误处理</strong>：<ul>
<li><strong>Express</strong>：错误处理依赖于中间件的顺序，通常需要在最后添加一个错误处理中间件。</li>
<li><strong>Koa</strong>：通过 <code>try/catch</code> 捕获错误，错误处理更加直观和灵活。</li>
</ul>
</li>
<li><strong>体积和性能</strong>：<ul>
<li><strong>Express</strong>：功能丰富，体积较大。</li>
<li><strong>Koa</strong>：更加轻量，核心功能较少，依赖中间件扩展功能。</li>
</ul>
</li>
<li><strong>上下文对象</strong>：<ul>
<li><strong>Express</strong>：没有内置的上下文对象，需要手动传递 <code>req</code> 和 <code>res</code>。</li>
<li><strong>Koa</strong>：提供了 <code>ctx</code> 对象，封装了 <code>request</code> 和 <code>response</code>，使用更加方便。</li>
</ul>
</li>
<li><strong>路由</strong>：<ul>
<li><strong>Express</strong>：内置了路由功能。</li>
<li><strong>Koa</strong>：没有内置路由，需要借助第三方中间件如 <code>koa-router</code>。</li>
</ul>
</li>
</ol>
<h1 id="Koa-和-Express-的-next-函数有什么区别？"><a href="#Koa-和-Express-的-next-函数有什么区别？" class="headerlink" title="Koa 和 Express 的 next 函数有什么区别？"></a>Koa 和 Express 的 next 函数有什么区别？</h1><p>Koa 和 Express 的 <code>next</code> 函数在中间件处理机制上有显著的区别：</p>
<ul>
<li><strong>Express 的 <code>next</code> 函数</strong>：用于将控制权传递给下一个中间件。如果当前中间件没有结束请求-响应周期，必须调用 <code>next()</code> 来继续执行后续的中间件。如果不调用 <code>next()</code>，请求将会挂起。</li>
<li><strong>Koa 的 <code>next</code> 函数</strong>：Koa 的 <code>next</code> 函数实际上是一个 <code>async</code> 函数，返回一个 <code>Promise</code>。它允许你在中间件中使用 <code>await next()</code> 来等待后续中间件的执行完成。Koa 的中间件是洋葱模型，<code>next()</code> 会依次执行后续中间件，然后再返回到当前中间件继续执行。</li>
</ul>
<h3 id="Express-的-next-函数"><a href="#Express-的-next-函数" class="headerlink" title="Express 的 next 函数"></a>Express 的 <code>next</code> 函数</h3><p>在 Express 中，<code>next</code> 是一个简单的函数调用，用于将控制权传递给下一个中间件。Express 的中间件是线性执行的，每个中间件依次处理请求和响应。如果某个中间件没有调用 <code>next()</code>，请求将会被挂起，后续的中间件不会被执行。</p>
<p>Koa 的 <code>next</code> 函数是一个 <code>async</code> 函数，返回一个 <code>Promise</code>。Koa 的中间件模型是洋葱模型，中间件的执行顺序是从外到内，然后再从内到外。通过 <code>await next()</code>，你可以等待后续中间件的执行完成，然后再继续执行当前中间件的剩余代码。</p>
<h3 id="区别总结"><a href="#区别总结" class="headerlink" title="区别总结"></a>区别总结</h3><ul>
<li><strong>执行模型</strong>：Express 是线性执行模型，Koa 是洋葱模型。</li>
<li><strong><code>next</code> 函数</strong>：Express 的 <code>next</code> 是同步的，Koa 的 <code>next</code> 是异步的，返回 <code>Promise</code>。</li>
<li><strong>控制流程</strong>：在 Express 中，如果不调用 <code>next()</code>，请求会挂起；在 Koa 中，<code>await next()</code> 会等待后续中间件执行完成后再继续执行当前中间件的剩余代码。</li>
</ul>
<h1 id="Koa-的中间件机制是什么？"><a href="#Koa-的中间件机制是什么？" class="headerlink" title="Koa 的中间件机制是什么？"></a>Koa 的中间件机制是什么？</h1><h2 id="推荐答案"><a href="#推荐答案" class="headerlink" title="推荐答案"></a>推荐答案</h2><p>Koa 的中间件机制是基于洋葱模型（Onion Model）的。中间件是一个函数，它接收两个参数：<code>ctx</code>（上下文对象）和 <code>next</code>（下一个中间件的函数）。当调用 <code>next()</code> 时，控制权会传递给下一个中间件，直到最后一个中间件执行完毕，然后再依次返回，执行每个中间件中 <code>next()</code> 之后的代码。这种机制允许中间件在请求和响应的生命周期中执行前置和后置操作。</p>
<h2 id="本题详细解读"><a href="#本题详细解读" class="headerlink" title="本题详细解读"></a>本题详细解读</h2><h3 id="1-洋葱模型"><a href="#1-洋葱模型" class="headerlink" title="1. 洋葱模型"></a>1. 洋葱模型</h3><p>Koa 的中间件机制被称为“洋葱模型”，因为请求和响应的处理过程像剥洋葱一样，从外到内，再从内到外。具体来说，当一个请求进入 Koa 应用时，它会依次经过所有的中间件。每个中间件可以执行一些操作，然后调用 <code>next()</code> 将控制权传递给下一个中间件。当最后一个中间件执行完毕后，控制权会依次返回到之前的中间件，执行 <code>next()</code> 之后的代码。</p>
<h3 id="2-中间件函数"><a href="#2-中间件函数" class="headerlink" title="2. 中间件函数"></a>2. 中间件函数</h3><p>一个典型的 Koa 中间件函数如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">app.use(async (ctx, next) =&gt; &#123;</span><br><span class="line">  // 前置操作</span><br><span class="line">  console.log(&#x27;Before next&#x27;);</span><br><span class="line">  await next();</span><br><span class="line">  // 后置操作</span><br><span class="line">  console.log(&#x27;After next&#x27;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>在这个例子中，<code>console.log(&#39;Before next&#39;)</code> 会在请求进入时执行，而 <code>console.log(&#39;After next&#39;)</code> 会在响应返回时执行。</p>
<h3 id="3-中间件的执行顺序"><a href="#3-中间件的执行顺序" class="headerlink" title="3. 中间件的执行顺序"></a>3. 中间件的执行顺序</h3><p>假设我们有三个中间件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// www.javascriptcn.com code example</span><br><span class="line">app.use(async (ctx, next) =&gt; &#123;</span><br><span class="line">  console.log(&#x27;Middleware 1 - Before next&#x27;);</span><br><span class="line">  await next();</span><br><span class="line">  console.log(&#x27;Middleware 1 - After next&#x27;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.use(async (ctx, next) =&gt; &#123;</span><br><span class="line">  console.log(&#x27;Middleware 2 - Before next&#x27;);</span><br><span class="line">  await next();</span><br><span class="line">  console.log(&#x27;Middleware 2 - After next&#x27;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.use(async (ctx, next) =&gt; &#123;</span><br><span class="line">  console.log(&#x27;Middleware 3 - Before next&#x27;);</span><br><span class="line">  await next();</span><br><span class="line">  console.log(&#x27;Middleware 3 - After next&#x27;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>执行顺序将是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Middleware 1 - Before next</span><br><span class="line">Middleware 2 - Before next</span><br><span class="line">Middleware 3 - Before next</span><br><span class="line">Middleware 3 - After next</span><br><span class="line">Middleware 2 - After next</span><br><span class="line">Middleware 1 - After next</span><br></pre></td></tr></table></figure>

<h3 id="4-错误处理"><a href="#4-错误处理" class="headerlink" title="4. 错误处理"></a>4. 错误处理</h3><p>Koa 中间件还支持错误处理。如果某个中间件抛出错误，可以通过 <code>try-catch</code> 捕获并处理：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// www.javascriptcn.com code example</span><br><span class="line">app.use(async (ctx, next) =&gt; &#123;</span><br><span class="line">  try &#123;</span><br><span class="line">    await next();</span><br><span class="line">  &#125; catch (err) &#123;</span><br><span class="line">    ctx.status = err.status || 500;</span><br><span class="line">    ctx.body = err.message;</span><br><span class="line">    ctx.app.emit(&#x27;error&#x27;, err, ctx);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="5-中间件的组合"><a href="#5-中间件的组合" class="headerlink" title="5. 中间件的组合"></a>5. 中间件的组合</h3><p>Koa 允许将多个中间件组合成一个更大的中间件，使用 <code>koa-compose</code> 库可以实现这一点：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// www.javascriptcn.com code example</span></span><br><span class="line"><span class="keyword">const</span> compose = <span class="built_in">require</span>(<span class="string">&#x27;koa-compose&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">middleware1</span> = <span class="keyword">async</span> (<span class="params">ctx, next</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Middleware 1&#x27;</span>);</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">next</span>();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">middleware2</span> = <span class="keyword">async</span> (<span class="params">ctx, next</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Middleware 2&#x27;</span>);</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">next</span>();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> allMiddleware = <span class="title function_">compose</span>([middleware1, middleware2]);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(allMiddleware);</span><br></pre></td></tr></table></figure>

<h3 id="6-总结"><a href="#6-总结" class="headerlink" title="6. 总结"></a>6. 总结</h3><p>Koa 的中间件机制通过洋葱模型实现了请求和响应的双向处理，使得开发者可以灵活地在请求的不同阶段插入逻辑。这种机制不仅简化了代码结构，还提高了代码的可维护性和可扩展性。</p>
<h1 id="Koa-中间件的洋葱模型是什么？"><a href="#Koa-中间件的洋葱模型是什么？" class="headerlink" title="Koa 中间件的洋葱模型是什么？"></a>Koa 中间件的洋葱模型是什么？</h1><p>Koa 中间件的洋葱模型是指中间件的执行顺序像洋葱一样层层包裹，请求从外层中间件开始，逐层向内传递，经过所有中间件处理后再逐层向外返回响应。这种模型的核心特点是请求和响应都会经过每一个中间件，且中间件的执行顺序是先进后出（FILO）。</p>
<h3 id="洋葱模型的概念"><a href="#洋葱模型的概念" class="headerlink" title="洋葱模型的概念"></a>洋葱模型的概念</h3><p>Koa 的洋葱模型是一种中间件执行机制，它允许请求和响应在多个中间件之间传递。每个中间件都可以对请求进行处理，并将控制权传递给下一个中间件。当所有中间件处理完毕后，响应会按照相反的顺序返回。</p>
<h3 id="洋葱模型的工作流程"><a href="#洋葱模型的工作流程" class="headerlink" title="洋葱模型的工作流程"></a>洋葱模型的工作流程</h3><ol>
<li><strong>请求进入</strong>：请求从最外层的中间件开始，逐层向内传递。</li>
<li><strong>中间件处理</strong>：每个中间件都可以对请求进行处理，并决定是否继续传递请求。</li>
<li><strong>响应返回</strong>：当请求到达最内层的中间件后，响应开始逐层向外返回，经过每个中间件进行最后的处理。</li>
</ol>
<h1 id="Koa-中如何定义中间件？"><a href="#Koa-中如何定义中间件？" class="headerlink" title="Koa 中如何定义中间件？"></a>Koa 中如何定义中间件？</h1><p>在 Koa 中，定义中间件非常简单。中间件是一个函数，它接收两个参数：<code>ctx</code>（上下文对象）和 <code>next</code>（下一个中间件函数）。你可以通过 <code>app.use()</code> 方法来注册中间件。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// www.javascriptcn.com code example</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Koa</span> = <span class="built_in">require</span>(<span class="string">&#x27;koa&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Koa</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个简单的中间件</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;中间件开始&#x27;</span>);</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">next</span>(); <span class="comment">// 调用下一个中间件</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;中间件结束&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义另一个中间件</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">  ctx.<span class="property">body</span> = <span class="string">&#x27;Hello, Koa!&#x27;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Server is running on http://localhost:3000&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>在这个例子中，第一个中间件会在请求开始时打印“中间件开始”，在请求结束时打印“中间件结束”。第二个中间件会设置响应体为“Hello, Koa!”。</p>
<h3 id="中间件的定义"><a href="#中间件的定义" class="headerlink" title="中间件的定义"></a>中间件的定义</h3><p>在 Koa 中，中间件是一个异步函数，它接收两个参数：</p>
<ul>
<li><code>ctx</code>：上下文对象，包含了请求和响应的信息。</li>
<li><code>next</code>：一个函数，用于调用下一个中间件。</li>
</ul>
<h3 id="中间件的执行顺序"><a href="#中间件的执行顺序" class="headerlink" title="中间件的执行顺序"></a>中间件的执行顺序</h3><p>Koa 中间件的执行顺序是按照 <code>app.use()</code> 的注册顺序来执行的。当一个中间件调用 <code>await next()</code> 时，控制权会传递给下一个中间件。当所有中间件都执行完毕后，控制权会返回到上一个中间件，继续执行 <code>await next()</code> 之后的代码。</p>
<h3 id="中间件的用途"><a href="#中间件的用途" class="headerlink" title="中间件的用途"></a>中间件的用途</h3><p>中间件可以用于处理请求、修改响应、记录日志、错误处理等。通过组合不同的中间件，可以构建出复杂的应用程序逻辑。</p>
<h3 id="示例代码解析"><a href="#示例代码解析" class="headerlink" title="示例代码解析"></a>示例代码解析</h3><ol>
<li><strong>第一个中间件</strong>：<ul>
<li>在请求开始时打印“中间件开始”。</li>
<li>调用 <code>await next()</code>，将控制权传递给下一个中间件。</li>
<li>在请求结束时打印“中间件结束”。</li>
</ul>
</li>
<li><strong>第二个中间件</strong>：<ul>
<li>设置响应体为“Hello, Koa!”。</li>
</ul>
</li>
<li><strong>启动服务器</strong>：<ul>
<li>监听 3000 端口，启动 Koa 服务器。</li>
</ul>
</li>
</ol>
<p>通过这种方式，Koa 的中间件机制使得请求处理流程非常灵活和可扩展。</p>
<h3 id="Context-对象的作用"><a href="#Context-对象的作用" class="headerlink" title="Context 对象的作用"></a>Context 对象的作用</h3><p>Koa 的 Context 对象（通常简称为 <code>ctx</code>）是 Koa 框架中处理 HTTP 请求和响应的核心对象。它包含了以下主要功能：</p>
<ol>
<li><strong>封装 <code>request</code> 和 <code>response</code> 对象</strong>：<code>ctx.request</code> 和 <code>ctx.response</code> 分别是对 Node.js 原生 <code>http.IncomingMessage</code> 和 <code>http.ServerResponse</code> 的封装，提供了更简洁的 API 来处理请求和响应。</li>
<li><strong>提供便捷的属性和方法</strong>：<code>ctx</code> 对象提供了许多便捷的属性和方法，例如 <code>ctx.method</code> 获取请求方法，<code>ctx.status</code> 设置响应状态码，<code>ctx.body</code> 设置响应体等。</li>
<li><strong>中间件共享数据</strong>：<code>ctx</code> 对象可以在中间件之间共享数据，通过 <code>ctx.state</code> 可以在不同的中间件中传递数据。</li>
</ol>
<h3 id="Context-对象的常用属性和方法"><a href="#Context-对象的常用属性和方法" class="headerlink" title="Context 对象的常用属性和方法"></a>Context 对象的常用属性和方法</h3><p>以下是一些常用的 <code>ctx</code> 属性和方法：</p>
<ul>
<li><strong><code>ctx.request</code></strong>：封装了请求对象，提供了诸如 <code>ctx.request.method</code>、<code>ctx.request.url</code> 等属性。</li>
<li><strong><code>ctx.response</code></strong>：封装了响应对象，提供了诸如 <code>ctx.response.status</code>、<code>ctx.response.body</code> 等属性。</li>
<li><strong><code>ctx.state</code></strong>：用于在中间件之间共享数据的命名空间。</li>
<li><strong><code>ctx.cookies</code></strong>：用于读取和设置 cookies。</li>
<li><strong><code>ctx.throw([status], [msg], [properties])</code></strong>：用于抛出 HTTP 错误。</li>
<li><strong><code>ctx.assert(value, [status], [msg], [properties])</code></strong>：用于断言，如果 <code>value</code> 为假，则抛出错误。</li>
</ul>
<h1 id="了解浏览器"><a href="#了解浏览器" class="headerlink" title="了解浏览器"></a>了解浏览器</h1><p><strong>主流浏览器</strong> 有五个：IE(Trident内核)、Firefox(火狐：Gecko内核)、Safari(苹果：webkit内核)、Google Chrome(谷歌：Blink内核)、Opera(欧朋：Blink内核)</p>
<p><strong>四大内核</strong>：Trident(IE内核)、Gecko(Firefox内核)、webkit内核、Blink(Chrome内核)</p>
<h3 id="二、了解兼容问题"><a href="#二、了解兼容问题" class="headerlink" title="二、了解兼容问题"></a>二、了解兼容问题</h3><p>W3C对标准的推进，Firefox，Chrome，Safari，Opera的出现，结束了IE雄霸天下的日子。</p>
<p>然而，这对开发者来说，是好事，也是坏事。说它是好事，是因为浏览器厂商为了取得更多的市场份额，会促使各浏览器更符合W3C标准，而得到更好的兼容性，并且，不同浏览器的扩展功能(例如 <code>-moz</code>，<code>-webkit</code> 开头的样式)，对W3C标准也是个推进；说它是坏事，因为，多个浏览器同时存在，这些浏览器在处理一个相同的页面时，表现有时会有差异。这种差异可能很小，甚至不会被注意到；也可能很大，甚至造成在某个浏览器下无法正常浏览。我们把引起这些差异的问题统称为“浏览器兼容性问题”。而正是这些“浏览器兼容性问题”，无形中给我们的开发增加了不少难度。</p>
<p>1、什么是兼容问题？</p>
<p>答：<strong>同样的代码，在不同的浏览器上显示的页面效果不一样</strong></p>
<p>2、不一样的原因是什么？</p>
<p>答：<strong>浏览器各浏览器使用了不同的内核，并且它们处理同一件事情的时候思路不同。</strong></p>
<p>3、为什么浏览器会存在兼容问题？</p>
<ul>
<li>同一浏览器，版本越老，存在 <code>bug</code> 越多，相对于版本越新的浏览器，对新属性和标签、新特性支持越少。</li>
<li>不同浏览器，核心技术(内核)不同，标准不同，实现方式也有差异，最终呈现出来在大众面前的效果也是会有差异。</li>
<li><strong>设计师写出了不规范的代码，不规范的代码会使不兼容现象更加突出</strong>。</li>
</ul>
<p>从浏览器内核的角度来看，浏览器兼容性问题可分为以下三类：</p>
<ul>
<li>渲染相关：和 <strong>样式</strong> 相关的问题，即体现在布局效果上的问题。</li>
<li>脚本相关：和 <strong>脚本</strong> 相关的问题，包括JavaScript和DOM、BOM方面的问题。对于某些浏览器的功能方面的特性，也属于这一类。</li>
<li>其他类别：除以上两类问题外的功能性问题，一般是浏览器自身提供的功能，在内核层之上的。</li>
</ul>
<p>不规则的嵌套：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> 体验AI代码助手 代码解读复制代码<span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">li</span>&gt;</span>新闻标题一<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">li</span>&gt;</span>新闻标题一<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">li</span>&gt;</span>新闻标题一<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>div</code> 中直接嵌套 <code>li</code> 元素是不合标准的，<code>li</code> 应该处于 <code>il</code> 内。此类问题常见的还有 <code>p</code> 中嵌套 <code>div</code>， <code>table</code>等元素。</p>
<p>不规范的DOM接口和属性设置：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">all</span>.<span class="property">a_name</span>.<span class="property">style</span>.<span class="property">top</span> = <span class="number">35</span>;</span><br></pre></td></tr></table></figure>

<p>上面代码中 <code>top</code> 的值，其实应该是一个字符串值，需有单位。例如：<code>35px</code>。</p>
<p>总之，人为的原因也占很大一部分。而人为造成兼容性问题的原因，除了粗心之外，大都源于浏览器bug的存在，和开发者对标准的不了解。</p>
<p>比如，如果要做一个功能，功能是想让鼠标悬停在 <code>img</code> 元素上方时，可以出现提示信息，经常针对 IE 做开发的人，可能会使用 <code>img</code> 元素的 <code>&quot;alt&quot;</code> 属性，但其他浏览器中就是不给 <code>&quot;alt&quot;</code> 属性面子。因为 W3C 标准中规定要去做这件事的属性是 <code>&quot;title&quot;</code>，大多浏览器符合标准，IE 不符合，这是 IE 浏览器内核的问题；开发者不知道 <code>&quot;title&quot;</code> ，不遵循标准去写代码，是开发者的问题。</p>
<p>所以，一个问题分两半，浏览器和开发者都有责任。既然都有责任，就都有义务去解决兼容性问题。那么，从浏览器的角度来讲，它的厂商应该修复浏览器的 <code>bug</code> 和不合标准的地方，当某一天 IE 的 <code>&quot;alt&quot;</code> 不能用于提示了，还有人用这个错误的属性去显示提示么？从开发者角度来讲，多了解标准，了解浏览器兼容性问题，就可以在开发的过程中，有效的避开兼容性问题，让你的页面在所有浏览器中畅通无阻。</p>
<h3 id="三、处理兼容问题的思路"><a href="#三、处理兼容问题的思路" class="headerlink" title="三、处理兼容问题的思路"></a>三、处理兼容问题的思路</h3><p>1、要不要做？</p>
<p>（1）从产品的角度看：产品的受众、受众的浏览器比例、效果优先还是基本功能优先。</p>
<p>（2）成本的角度：有无必要做这个兼容。</p>
<p>2、做到什么程度？</p>
<p>答：让哪些浏览器支持哪些效果。</p>
<p>3、如何做？<br>（1）根据兼容需求选择技术框架&#x2F;库(如  <code>jquery 1.x.x</code> )。<br>（2）根据兼容需求选择兼容工具： <code>html5shiv</code> 、 <code>Respond.js</code> 、 <code>CSS Reset</code> 、 <code>normalize.css</code> 、 <code>Modernizr.js</code> 、 <code>postcss</code> 。<br>（3）条件注释、 <code>CSS Hack</code> 、 <code>js</code> 能力检测做一些修补。<br><code>Hack</code> ： <code>CSS</code> 中， <code>Hack</code> 是指一种兼容 <code>CSS</code> 在不同浏览器中正确显示的技巧方法，修补 <code>bug</code> 的方法<br><code>Filter</code> ：表示过滤器的意思，它是一种对特定的浏览器或浏览器组显示或隐藏规则或声明的方法。本质上讲， <code>Filter</code> 是 <code>hack</code> 方法中的一种。</p>
<p>4、渐进增强和优雅降级<br>（1）<strong>渐进增强</strong>：针对低版本浏览器进行构建页面，保证最基本的功能，然后再针对高级浏览器进行效果、交互等改进和追加功能达到更好的用户体验。<br>（2）<strong>优雅降级</strong>：一开始就构建完整的功能，然后再针对低版本浏览器进行兼容。</p>
<h3 id="四、JavaScript兼容"><a href="#四、JavaScript兼容" class="headerlink" title="四、JavaScript兼容"></a>四、JavaScript兼容</h3><h4 id="1、addEventListener-与-attachEvent-区别"><a href="#1、addEventListener-与-attachEvent-区别" class="headerlink" title="1、addEventListener 与 attachEvent 区别"></a>1、<code>addEventListener</code> 与 <code>attachEvent</code> 区别</h4><p><code>attachEvent</code> ——兼容：IE7、IE8；不兼容firefox、chrome、IE9、IE10、IE11、safari、opera。<br><code>addEventListener</code>——兼容：firefox、chrome、IE、safari、opera；不兼容IE7、IE8<br>解决方案：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">addEvent</span>(<span class="params">elm, evType, fn, useCapture</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (elm.<span class="property">addEventListener</span>) &#123; <span class="comment">// W3C标准</span></span><br><span class="line">    elm.<span class="title function_">addEventListener</span>(evType, fn, useCapture);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (elm.<span class="property">attachEvent</span>) &#123; <span class="comment">// IE</span></span><br><span class="line">    <span class="keyword">var</span> r = elm.<span class="title function_">attachEvent</span>(<span class="string">&#x27;on&#x27;</span> + evType, fn); <span class="comment">// IE5+</span></span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    elm[<span class="string">&#x27;on&#x27;</span> + evType] = fn; <span class="comment">// DOM事件</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2、document-formName-item-itemName-问题"><a href="#2、document-formName-item-itemName-问题" class="headerlink" title="2、document.formName.item(&quot;itemName&quot;) 问题"></a>2、<code>document.formName.item(&quot;itemName&quot;)</code> 问题</h4><p>问题说明：IE下，可以使用 <code>document.formName.item(&quot;itemName&quot;)</code> 或 <code>document.formName.elements [&quot;elementName&quot;]</code>；Firefox 下，只能使用 <code>document.formName.elements[&quot;elementName&quot;]</code>。<br>解决方案：统一使用 <code>document.formName.elements[&quot;elementName&quot;]</code>。</p>
<h4 id="3、集合类对象问题"><a href="#3、集合类对象问题" class="headerlink" title="3、集合类对象问题"></a>3、集合类对象问题</h4><p>问题说明：IE下，可以使用 <code>()</code> 或 <code>[]</code> 获取集合类对象；Firefox下，只能使用 <code>[ ]</code> 获取集合类对象。<br>解决方案：统一使用 <code>[]</code> 获取集合类对象。</p>
<h4 id="4、自定义属性问题"><a href="#4、自定义属性问题" class="headerlink" title="4、自定义属性问题"></a>4、自定义属性问题</h4><p>问题说明：IE下，可以使用获取常规属性的方法来获取自定义属性，也可以使用 <code>getAttribute()</code> 获取自定义属性；Firefox下，只能使用 <code>getAttribute()</code> 获取自定义属性。<br>解决方案：统一通过 <code>getAttribute()</code> 获取自定义属性。</p>
<h4 id="5、eval-idName-问题"><a href="#5、eval-idName-问题" class="headerlink" title="5、eval(&quot;idName&quot;) 问题"></a>5、<code>eval(&quot;idName&quot;)</code> 问题</h4><p>问题说明：IE下，可以使用 <code>eval(&quot;idName&quot;)</code> 或 <code>getElementById(&quot;idName&quot;)</code>  来取得 <code>id</code> 为 <code>idName</code> 的HTML对象；Firefox下，只能使用 <code>getElementById(&quot;idName&quot;)</code> 来取得 <code>id</code> 为 <code>idName</code> 的HTML对象。<br>解决方案：统一用 <code>getElementById(&quot;idName&quot;)</code> 来取得 <code>id</code> 为 <code>idName</code> 的HTML对象。</p>
<h4 id="6、变量名与某HTML对象ID相同的问题"><a href="#6、变量名与某HTML对象ID相同的问题" class="headerlink" title="6、变量名与某HTML对象ID相同的问题"></a>6、变量名与某HTML对象ID相同的问题</h4><p>问题说明：IE下，HTML对象的ID可以作为 <code>document</code> 的下属对象变量名直接使用，Firefox下则不能；Firefox下，可以使用与HTML对象ID相同的变量名，IE下则不能。<br>解决方案：使用 <code>document.getElementById(&quot;idName&quot;)</code> 代替 <code>document.idName</code>。最好不要取HTML对象ID相同的变量名，以减少错误；在声明变量时，一律加上 <code>var</code> 关键字，以避免歧义。</p>
<h4 id="7、const-问题"><a href="#7、const-问题" class="headerlink" title="7、const 问题"></a>7、<code>const</code> 问题</h4><p>问题说明：Firefox下，可以使用 <code>const</code> 关键字或 <code>var</code> 关键字来定义常量；IE下，只能使用 <code>var</code> 关键字来定义常量。<br>解决方案：统一使用 <code>var</code> 关键字来定义常量。</p>
<h4 id="8、input-type属性问题"><a href="#8、input-type属性问题" class="headerlink" title="8、input.type属性问题"></a>8、<code>input.type</code>属性问题</h4><p>问题说明：IE下 <code>input.type</code> 属性为只读；但是Firefox下 <code>input.type</code> 属性为读写。<br>解决方案：不修改 <code>input.type</code> 属性。如果必须要修改，可以先隐藏原来的 <code>input</code>，然后在同样的位置再插入一个新的 <code>input</code> 元素。</p>
<h4 id="9、window-event-问题"><a href="#9、window-event-问题" class="headerlink" title="9、window.event 问题"></a>9、<code>window.event</code> 问题</h4><p>问题说明：<code>window.event</code> 只能在IE下运行，而不能在Firefox下运行，这是因为Firefox的 <code>event</code> 只能在事件发生的现场使用。<br>解决方案：在事件发生的函数上加上 <code>event</code> 参数，在函数体内(假设形参为 <code>evt</code> )使用 <code>var myEvent = evt?evt:(window.event? window.event:null)</code><br>示例：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;doSomething(event)&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">&quot;javascript&quot;</span>&gt;</span><span class="language-javascript"> </span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">doSomething</span>(<span class="params">evt</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">var</span> myEvent = evt ? evt :(<span class="variable language_">window</span>.<span class="property">event</span> ? <span class="variable language_">window</span>.<span class="property">event</span> : <span class="literal">null</span>);</span></span><br><span class="line"><span class="language-javascript">		…</span></span><br><span class="line"><span class="language-javascript">	&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="10、event-x-与-event-y-问题"><a href="#10、event-x-与-event-y-问题" class="headerlink" title="10、event.x 与 event.y 问题"></a>10、<code>event.x</code> 与 <code>event.y</code> 问题</h4><p>问题说明：IE下，<code>event</code> 对象有 <code>x</code>、<code>y</code> 属性，但是没有 <code>pageX</code>、<code>pageY</code>属性；Firefox下，<code>event</code> 对象有<code>pageX</code>、<code>pageY</code>属性，但是没有 <code>x</code>、<code>y</code>属性。<br>解决方案：<code>var myX = event.x ? event.x : event.pageX; var myY = event.y ? event.y:event.pageY;</code><br>如果考虑第8条问题，就改用 <code>myEvent</code> 代替 <code>event</code> 即可。</p>
<h4 id="11、event-srcElement-问题"><a href="#11、event-srcElement-问题" class="headerlink" title="11、event.srcElement 问题"></a>11、<code>event.srcElement</code> 问题</h4><p>问题说明：IE下，<code>event</code> 对象有 <code>srcElement</code> 属性，但是没有 <code>target</code> 属性；Firefox下，<code>event</code> 对象有<code>target</code> 属性，但是没有 <code>srcElement</code> 属性。<br>解决方案：使用 <code>srcObj = event.srcElement ? event.srcElement : event.target;</code><br>如果考虑第8条问题，就改用 <code>myEvent</code> 代替 <code>event</code> 即可。</p>
<h4 id="12、window-location-href-问题"><a href="#12、window-location-href-问题" class="headerlink" title="12、window.location.href 问题"></a>12、<code>window.location.href</code> 问题</h4><p>问题说明：IE或者Firefox2.0.x下，可以使用 <code>window.location</code> 或 <code>window.location.href</code>；Firefox1.5.x下，只能使用 <code>window.location</code>。<br>解决方案：使用 <code>window.location</code> 来代替 <code>window.location.href</code> 。当然也可以考虑使用 <code>location.replace()</code>方法。</p>
<h4 id="13、模态和非模态窗口问题"><a href="#13、模态和非模态窗口问题" class="headerlink" title="13、模态和非模态窗口问题"></a>13、模态和非模态窗口问题</h4><p>问题说明：IE下，可以通过 <code>showModalDialog</code> 和 <code>showModelessDialog</code> 打开模态和非模态窗口；Firefox下则不能。<br>解决方案：直接使用 <code>window.open(pageURL,name,parameters)</code> 方式打开新窗口。<br>如果需要将子窗口中的参数传递回父窗口，可以在子窗口中使用 <code>window.opener</code> 来访问父窗口。如果需要父窗口控制子窗口的话，使用 <code>var subWindow = window.open(pageURL,name,parameters);</code> 来获得新开的窗口对象。</p>
<h4 id="14、frame-和-iframe-问题"><a href="#14、frame-和-iframe-问题" class="headerlink" title="14、frame 和 iframe 问题"></a>14、<code>frame</code> 和 <code>iframe</code> 问题</h4><p>以下面的 <code>frame</code>为例：<br>(1)访问 <code>frame</code> 对象<br>IE：使用 <code>window.frameId</code> 或者 <code>window.frameName</code> 来访问这个 <code>frame</code> 对象；<br>Firefox：使用 <code>window.frameName</code> 来访问这个 <code>frame</code> 对象；<br>解决方案：统一使用 <code>window.document.getElementById(&quot;frameId&quot;)</code> 来访问这个 <code>frame</code> 对象；<br>(2)切换 <code>frame</code> 内容<br>在IE和Firefox中都可以使用 <code>window.document.getElementById(&quot;frameId&quot;).src = &quot;webjx.com.html&quot;</code>  或<code>window.frameName.location = &quot;webjx.com.html&quot;</code> 来切换 <code>frame</code> 的内容；<br>如果需要将 <code>frame</code> 中的参数传回父窗口，可以在 <code>frame</code> 中使用 <code>parent</code> 关键字来访问父窗口。</p>
<h4 id="15、事件委托方法"><a href="#15、事件委托方法" class="headerlink" title="15、事件委托方法"></a>15、事件委托方法</h4><p>问题说明：IE下，使用 <code>document.body.onload = inject;</code> ， 其中 <code>function inject()</code> 在这之前已被实现；在Firefox下，使用 <code>document.body.onload = inject();</code><br>解决方案：统一使用 <code>document.body.onload=new Function(&quot;inject()&quot;); </code> 或者 <code>document.body.onload = function()&#123;&#125;</code><br>[注意] <code>Function</code> 和 <code>function</code> 的区别</p>
<h4 id="16、用-setAttribute-设置事件"><a href="#16、用-setAttribute-设置事件" class="headerlink" title="16、用 setAttribute 设置事件"></a>16、用 <code>setAttribute</code> 设置事件</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;objId&quot;</span>);</span><br><span class="line">obj.<span class="title function_">setAttribute</span>(<span class="string">&quot;onclick&quot;</span>, <span class="string">&quot;funcitonname()&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>FireFox 支持，IE不支持。<br>解决方案：IE中必须用点记法来引用所需的事件处理程序,并且要用赋予匿名函数；如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;objId&quot;</span>);</span><br><span class="line">obj.<span class="property">onclic</span> k= <span class="keyword">function</span>(<span class="params"></span>)&#123; <span class="title function_">fucntionname</span>(); &#125;;</span><br></pre></td></tr></table></figure>

<p>这种方法所有浏览器都支持</p>
<h4 id="17、访问的父元素的区别"><a href="#17、访问的父元素的区别" class="headerlink" title="17、访问的父元素的区别"></a>17、访问的父元素的区别</h4><p>问题说明：在IE下，使用 <code>obj.parentElement</code> 或 <code>obj.parentNode</code>  访问 <code>obj</code> 的父结点；在FireFox下，使用<code>obj.parentNode</code> 访问 <code>obj</code> 的父结点。<br>解决方案：因为FireFox与IE都支持DOM，因此统一使用 <code>obj.parentNode</code> 来访问 <code>obj</code> 的父结点。</p>
<h4 id="18、innerText-的问题"><a href="#18、innerText-的问题" class="headerlink" title="18、innerText 的问题."></a>18、<code>innerText</code> 的问题.</h4><p>问题说明：<code>innerText</code> 在IE中能正常工作，但是 <code>innerText</code> 在FireFox中却不行。<br>解决方案：在非IE浏览器中使用 <code>textContent</code> 代替 <code>innerText</code>。<br>示例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (navigator.<span class="property">appName</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;Explorer&quot;</span>) &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;element&quot;</span>).<span class="property">innerText</span> = <span class="string">&quot;my text&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;element&quot;</span>).<span class="property">textContent</span> = <span class="string">&quot;my text&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>[注] <code>innerHTML</code> 同时被IE、FireFox等浏览器支持，其他的，如 <code>outerHTML</code> 等只被IE支持，最好不用。</p>
<h4 id="19、Table-操作问题"><a href="#19、Table-操作问题" class="headerlink" title="19、Table 操作问题"></a>19、<code>Table</code> 操作问题</h4><p>问题说明：IE、FireFox以及其它浏览器对于 <code>table</code> 标签的操作都各不相同，在IE中不允许对 <code>table</code> 和 <code>tr</code> 的<code>innerHTML</code> 赋值，使用js 增加一个 <code>tr</code> 时，使用 <code>appendChild</code> 方法也不管用。<code>document.appendChild</code> 在往表里插入行时FireFox支持，IE不支持<br>解决方案：把行插入到 <code>tbody</code>中，不要直接插入到表解决方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 向table追加一个空行：</span></span><br><span class="line"><span class="keyword">var</span> row = otable.<span class="title function_">insertRow</span>(-<span class="number">1</span>);</span><br><span class="line"><span class="keyword">var</span> cell = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;td&quot;</span>); </span><br><span class="line">cell.<span class="property">innerHTML</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">cell.<span class="property">className</span> = <span class="string">&quot;XXXX&quot;</span>; </span><br><span class="line">row.<span class="title function_">appendChild</span>(cell);</span><br></pre></td></tr></table></figure>

<p>[注] 建议使用JS框架集来操作 <code>table</code>，如JQuery。</p>
<h4 id="20、对象宽高赋值问题"><a href="#20、对象宽高赋值问题" class="headerlink" title="20、对象宽高赋值问题"></a>20、对象宽高赋值问题</h4><p>问题说明：FireFox中类似 <code>obj.style.height = imgObj.height</code> 的语句无效。<br>解决方案：统一使用<code>obj.style.height = imgObj.height + &quot;px&quot;;</code></p>
<h4 id="21、setAttribute-style-color-red"><a href="#21、setAttribute-style-color-red" class="headerlink" title="21、setAttribute(&quot;style&quot;, &quot;color: red;&quot;)"></a>21、<code>setAttribute(&quot;style&quot;, &quot;color: red;&quot;)</code></h4><p>FireFox支持(除了IE，现在所有浏览器都支持)，IE不支持<br>解决方案：不用 <code>setAttribute(&quot;style&quot;, &quot;color : red;&quot;)</code><br>而用 <code>object.style.cssText = &quot;color: red;&quot;</code>(这写法也有例外)<br>最好的办法是上面种方法都用上，万无一失</p>
<h4 id="22、类名设置-setAttribute-class-styleClass"><a href="#22、类名设置-setAttribute-class-styleClass" class="headerlink" title="22、类名设置 setAttribute(&quot;class&quot;, &quot;styleClass&quot;)"></a>22、类名设置 <code>setAttribute(&quot;class&quot;, &quot;styleClass&quot;)</code></h4><p>FireFox支持，IE不支持(指定属性名为 <code>class</code>，IE不会设置元素的 <code>class</code> 属性，相反只使用 <code>setAttribute</code> 时IE自动识 <code>classname</code> 属性)<br>解决方案：<br><code>setAttribute(&quot;class&quot;, &quot;styleClass&quot;)</code><br><code>setAttribute(&quot;className&quot;, &quot;styleClass&quot;)</code><br>或者直接 <code>object.className= &quot;styleClass&quot;;</code><br>IE和FF都支持 <code>object.className</code>。</p>
<h4 id="23、建立单选钮"><a href="#23、建立单选钮" class="headerlink" title="23、建立单选钮"></a>23、建立单选钮</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// IE以外的浏览器</span></span><br><span class="line"><span class="keyword">var</span> rdo = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;input&quot;</span>);</span><br><span class="line">rdo.<span class="title function_">setAttribute</span>(<span class="string">&quot;type&quot;</span>, <span class="string">&quot;radio&quot;</span>); </span><br><span class="line">rdo.<span class="title function_">setAttribute</span>(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;radiobtn&quot;</span>); </span><br><span class="line">rdo.<span class="title function_">setAttribute</span>(<span class="string">&quot;value&quot;</span>, <span class="string">&quot;checked&quot;</span>);</span><br><span class="line"><span class="comment">// IE</span></span><br><span class="line"><span class="keyword">var</span> rdo = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;&lt;input name=&quot;</span>radiobtn<span class="string">&quot; type=&quot;</span>radio<span class="string">&quot; value=&quot;</span>checked<span class="string">&quot; /&gt;&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>解决方案：<br>这一点区别和前面的都不一样。这次完全不同，所以找不到共同的办法来解决，那么只有 <code>IF-ELSE</code>了<br>万幸的是，IE可以识别出 <code>document</code> 的 <code>uniqueID</code> 属性，别的浏览器都不可以识别出这一属性。问题解决。<br>​</p>
<h3 id="五、CSS兼容"><a href="#五、CSS兼容" class="headerlink" title="五、CSS兼容"></a>五、CSS兼容</h3><h4 id="1、CSS-Hack"><a href="#1、CSS-Hack" class="headerlink" title="1、CSS Hack"></a>1、<code>CSS Hack</code></h4><p>使用 <code>hacker</code> 可以把浏览器分为3类：IE6；IE7和遨游；其他（IE8 Chrome ff Safari opera等）<br>（1）IE6认识的 <code>hacker</code> 是 下划线 <code>_</code> 和星号 <code>*</code><br>（2）IE7和遨游认识的  <code>hacker</code> 是 星号  <code>*</code><br> 如： <code>height:300px;*height:200px;_height:100px;</code><br> （1）IE6浏览器在读到 <code>height:300px</code> 的时候会认为高时 <code>300px</code><br> 继续往下读，他也认识 <code>*heihgt</code> ， 所以当IE6读到 <code>*height:200px</code> 的时候会覆盖掉前一条的相冲突设置，认为高度是 <code>200px</code> 。<br> 继续往下读，IE6还认识 <code>_height</code> ,所以他又会覆盖掉 <code>200px</code> 高的设置，把高度设置为 <code>100px</code> 。<br> （2）IE7和遨游也是一样的从高度 <code>300px</code> 的设置往下读。当它们读到 <code>*height:200px</code> 的时候就停下了，因为它们不认识 <code>_height</code> 。<br> 所以它们会把高度解析为 <code>200px</code> ，剩下的浏览器只认识第一个 <code>height:300px</code> ;<br> 所以他们会把高度解析为 <code>300px</code> 。因为优先级相同且想冲突的属性设置后一个会覆盖掉前一个，所以书写的次序是很重要的。</p>
<h4 id="2、CSS-样式兼容不同浏览器问题"><a href="#2、CSS-样式兼容不同浏览器问题" class="headerlink" title="2、CSS 样式兼容不同浏览器问题"></a>2、CSS 样式兼容不同浏览器问题</h4><p>所有浏览器通用： <code>height: 100px;</code><br>IE6 专用： <code>_height: 100px;</code> 或者 <code>*height: 100px;</code><br>IE7 专用： <code>*+height: 100px;</code><br>IE7、FF 共用： <code>height: 100px !important;</code><br>以下两种方法几乎能解决现今所有兼容：<br>（1） <code>!important</code><br>随着IE7对 <code>!important</code> 的支持, <code>!important </code> 方法现在只针对IE6的兼容(注意写法，记得该声明位置需要提前)</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span> <span class="meta">!important</span>; <span class="comment">/* IE7+FF */</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">80px</span>; <span class="comment">/* IE6 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>(2)IE6&#x2F;IE77对FireFox &lt;from 针对FireFox ie6 ie7的css样式&gt;<br><code>*+html</code> 与 <code>*html</code> 是IE特有的标签，FireFox 暂不支持。而 <code>*+html</code> 又为 IE7特有标签。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123; <span class="attribute">width</span>: <span class="number">120px</span>; &#125; <span class="comment">/* FireFox */</span></span><br><span class="line">*<span class="selector-tag">html</span> <span class="selector-class">.box</span> &#123; <span class="attribute">width</span>: <span class="number">80px</span>;&#125; <span class="comment">/* ie6 fixed */</span></span><br><span class="line">*+<span class="selector-tag">html</span> <span class="selector-class">.box</span> &#123; <span class="attribute">width</span>: <span class="number">60px</span>;&#125; <span class="comment">/* ie7 fixed, 注意顺序 */</span></span><br></pre></td></tr></table></figure>

<h4 id="3、万能-float-闭合-非常重要-可以用这个解决多个-div-对齐时的间距不对"><a href="#3、万能-float-闭合-非常重要-可以用这个解决多个-div-对齐时的间距不对" class="headerlink" title="3、万能 float 闭合(非常重要) 可以用这个解决多个 div 对齐时的间距不对"></a>3、万能 <code>float</code> 闭合(非常重要) 可以用这个解决多个 <code>div</code> 对齐时的间距不对</h4><p>将以下代码加入 <code>Global CSS</code> 中，给需要闭合的 <code>div</code> 加上 <code>class=&quot;clearfix&quot;</code> 即可，屡试不爽。<br>代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line"><span class="comment">/* Clear Fix */</span></span><br><span class="line"><span class="selector-class">.clearfix</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&quot;.&quot;</span>;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">clear</span>: both;</span><br><span class="line">    <span class="attribute">visibility</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.clearfix</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* Hide from IE Mac \*/</span></span><br><span class="line"><span class="selector-class">.clearfix</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>:block;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* End hide from IE Mac */</span></span><br><span class="line"><span class="comment">/* end of clearfix */</span></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="4、其他兼容技巧"><a href="#4、其他兼容技巧" class="headerlink" title="4、其他兼容技巧"></a>4、其他兼容技巧</h4><ol>
<li>Firefox下给 <code>div</code> 设置 <code>padding</code> 后会导致 <code>width</code> 和 <code>height</code> 增加, 但IE不会(可用 <code>!important</code> 解决)</li>
<li>居中问题：<ol>
<li>垂直居中将 <code>line-height</code> 设置为当前 <code>div</code> 相同的高度, 再通过 <code>vetical-align: middle</code> ( 注意内容不要换行）</li>
<li>水平居中： <code>margin: 0 auto;</code> (当然不是万能)</li>
</ol>
</li>
<li>若需给 <code>a</code> 标签内内容加上 样式，需要设置 <code>display: block;</code> (常见于导航标签)</li>
<li>Firefox 和 IE 对 BOX 理解的差异导致相差 <code>2px</code> 的还有设为 <code>float</code> 的 <code>div</code> 在 ie下 <code>margin</code> 加倍等问题</li>
<li><code>ul</code> 标签在 FF 下面默认有 <code>list-style</code> 和 <code>padding</code> 最好事先声明，以避免不必要的麻烦(常见于导航标签和内容列表)</li>
<li>作为外部 <code>wrapper</code> 的 <code>div</code> 不要定死高度，最好还加上 <code>overflow: hidden</code> 以达到高度自适应</li>
</ol>
<h4 id="5、兼容代码：兼容最推荐的模式。"><a href="#5、兼容代码：兼容最推荐的模式。" class="headerlink" title="5、兼容代码：兼容最推荐的模式。"></a>5、兼容代码：兼容最推荐的模式。</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* FF */</span></span><br><span class="line"><span class="selector-class">.submitbutton</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>: left;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">40px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">57px</span>;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">24px</span>;</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">12px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* IE6 */</span></span><br><span class="line">*<span class="selector-tag">html</span> <span class="selector-class">.submitbutton</span> &#123;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">21px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* IE7 */</span></span><br><span class="line">*+<span class="selector-tag">html</span> <span class="selector-class">.submitbutton</span> &#123;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">21px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="6、兼容-CSS-方法"><a href="#6、兼容-CSS-方法" class="headerlink" title="6、兼容 CSS 方法"></a>6、兼容 <code>CSS</code> 方法</h4><p>做兼容页面的方法是：每写一小段代码（布局中的一行或者一块）我们都要在不同的浏览器中看是否兼容，当然熟练到一定的程度就没这么麻烦了。<br>建议经常会碰到兼容性问题的新手使用。很多兼容性问题都是因为浏览器对标签的默认属性解析不同造成的，只要我们稍加设置都能轻松地解决这些兼容问题。<br>如果我们熟悉标签的默认属性的话，就能很好的理解为什么会出现兼容问题以及怎么去解决这些兼容问题。</p>
<h3 id="六、其它CSS兼容"><a href="#六、其它CSS兼容" class="headerlink" title="六、其它CSS兼容"></a>六、其它CSS兼容</h3><h4 id="1、不同浏览器的标签默认margin-和-padding-不同"><a href="#1、不同浏览器的标签默认margin-和-padding-不同" class="headerlink" title="1、不同浏览器的标签默认margin 和 padding 不同"></a>1、不同浏览器的标签默认<code>margin</code> 和 <code>padding</code> 不同</h4><p>问题说明：随便写几个标签，不加样式控制的情况下，各自的 <code>margin</code> 和 <code>padding</code> 差异较大。<br>解决方案： <code>CSS: *&#123;margin: 0;padding:0;&#125;</code> </p>
<h4 id="2、块属性标签-float-后，又有横行的-margin-情况下，在IE6显示-margin-比设置的大"><a href="#2、块属性标签-float-后，又有横行的-margin-情况下，在IE6显示-margin-比设置的大" class="headerlink" title="2、块属性标签 float 后，又有横行的 margin 情况下，在IE6显示 margin 比设置的大"></a>2、块属性标签 <code>float</code> 后，又有横行的 <code>margin</code> 情况下，在IE6显示 <code>margin</code> 比设置的大</h4><p>问题说明：常见症状是IE6中后面的一块被顶到下一行（ <code>float</code> 布局最常见的浏览器兼容问题）<br>解决方案：在 <code>float</code> 的标签样式控制中加入 <code>display:inline;</code> 将其转化为行内属性<br>备注：我们最常用的就是 <code>div+CSS</code> 布局了，而 <code>div</code>就是一个典型的块属性标签，横向布局的时候我们通常都是用 <code>div float</code> 实现的，横向的间距设置如果用 <code>margin</code> 实现，这就是一个必然会碰到的兼容性问题。</p>
<h4 id="3、较小高度标签（一般小于-10px-）问题"><a href="#3、较小高度标签（一般小于-10px-）问题" class="headerlink" title="3、较小高度标签（一般小于 10px ）问题"></a>3、较小高度标签（一般小于 <code>10px</code> ）问题</h4><p>问题说明：IE6、7和遨游里这个标签的高度不受控制，超出自己设置的高度<br>解决方案：给超出高度的标签设置 <code>overflow:hidden;</code> 或者设置行高 <code>line-height</code> 小于你设置的高度。<br>备注：这种情况一般出现在我们设置小圆角背景的标签里。出现这个问题的原因是IE8之前的浏览器都会给标签一个最小默认的行高的高度。即使你的标签是空的，这个标签的高度还是会达到默认的行高。</p>
<h4 id="4、行内属性标签，设置-display-block-后采用-float-布局，又有横行的-margin-的情况，IE6间距-bug"><a href="#4、行内属性标签，设置-display-block-后采用-float-布局，又有横行的-margin-的情况，IE6间距-bug" class="headerlink" title="4、行内属性标签，设置 display:block 后采用 float 布局，又有横行的 margin 的情况，IE6间距 bug"></a>4、行内属性标签，设置 <code>display:block</code> 后采用 <code>float</code> 布局，又有横行的 <code>margin</code> 的情况，IE6间距 <code>bug</code></h4><p>问题说明：IE6里的间距比超过设置的间距<br>解决方案：在 <code>display:block;</code> 后面加入 <code>display:inline;display:table;</code><br>备注：行内属性标签，为了设置宽高，我们需要设置 <code>display:block;</code> (除了 <code>input</code> 标签比较特殊)。<br>在用 <code>float</code> 布局并有横向的 <code>margin</code> 后，在IE6下，他就具有了块属性 <code>float</code> 后的横向 <code>margin</code> 的 <code>bug</code> 。<br>不过因为它本身就是行内属性标签，所以我们再加上 <code>display:inline</code> 的话，它的高宽就不可设了。<br>这时候我们还需要在 <code>display:inline</code> 后面加入 <code>display:talbe</code> 。</p>
<h4 id="5、图片默认有间距"><a href="#5、图片默认有间距" class="headerlink" title="5、图片默认有间距"></a>5、图片默认有间距</h4><p>问题说明：几个 <code>img</code> 标签放在一起的时候，有些浏览器会有默认的间距，加了问题一中提到的通配符也不起作用。<br>解决方案：使用 <code>float</code> 属性为 <code>img</code> 布局<br>备注：因为 <code>img</code> 标签是行内属性标签，所以只要不超出容器宽度， <code>img</code> 标签都会排在一行里，但是部分浏览器的 <code>img</code> 标签之间会有个间距。去掉这个间距使用 <code>float</code> 是正道。</p>
<h4 id="6、标签最低高度设置-min-height-不兼容"><a href="#6、标签最低高度设置-min-height-不兼容" class="headerlink" title="6、标签最低高度设置 min-height 不兼容"></a>6、标签最低高度设置 <code>min-height</code> 不兼容</h4><p>问题说明：因为 <code>min-height</code> 本身就是一个不兼容的 <code>CSS</code> 属性，所以设置 <code>min-height</code> 时不能很好的被各个浏览器兼容<br>解决方案：如果我们要设置一个标签的最小高度 <code>200px</code> ，需要进行的设置为：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123; </span><br><span class="line">  <span class="attribute">min-height</span>: <span class="number">200px</span>; </span><br><span class="line">  <span class="attribute">height</span>: auto <span class="meta">!important</span>; </span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>; </span><br><span class="line">  <span class="attribute">overflow</span>:visible;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>备注：在B&#x2F;S系统前端开时，有很多情况下我们又这种需求。当内容小于一个值（如 <code>300px</code> ）时。容器的高度为 <code>300px</code> ；当内容高度大于这个值时，容器高度被撑高，而不是出现滚动条。这时候我们就会面临这个兼容性问题。</p>
<h4 id="7、CSS-布局中的居中问题"><a href="#7、CSS-布局中的居中问题" class="headerlink" title="7、CSS 布局中的居中问题"></a>7、CSS 布局中的居中问题</h4><p>问题说明： 首先在父级元素定义 <code>text-align: center;</code> 这个的意思就是在父级元素内的内容居中；对于IE这样设定就已经可以了。但在mozilla中不能居中。<br>解决办法：在子元素定义时候设定时再加上 <code>margin-right: auto; margin-left: auto; </code> </p>
<h4 id="8、IE浮动产生的双倍距离"><a href="#8、IE浮动产生的双倍距离" class="headerlink" title="8、IE浮动产生的双倍距离"></a>8、IE浮动产生的双倍距离</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#box</span> &#123; </span><br><span class="line">  <span class="attribute">float</span>: left; </span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>; </span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">100px</span>; // 这种情况之下IE会产生<span class="number">200px</span>的距离</span><br><span class="line">  <span class="attribute">display</span>: inline; // 使浮动忽略</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里细说一下 <code>block</code>， <code>inline</code> 两个元素<br><code>Block</code> 元素的特点是：总是在新行上开始，高度、宽度、行高、边距都可以控制(块元素)<br><code>Inline</code> 元素的特点是：和其他元素在同一行上，不可控制(内嵌元素)</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#box</span> &#123; </span><br><span class="line">  <span class="attribute">display</span>: block; // 可以为内嵌元素模拟为块元素 </span><br><span class="line">  <span class="attribute">display</span>: inline; // 实现同一行排列的的效果 </span><br><span class="line">  diplay: table;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="9、IE与宽度和高度的问题"><a href="#9、IE与宽度和高度的问题" class="headerlink" title="9、IE与宽度和高度的问题"></a>9、IE与宽度和高度的问题</h4><p>IE不认得 <code>min-</code> 这个定义，但实际上它把正常的 <code>width</code> 和 <code>height</code> 当作有 <code>min</code> 的情况来使。<br>这样问题就大了，如果只用宽度和高度，正常的浏览器里这两个值就不会变，如果只用 <code>min-width</code> 和 <code>min-height</code> 的话，IE下面根本等于没有设置宽度和高度。<br>比如要设置背景图片，这个宽度是比较重 要的。<br>解决方案：要解决这个问题，可以这样：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#box</span> &#123; </span><br><span class="line">  <span class="attribute">width</span>: <span class="number">80px</span>; </span><br><span class="line">  <span class="attribute">height</span>: <span class="number">35px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">html</span>&gt;<span class="selector-tag">body</span> <span class="selector-id">#box</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: auto; </span><br><span class="line">  <span class="attribute">height</span>: auto; </span><br><span class="line">  <span class="attribute">min-width</span>: <span class="number">80px</span>; </span><br><span class="line">  <span class="attribute">min-height</span>: <span class="number">35px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="10、页面的最小宽度"><a href="#10、页面的最小宽度" class="headerlink" title="10、页面的最小宽度"></a>10、页面的最小宽度</h4><p><code>min-width</code> 是个非常方便的 <code>CSS</code> 命令，它可以指定元素最小也不能小于某个宽度，这样就能保证排版一直正确。<br>但IE不认得这个，而它实际上把 <code>width</code> 当做最小宽度来使。<br>为了让这一命令在IE上也能用，可以把一个 <code>&lt;div&gt;</code> 放到 <code>&lt;body&gt;</code> 标签下，然后为 <code>div</code> 指定一个类，然后 <code>CSS</code> 这样设计：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#container</span>&#123;</span><br><span class="line">    <span class="attribute">min-width</span>: <span class="number">600px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="built_in">e-xpression</span>(document.body.clientWidth &lt; <span class="number">600</span>? <span class="string">&quot;600px&quot;</span>: <span class="string">&quot;auto&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>第一个 <code>min-width</code> 是正常的；<br>但第2行的 <code>width</code> 使用了 <code>JavaScript</code> ，这只有IE才认得，这也会让你的 <code>HTML</code> 文档不太正规。它实际上通过 <code>JavaScript</code> 的判断来实现最小宽度。</p>
<h4 id="11、清除浮动"><a href="#11、清除浮动" class="headerlink" title="11、清除浮动"></a>11、清除浮动</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: table;</span><br><span class="line">  // 将对象作为块元素级的表格显示</span><br><span class="line">&#125;</span><br><span class="line">// 或者</span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">clear</span>: both;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>或者加入  <code>:after</code> （伪对象）,设置在对象后发生的内容，通常和 <code>content</code> 配合使用，IE不支持此伪对象，<br>非IE 浏览器支持，所以并不影响到IE&#x2F;WIN浏览器。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#box</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: “.”;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">clear</span>: both;</span><br><span class="line">  <span class="attribute">visibility</span>: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="12、-DIV-浮动IE文本产生-3px-的-bug"><a href="#12、-DIV-浮动IE文本产生-3px-的-bug" class="headerlink" title="12、 DIV 浮动IE文本产生 3px 的 bug"></a>12、 <code>DIV</code> 浮动IE文本产生 <code>3px</code> 的 <code>bug</code></h4><p>左边对象浮动，右边采用外补丁的左边距来定位，右边对象内的文本会离左边有 <code>3px</code> 的间距。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#box</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">800px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#left</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#right</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50%</span>;</span><br><span class="line">&#125;</span><br><span class="line">*<span class="selector-tag">html</span> <span class="selector-id">#left</span> &#123;</span><br><span class="line">  <span class="attribute">margin-right</span>: -<span class="number">3px</span>; // 这句是关键</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="13、IE捉迷藏的问题"><a href="#13、IE捉迷藏的问题" class="headerlink" title="13、IE捉迷藏的问题"></a>13、IE捉迷藏的问题</h4><p>当 <code>div</code> 应用复杂的时候每个栏中又有一些链接， <code>div</code> 等这个时候容易发生捉迷藏的问题。<br>有些内容显示不出来，当鼠标选择这个区域是发现内容确实在页面。<br>解决方案：对 <code>#layout</code> 使用 <code>line-height</code> 属性或者给 <code>#layout</code> 使用固定高和宽。页面结构尽量简单。</p>
<h4 id="14、高度不适应"><a href="#14、高度不适应" class="headerlink" title="14、高度不适应"></a>14、高度不适应</h4><p>高度不适应是当内层对象的高度发生变化时外层高度不能自动进行调节，特别是当内层对象使用 <code>margin</code> 或 <code>padding</code> 时。例：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">”box”</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span>&gt;</span>p对象中的内容<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>CSS</code> ：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#box</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#eee</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#box</span> <span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">20px</span>; </span><br><span class="line">  <span class="attribute">text-align</span>: center; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>解决方案：在 <code>p</code> 对象上下各加 <code>2</code> 个空的 <code>div</code> 对象 <code>CSS</code> 代码： <code>.1&#123; height: 0px; overflow: hidden; &#125;</code> 或者为 <code>DIV</code> 加上 <code>border</code> 属性。</p>
<h4 id="15、cursor-属性问题"><a href="#15、cursor-属性问题" class="headerlink" title="15、cursor 属性问题"></a>15、<code>cursor</code> 属性问题</h4><p><code>cursor: hand;</code> VS <code>cursor: pointer; </code><br>问题说明：FireFox不支持 <code>hand</code>，但IE支持 <code>pointer</code> 。<br>解决方法：统一使用 <code>pointer</code>。</p>
<h4 id="16、对盒模型的解析不一致"><a href="#16、对盒模型的解析不一致" class="headerlink" title="16、对盒模型的解析不一致"></a>16、对盒模型的解析不一致</h4><ul>
<li>对 <code>border</code> 的解析不一致，如：<code>box.style &#123; width: 100px; border: 1px; &#125;</code>；IE理解为 <code>box.width = 100px;</code>；Firefox 理解为 <code>box.width = 100 + 1*2 = 102px;  // 加上边框2px</code></li>
</ul>
<p>解决方案：<code>div &#123; margin: 30px !important; margin: 28px; &#125;</code> 注意这两个 <code>margin</code> 的顺序一定不能写反， IE不能识别 <code>!important</code> 这个属性，但别的浏览器可以识别。所以在IE下其实解释成这样：<code>div&#123; maring: 30px; margin: 28px; &#125;</code> 重复定义的话按照最后一个来执行，所以不可以只写 <code>margin: XXpx !important;</code></p>
<ul>
<li>IE5 和 IE6 的盒模型解释不一致。IE5下 <code>div&#123; width: 300px; margin: 0 10px 0 10px; &#125;</code> 其中 <code>div</code> 的宽度会被解释为 <code>300px-10px(右填充)-10px(左填充)</code>，最终 <code>div</code> 的宽度为 <code>280px</code> ，而在IE6和其他浏览器上宽度则是以 <code>300px+10px(右填充)+10px(左填充)=320px</code> 来计算的。</li>
</ul>
<p>解决方案：做如下修改 <code>div &#123; width: 300px !important; width /**/: 340px; margin: 0 10px 0 10px; &#125;</code><br>17、<code>ul</code> 和 <code>ol</code> 列表缩进问题<br>消除 <code>ul</code>、<code>ol</code> 等列表的缩进时，样式应写成：<code>list-style: none; margin: 0px; padding: 0px;</code><br>经验证，在IE中，设置 <code>margin: 0px;</code> 可以去除列表的上下左右缩进、空白以及列表编号或圆点，设置 <code>padding</code> 对样式没有影响；<br>在 Firefox 中，设置 <code>margin: 0px;</code> 仅仅可以去除上下的空白，设置 <code>padding: 0px;</code> 后仅仅可以去掉左右缩进，还必须设置 <code>list- style: none;</code> 才能去除列表编号或圆点。也就是说，在IE中仅仅设置 <code>margin: 0px;</code> 即可达到最终效果，而在Firefox中必须同时设置 <code>margin: 0px;</code>、 <code>padding: 0px;</code> 以及 <code>list-style: none;</code> 三项才能达到最终效果。</p>
<h4 id="17、为什么无法定义-1px-左右高度的容器"><a href="#17、为什么无法定义-1px-左右高度的容器" class="headerlink" title="17、为什么无法定义 1px 左右高度的容器"></a>17、为什么无法定义 <code>1px</code> 左右高度的容器</h4><p>IE6下这个问题是因为默认的行高造成的；解决的技巧也有很多：<br>例如：<code>overflow: hidden;</code>  <code>zoom: 0.08</code>  <code>line-height: 1px;</code></p>
<h4 id="18、链接-a标签-的边框与背景"><a href="#18、链接-a标签-的边框与背景" class="headerlink" title="18、链接(a标签)的边框与背景"></a>18、链接(<code>a</code>标签)的边框与背景</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a` 链接加边框和背景色，需设置 `display: block;` 同时设置 `float: left;`  保证不换行。参照 `menubar`, 给 `a` 和 `menubar` 设置高度是为了避免底边显示错位，若不设 `height`, 可以在 `menubar` 中插入一个空格。</span><br><span class="line">19、超链接访问过后 `hover` 样式就不出现的问题</span><br><span class="line">问题说明：被点击访问过的超链接样式不在具有 `hover` 和 `active`了</span><br><span class="line">解决技巧是改变CSS属性的排列顺序:  L-V-H-A ；</span><br><span class="line">`&lt;style type=&quot;text/css&quot;&gt; &lt;!-- a:link &#123;&#125; a:visited &#123;&#125; a:hover &#123;&#125; a:active &#123;&#125; --&gt; &lt;/style&gt;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/07/13/Koa/" data-id="cmd1is15e0000m0ur83sketaj" data-title="Koa" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-React-Native" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/07/12/React-Native/" class="article-date">
  <time class="dt-published" datetime="2025-07-12T15:17:05.000Z" itemprop="datePublished">2025-07-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/07/12/React-Native/">React Native</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>React Native（RN）项目的运行流程是一个<strong>多线程、跨语言协同执行的过程</strong>，其核心机制包括：</p>
<ul>
<li>JS 引擎启动与脚本加载</li>
<li>原生 UI 管理与渲染</li>
<li>桥接通信（Bridge）或 JSI 同步调用</li>
<li>事件循环与交互响应</li>
</ul>
<p>下面我将详细说明 RN 在移动端（iOS &#x2F; Android）上的完整工作全流程，并结合你的项目背景（如 Electron、Taro 等）进行技术适配建议。</p>
<hr>
<h2 id="React-Native-移动端运行全流程详解"><a href="#React-Native-移动端运行全流程详解" class="headerlink" title="React Native 移动端运行全流程详解"></a>React Native 移动端运行全流程详解</h2><h3 id="🧩-阶段一：应用启动与初始化"><a href="#🧩-阶段一：应用启动与初始化" class="headerlink" title="🧩 阶段一：应用启动与初始化"></a>🧩 阶段一：应用启动与初始化</h3><h4 id="1-原生应用入口"><a href="#1-原生应用入口" class="headerlink" title="1. 原生应用入口"></a>1. <strong>原生应用入口</strong></h4><ul>
<li>iOS: <code>main.m</code> → <code>RCTBridge</code> 初始化；</li>
<li>Android: <code>ReactNativeHost</code> 和 <code>ReactInstanceManager</code> 创建；</li>
<li>启动一个独立的 JS 线程来运行 JavaScript 引擎（默认使用 Hermes 或 JavaScriptCore）；</li>
</ul>
<h4 id="2-创建-JS-运行时（Runtime）"><a href="#2-创建-JS-运行时（Runtime）" class="headerlink" title="2. 创建 JS 运行时（Runtime）"></a>2. <strong>创建 JS 运行时（Runtime）</strong></h4><ul>
<li>加载并初始化 JS 引擎（Hermes&#x2F;JSC）；</li>
<li>若启用 <strong>JSI（JavaScript Interface）</strong>，则注册 JSI 接口，允许 JS 直接访问原生对象；</li>
<li>准备好 JS 执行环境（Global 对象、内置函数等）；</li>
</ul>
<h4 id="3-加载-JavaScript-Bundle"><a href="#3-加载-JavaScript-Bundle" class="headerlink" title="3. 加载 JavaScript Bundle"></a>3. <strong>加载 JavaScript Bundle</strong></h4><ul>
<li>从本地文件系统或远程服务器加载 <code>index.android.bundle</code> &#x2F; <code>index.ios.bundle</code>；</li>
<li>将 JS Bundle 注入到 JS Runtime 中执行；</li>
<li>执行 <code>AppRegistry.registerComponent</code> 注册主组件；</li>
</ul>
<hr>
<h3 id="阶段二：UI-构建与布局计算"><a href="#阶段二：UI-构建与布局计算" class="headerlink" title="阶段二：UI 构建与布局计算"></a>阶段二：UI 构建与布局计算</h3><h4 id="4-执行-JS-代码并构建-Virtual-DOM"><a href="#4-执行-JS-代码并构建-Virtual-DOM" class="headerlink" title="4. 执行 JS 代码并构建 Virtual DOM"></a>4. <strong>执行 JS 代码并构建 Virtual DOM</strong></h4><ul>
<li>调用 <code>AppRegistry.runApplication()</code>，触发 React 树的构建；</li>
<li>React 组件树通过 <code>React.createElement(...)</code> 构建出虚拟 DOM；</li>
<li>虚拟 DOM 被转换为 RN 的 <strong>Shadow Tree</strong>（用于描述 UI 结构）；</li>
</ul>
<h4 id="5-Layout-计算（Yoga-引擎）"><a href="#5-Layout-计算（Yoga-引擎）" class="headerlink" title="5. Layout 计算（Yoga 引擎）"></a>5. <strong>Layout 计算（Yoga 引擎）</strong></h4><ul>
<li>Shadow Tree 使用 <a target="_blank" rel="noopener" href="https://facebook.github.io/yoga/">Yoga</a>（Flexbox 实现）进行布局计算；</li>
<li>计算每个节点的位置、尺寸、排列方式；</li>
<li>如果启用了 Fabric 架构，则 Layout 在 JS 线程中完成，更高效；</li>
</ul>
<hr>
<h3 id="阶段三：原生-UI-创建与渲染"><a href="#阶段三：原生-UI-创建与渲染" class="headerlink" title="阶段三：原生 UI 创建与渲染"></a>阶段三：原生 UI 创建与渲染</h3><h4 id="6-创建原生视图（Native-Views）"><a href="#6-创建原生视图（Native-Views）" class="headerlink" title="6. 创建原生视图（Native Views）"></a>6. <strong>创建原生视图（Native Views）</strong></h4><ul>
<li>JS 端通过 <code>createView</code>、<code>updateView</code> 等指令通知原生端创建 UIView&#x2F;Android View；</li>
<li>原生端接收这些命令后创建对应的原生控件（UILabel、UIButton、TextView 等）；</li>
<li>如果使用 Fabric，则由 <code>FabricUIManager</code> 处理 UI 更新，支持并发模式；</li>
</ul>
<h4 id="7-UI-渲染与合成"><a href="#7-UI-渲染与合成" class="headerlink" title="7. UI 渲染与合成"></a>7. <strong>UI 渲染与合成</strong></h4><ul>
<li>原生视图被添加到屏幕层级结构中；</li>
<li>布局信息同步到原生视图上；</li>
<li>使用平台原生的绘制引擎（iOS 的 Core Animation、Android 的 Skia）进行最终渲染；</li>
</ul>
<hr>
<h3 id="阶段四：交互与更新机制"><a href="#阶段四：交互与更新机制" class="headerlink" title="阶段四：交互与更新机制"></a>阶段四：交互与更新机制</h3><h4 id="8-用户交互事件处理"><a href="#8-用户交互事件处理" class="headerlink" title="8. 用户交互事件处理"></a>8. <strong>用户交互事件处理</strong></h4><ul>
<li>用户点击、滑动等操作由原生层捕获；</li>
<li>事件被封装并通过 Bridge 或 JSI 发送到 JS 线程；</li>
<li>JS 端执行对应事件处理逻辑（如 <code>onPress</code>, <code>onChangeText</code>）；</li>
</ul>
<h4 id="9-状态更新与-Diffing"><a href="#9-状态更新与-Diffing" class="headerlink" title="9. 状态更新与 Diffing"></a>9. <strong>状态更新与 Diffing</strong></h4><ul>
<li><p>当组件状态变化（如</p>
<p>setState</p>
<p>,</p>
<p>useState</p>
<p>,</p>
<p>useReducer</p>
<p>）时：</p>
<ul>
<li>React 重新构建虚拟 DOM；</li>
<li>React Native 的 Reconciler 对比新旧 Virtual DOM，生成差异补丁（diff）；</li>
</ul>
</li>
<li><p>差异被转换为对 Shadow Tree 的修改指令；</p>
</li>
</ul>
<h4 id="10-UI-更新与-Commit"><a href="#10-UI-更新与-Commit" class="headerlink" title="10. UI 更新与 Commit"></a>10. <strong>UI 更新与 Commit</strong></h4><ul>
<li>修改后的 Shadow Tree 提交到原生端；</li>
<li>原生端根据差异指令更新对应的原生视图；</li>
<li>如果使用 Fabric，则在 JS 线程直接提交 UI 操作，避免桥接延迟；</li>
</ul>
<h3 id="阶段五：生命周期与性能优化"><a href="#阶段五：生命周期与性能优化" class="headerlink" title="阶段五：生命周期与性能优化"></a>阶段五：生命周期与性能优化</h3><h4 id="11-组件生命周期管理"><a href="#11-组件生命周期管理" class="headerlink" title="11. 组件生命周期管理"></a>11. <strong>组件生命周期管理</strong></h4><ul>
<li><code>componentDidMount</code>, <a href="javascript:void(0)">useEffect</a>, <code>componentWillUnmount</code> 等钩子按顺序执行；</li>
<li>清理副作用（如定时器、监听器），防止内存泄漏；</li>
</ul>
<h4 id="12-TurboModule-NativeModule-调用"><a href="#12-TurboModule-NativeModule-调用" class="headerlink" title="12. TurboModule &amp; NativeModule 调用"></a>12. <strong>TurboModule &amp; NativeModule 调用</strong></h4><ul>
<li>JS 端调用原生模块（如相机、定位、网络请求）；</li>
<li>如果是 TurboModule（基于 JSI），则直接同步调用 C++ 方法；</li>
<li>如果是传统 Module，则通过 Bridge 异步传递 JSON 数据；</li>
</ul>
<h4 id="13-动画与手势处理"><a href="#13-动画与手势处理" class="headerlink" title="13. 动画与手势处理"></a>13. <strong>动画与手势处理</strong></h4><ul>
<li>使用 Reanimated 2.x + JSI 实现高性能动画；</li>
<li>Gesture Handler 直接绑定原生手势识别器；</li>
<li>动画计算和 UI 更新都在 JS 线程中完成，提升帧率稳定性；</li>
</ul>
<hr>
<h2 id="整体架构示意图（简化）"><a href="#整体架构示意图（简化）" class="headerlink" title="整体架构示意图（简化）"></a>整体架构示意图（简化）</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">+-------------------------+</span><br><span class="line">|      JS 开发者代码       |</span><br><span class="line">|   (React + Components)  |</span><br><span class="line">+-----------+-------------+</span><br><span class="line">            |</span><br><span class="line">     +------v-------+</span><br><span class="line">     |   JS Engine  |</span><br><span class="line">     | (Hermes/JSC) |</span><br><span class="line">     +------+--------+</span><br><span class="line">            |</span><br><span class="line">     +------v-------+</span><br><span class="line">     |    JSI Layer |</span><br><span class="line">     | (C++ Binding)|</span><br><span class="line">     +------+--------+</span><br><span class="line">            |</span><br><span class="line">     +------v-------+</span><br><span class="line">     |   Native API |</span><br><span class="line">     | (iOS/Android)|</span><br><span class="line">     +------+--------+</span><br><span class="line">            |</span><br><span class="line">     +------v-------+</span><br><span class="line">     |   Native UI  |</span><br><span class="line">     | (UIView/View)|</span><br><span class="line">     +--------------+</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="技术栈适配建议（参考你的项目背景）"><a href="#技术栈适配建议（参考你的项目背景）" class="headerlink" title="技术栈适配建议（参考你的项目背景）"></a>技术栈适配建议（参考你的项目背景）</h2><table>
<thead>
<tr>
<th align="left">技术点</th>
<th align="left">描述</th>
<th align="left">适用场景</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>Electron 项目集成 RN 思路</strong></td>
<td align="left">可尝试使用 <code>react-native-electron</code>，但需注意 JS 引擎兼容性（V8 vs JSC）</td>
<td align="left">桌面端跨平台开发</td>
</tr>
<tr>
<td align="left"><strong>Taro 项目接入 RN 支持</strong></td>
<td align="left">Taro 支持 <code>taro build --type rn</code> 编译成 RN 项目，适合跨端统一开发</td>
<td align="left">移动 + Web + 小程序统一开发</td>
</tr>
<tr>
<td align="left"><strong>TypeScript 类型安全</strong></td>
<td align="left">推荐使用 TS 定义所有模块接口和组件 props，提高维护性</td>
<td align="left">所有项目类型</td>
</tr>
<tr>
<td align="left"><strong>性能优化策略</strong></td>
<td align="left">使用 JSI + Fabric 提升渲染性能，减少主线程阻塞</td>
<td align="left">高性能需求场景</td>
</tr>
<tr>
<td align="left"><strong>调试工具</strong></td>
<td align="left">使用 Flipper、Chrome DevTools、React DevTools、Reanimated DevTools</td>
<td align="left">调试、日志、性能分析</td>
</tr>
</tbody></table>
<hr>
<h2 id="典型生命周期流程图（以-App-启动为例）"><a href="#典型生命周期流程图（以-App-启动为例）" class="headerlink" title="典型生命周期流程图（以 App 启动为例）"></a>典型生命周期流程图（以 App 启动为例）</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[原生启动] </span><br><span class="line">→ 初始化 Runtime </span><br><span class="line">→ 加载 JS Bundle </span><br><span class="line">→ 执行 React 应用 </span><br><span class="line">→ 构建 Virtual DOM </span><br><span class="line">→ 转换为 Shadow Tree </span><br><span class="line">→ 布局计算（Flexbox） </span><br><span class="line">→ 创建 Native Views </span><br><span class="line">→ 渲染到屏幕上 </span><br><span class="line">→ 等待用户交互或 JS 更新 </span><br><span class="line">→ 更新 UI 并重新渲染</span><br></pre></td></tr></table></figure>





<p>React Native（RN）热更新技术允许应用在不发布新商店版本的情况下动态更新JavaScript代码、界面及资源，极大提升了迭代效率和用户体验。以下从热更新原理、服务实现、策略优化三方面详细解析：</p>
<hr>
<h3 id="一、热更新原理"><a href="#一、热更新原理" class="headerlink" title="一、热更新原理"></a>一、热更新原理</h3><p>热更新的核心是<strong>动态替换JS Bundle文件</strong>，依赖RN的模块化加载机制和HMR（Hot Module Replacement）技术：</p>
<ol>
<li><strong>HMR热加载（开发模式）</strong><ul>
<li>当代码修改保存后，本地Packager服务检测变化，通过WebSocket通知App的HMR Runtime。</li>
<li>Runtime接收包含<strong>模块代码和依赖关系</strong>的HMR Update，替换旧模块并保留应用状态（如Redux状态）135。</li>
<li>若模块未处理更新（<code>module.hot.accept</code>），更新事件会沿依赖链向上传递，直至被接受或触发全量刷新7。</li>
</ul>
</li>
<li><strong>生产环境热更新</strong><ul>
<li>App启动时从服务器拉取最新JS Bundle（或增量包），替换本地文件。</li>
<li>原生层通过重写加载路径（如Android的<code>getJSBundleFile</code>）指向新Bundle，下次启动时生效89。</li>
<li>iOS通过WebSocket监听Metro服务器，触发Bundle下载和Root组件重置7。</li>
</ul>
</li>
</ol>
<hr>
<h3 id="二、热更新服务实现方案"><a href="#二、热更新服务实现方案" class="headerlink" title="二、热更新服务实现方案"></a>二、热更新服务实现方案</h3><p>根据运维能力和需求，可选择三类方案：</p>
<h4 id="第三方服务（CodePush-Expo-OTA）"><a href="#第三方服务（CodePush-Expo-OTA）" class="headerlink" title="第三方服务（CodePush&#x2F;Expo OTA）**"></a>第三方服务（CodePush&#x2F;Expo OTA）**</h4><ul>
<li><p><strong>CodePush（微软）</strong></p>
<ul>
<li><p>流程：</p>
<p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 安装CLI → 注册应用 → 集成SDK → 发布更新</span><br><span class="line">npm install -g code-push-cli</span><br><span class="line">code-push release-react MyApp android</span><br></pre></td></tr></table></figure>
</li>
<li><p>支持增量更新：仅下载差异文件，减少流量消耗46。</p>
</li>
</ul>
</li>
<li><p><strong>Expo OTA</strong></p>
<ul>
<li>需Expo开发环境，自动检测并后台下载更新6。</li>
</ul>
</li>
</ul>
<h4 id="自建热更新服务"><a href="#自建热更新服务" class="headerlink" title="自建热更新服务**"></a>自建热更新服务**</h4><p><strong>步骤</strong>：</p>
<ol>
<li><p><strong>生成Bundle</strong>：</p>
<p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">react-native bundle --platform android --entry-file index.js --bundle-output ./bundle/index.bundle</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>增量包生成</strong>：</p>
<ul>
<li>使用<code>bsdiff</code>生成旧Bundle到新Bundle的补丁（<code>.patch</code>文件）910。</li>
</ul>
</li>
<li><p><strong>客户端更新逻辑</strong>：</p>
<ul>
<li>启动时向服务器上报当前版本号，下载增量包 → 合并生成新Bundle → 替换本地文件89。</li>
</ul>
</li>
<li><p><strong>资源更新</strong>：</p>
<ul>
<li>图片等资源需与Bundle同目录，增量更新时覆盖旧资源9。</li>
</ul>
</li>
</ol>
<h4 id="Hermes引擎优化方案"><a href="#Hermes引擎优化方案" class="headerlink" title="Hermes引擎优化方案**"></a>Hermes引擎优化方案**</h4><ul>
<li><p>将JS Bundle转换为Hermes字节码（<code>.hbc</code>），提升执行效率：</p>
<p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./hermesc -emit-binary -out index.android.bundle.hbc index.android.bundle</span><br></pre></td></tr></table></figure>
</li>
<li><p>热更新时直接推送字节码文件，避免JS解析开销2。</p>
</li>
</ul>
<hr>
<h3 id="三、热更新策略与优化"><a href="#三、热更新策略与优化" class="headerlink" title="三、热更新策略与优化"></a>三、热更新策略与优化</h3><h4 id="1-增量更新策略"><a href="#1-增量更新策略" class="headerlink" title="1. 增量更新策略"></a>1. <strong>增量更新策略</strong></h4><table>
<thead>
<tr>
<th align="left"><strong>策略类型</strong></th>
<th align="left"><strong>实现方式</strong></th>
<th align="left"><strong>优缺点</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>版本差量包</strong></td>
<td align="left">服务端为每个版本生成与前一版本的差量包（如v2→v1、v3→v2）</td>
<td align="left">下载量小，但服务端需维护多版本补丁4</td>
</tr>
<tr>
<td align="left"><strong>基线版本包</strong></td>
<td align="left">基于初始版本（Baseline）生成增量包（如v2→v1、v3→v1）</td>
<td align="left">服务端压力小，但增量包体积较大9</td>
</tr>
</tbody></table>
<p><strong>版本管理关键点</strong>：</p>
<ul>
<li><strong>基线版本</strong>：打包进APK&#x2F;IPA的初始JS版本（如<code>v1.0</code>）。</li>
<li><strong>当前版本</strong>：热更新后实际运行的版本（如<code>v1.2</code>）9。</li>
<li>请求更新时，客户端上传<code>MAX(基线版本, 当前版本)</code>，避免跨大版本更新错误9。</li>
</ul>
<h4 id="2-性能优化"><a href="#2-性能优化" class="headerlink" title="2. 性能优化"></a>2. <strong>性能优化</strong></h4><ul>
<li><strong>Bundle精简</strong>：移除未使用代码、压缩资源4。</li>
<li><strong>CDN加速</strong>：减少更新包下载延迟4。</li>
<li><strong>回滚机制</strong>：更新后闪退时自动回退到上一可用版本（沙盒保留2-3个历史版本）910。</li>
</ul>
<h4 id="3-安全与稳定性"><a href="#3-安全与稳定性" class="headerlink" title="3. 安全与稳定性"></a>3. <strong>安全与稳定性</strong></h4><ul>
<li><strong>签名校验</strong>：增量包下载后验证签名，防止篡改。</li>
<li><strong>灰度发布</strong>：先小范围测试，再全量推送。</li>
<li><strong>苹果合规</strong>：仅更新JS&#x2F;资源，不修改原生代码（否则可能违反App Store政策）810。</li>
</ul>
<hr>
<h3 id="四、注意事项与限制"><a href="#四、注意事项与限制" class="headerlink" title="四、注意事项与限制"></a>四、注意事项与限制</h3><ol>
<li><strong>原生代码更新无效</strong>：热更新仅适用于JS&#x2F;资源，Native模块修改需发商店版本8。</li>
<li><strong>版本兼容性</strong>：确保新JS Bundle与当前Native代码兼容，否则可能崩溃。</li>
<li><strong>测试覆盖</strong>：更新前需充分测试，避免界面逻辑错误10。</li>
</ol>
<hr>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>RN热更新的核心在于<strong>动态替换Bundle与模块级更新</strong>。推荐策略：</p>
<ul>
<li><strong>中小团队</strong>：采用CodePush，快速集成增量更新。</li>
<li><strong>大型应用</strong>：自建服务 + Hermes字节码 + 基线版本增量包，平衡效率与可控性。</li>
<li><strong>关键优化点</strong>：Bundle瘦身、CDN加速、强制回滚机制保障稳定性。</li>
</ul>
<p>在 React Native 热更新体系中，App 检测 JS Bundle 更新的核心逻辑是通过 <strong>版本号比对机制</strong> 实现的。以下是详细流程和关键技术点：</p>
<hr>
<h3 id="一、更新检测流程"><a href="#一、更新检测流程" class="headerlink" title="一、更新检测流程"></a>一、更新检测流程</h3><p><img src="/../img/deepseek_mermaid_20250713_bc3153.png"></p>
<h3 id="二、关键实现步骤"><a href="#二、关键实现步骤" class="headerlink" title="二、关键实现步骤"></a>二、关键实现步骤</h3><h4 id="1-版本号管理"><a href="#1-版本号管理" class="headerlink" title="1. 版本号管理"></a>1. <strong>版本号管理</strong></h4><ul>
<li><strong>本地存储</strong><br>App 首次安装时将 <strong>初始版本号</strong>（与原生代码打包的 JS Bundle 版本）保存到本地（AsyncStorage&#x2F;SecureStorage）<br>示例：<code>v1.0.0_base</code>（基线版本）</li>
<li><strong>更新标识</strong><br>热更新后，记录当前运行的 <strong>热更新版本号</strong><br>示例：<code>v1.2.0_hotfix</code></li>
</ul>
<h4 id="2-更新检测触发时机"><a href="#2-更新检测触发时机" class="headerlink" title="2. 更新检测触发时机"></a>2. <strong>更新检测触发时机</strong></h4><table>
<thead>
<tr>
<th align="left"><strong>时机</strong></th>
<th align="left"><strong>适用场景</strong></th>
<th align="left"><strong>优缺点</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>App 启动时</strong></td>
<td align="left">常规更新检查</td>
<td align="left">用户感知明显，可能影响启动速度</td>
</tr>
<tr>
<td align="left"><strong>定时轮询</strong></td>
<td align="left">后台静默更新（如每 24 小时）</td>
<td align="left">需处理网络状态，增加耗电风险</td>
</tr>
<tr>
<td align="left"><strong>用户主动触发</strong></td>
<td align="left">设置页添加“检查更新”按钮</td>
<td align="left">用户体验好，但依赖用户操作</td>
</tr>
<tr>
<td align="left"><strong>推送通知</strong></td>
<td align="left">紧急修复时服务端推送更新指令</td>
<td align="left">实时性强，需集成推送服务</td>
</tr>
</tbody></table>
<h4 id="3-版本比对逻辑"><a href="#3-版本比对逻辑" class="headerlink" title="3. 版本比对逻辑"></a>3. <strong>版本比对逻辑</strong></h4><p>客户端向服务器发送 <strong>版本元数据</strong>：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 请求体示例</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;appId&quot;</span><span class="punctuation">:</span> <span class="string">&quot;com.example.app&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;platform&quot;</span><span class="punctuation">:</span> <span class="string">&quot;android&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;baseVersion&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span> <span class="comment">// 基线版本（APK/IPA 内置版本）</span></span><br><span class="line">  <span class="attr">&quot;currentVersion&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.2.0&quot;</span> <span class="comment">// 当前热更新版本</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>服务端响应策略：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 响应体示例</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;hasUpdate&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;isMandatory&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span> <span class="comment">// 是否强制更新</span></span><br><span class="line">  <span class="attr">&quot;latestVersion&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.3.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;updateDescription&quot;</span><span class="punctuation">:</span> <span class="string">&quot;修复支付BUG&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;downloadUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://cdn.com/update_1.2.0_1.3.0.patch&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;fileHash&quot;</span><span class="punctuation">:</span> <span class="string">&quot;a1b2c3d4...&quot;</span> <span class="comment">// 文件完整性校验</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>版本比对规则</strong>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 伪代码实现</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">checkUpdate</span>(<span class="params">localVer, serverVer</span>) &#123;</span><br><span class="line">  <span class="comment">// 语义化版本号解析（major.minor.patch）</span></span><br><span class="line">  <span class="keyword">const</span> local = <span class="title function_">parseVersion</span>(localVer); </span><br><span class="line">  <span class="keyword">const</span> remote = <span class="title function_">parseVersion</span>(serverVer);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (remote.<span class="property">major</span> &gt; local.<span class="property">major</span>) <span class="keyword">return</span> <span class="string">&#x27;major_update&#x27;</span>;</span><br><span class="line">  <span class="keyword">if</span> (remote.<span class="property">minor</span> &gt; local.<span class="property">minor</span>) <span class="keyword">return</span> <span class="string">&#x27;minor_update&#x27;</span>;</span><br><span class="line">  <span class="keyword">if</span> (remote.<span class="property">patch</span> &gt; local.<span class="property">patch</span>) <span class="keyword">return</span> <span class="string">&#x27;patch_update&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;no_update&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-增量更新优化"><a href="#4-增量更新优化" class="headerlink" title="4. 增量更新优化"></a>4. <strong>增量更新优化</strong></h4><ul>
<li><p><strong>差分算法</strong><br>使用 <code>bsdiff</code> 生成新旧 Bundle 差异包（体积可减少 80%-95%）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bsdiff old.bundle new.bundle update.patch</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>合并策略</strong><br>客户端下载增量包后，用 <code>bspatch</code> 合并本地 Bundle：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bspatch old.bundle new.bundle update.patch</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h3 id="⚠️-三、避坑指南"><a href="#⚠️-三、避坑指南" class="headerlink" title="⚠️ 三、避坑指南"></a>⚠️ 三、避坑指南</h3><ol>
<li><p><strong>版本兼容性</strong></p>
<ul>
<li>热更新版本号需遵循 <strong>语义化版本规范</strong>（SemVer）</li>
<li>确保新 JS Bundle 兼容当前原生代码（如 Native Modules 接口不变）</li>
</ul>
</li>
<li><p><strong>安全机制</strong></p>
<p><img src="/../img/deepseek_mermaid_20250713_5d8bbc.png"></p>
<ul>
<li>必须验证文件哈希（SHA-256）</li>
<li>HTTPS 传输防止中间人攻击</li>
</ul>
</li>
<li><p><strong>降级处理</strong></p>
<ul>
<li>更新后崩溃时自动回滚到上一可用版本</li>
<li>本地保留 2-3 个历史版本备份</li>
</ul>
</li>
<li><p><strong>苹果审核合规</strong></p>
<ul>
<li>热更新内容 <strong>不能修改应用核心功能</strong></li>
<li>避免动态加载远程原生代码（违反 App Store 指南 3.3.2）</li>
</ul>
</li>
</ol>
<hr>
<h3 id="四、主流方案实现差异"><a href="#四、主流方案实现差异" class="headerlink" title="四、主流方案实现差异"></a>四、主流方案实现差异</h3><table>
<thead>
<tr>
<th align="left"><strong>方案</strong></th>
<th align="left"><strong>更新检测方式</strong></th>
<th align="left"><strong>特点</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>CodePush</strong></td>
<td align="left">SDK 自动轮询（默认每次启动检查）</td>
<td align="left">支持回滚&#x2F;灰度发布，自带版本管理后台</td>
</tr>
<tr>
<td align="left"><strong>自建服务</strong></td>
<td align="left">自定义 HTTP 接口 + 客户端定时器</td>
<td align="left">灵活控制策略，需自行实现差分&#x2F;校验逻辑</td>
</tr>
<tr>
<td align="left"><strong>Expo OTA</strong></td>
<td align="left">Expo 运行时自动检测</td>
<td align="left">零配置，但需绑定 Expo 生态</td>
</tr>
</tbody></table>
<hr>
<h3 id="实践建议"><a href="#实践建议" class="headerlink" title="实践建议"></a>实践建议</h3><ol>
<li><p><strong>版本号设计</strong></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[基线版本]<span class="emphasis">_[热更新序号]  </span></span><br><span class="line"><span class="emphasis">示例：`1.0.0_</span>base<span class="code">` → `</span>1.0.0<span class="emphasis">_hotfix3`</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>更新策略</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// React Native 中注册更新事件（CodePush 示例）</span></span><br><span class="line">codePush.<span class="title function_">sync</span>(&#123;</span><br><span class="line">  <span class="attr">updateDialog</span>: <span class="literal">true</span>, <span class="comment">// 显示更新弹窗</span></span><br><span class="line">  <span class="attr">installMode</span>: codePush.<span class="property">InstallMode</span>.<span class="property">IMMEDIATE</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>紧急修复通道</strong></p>
<p><img src="/../img/deepseek_mermaid_20250713_669d18.png"></p>
</li>
</ol>
<blockquote>
<p><strong>实测数据</strong>：某电商 App 采用基线版本+增量更新策略后，热更新包体积从 2.1MB 降至平均 120KB，下载成功率提升至 99.3%。</p>
</blockquote>
<p><img src="/../img/deepseek_mermaid_20250712_a06989.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/07/12/React-Native/" data-id="cmd16uadt000058uregyqgr04" data-title="React Native" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-业务" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/07/04/%E4%B8%9A%E5%8A%A1/" class="article-date">
  <time class="dt-published" datetime="2025-07-04T02:58:27.000Z" itemprop="datePublished">2025-07-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/07/04/%E4%B8%9A%E5%8A%A1/">业务</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="跨域"><a href="#跨域" class="headerlink" title="跨域"></a>跨域</h1><p><img src="/../img/31365.jpg"></p>
<h2 id="多个页面跨域，怎么实现共享localstorage"><a href="#多个页面跨域，怎么实现共享localstorage" class="headerlink" title="多个页面跨域，怎么实现共享localstorage"></a>多个页面跨域，怎么实现共享localstorage</h2><p>实现跨域页面共享 <code>localStorage</code> 的核心挑战是浏览器的同源策略限制。以下是几种可行的解决方案，按推荐程度排序：</p>
<hr>
<h3 id="方案-1：使用-postMessage-iframe（推荐）"><a href="#方案-1：使用-postMessage-iframe（推荐）" class="headerlink" title="方案 1：使用 postMessage + iframe（推荐）"></a>方案 1：使用 <code>postMessage</code> + <code>iframe</code>（推荐）</h3><p>通过隐藏的 <code>iframe</code> 作为桥梁，利用 <code>window.postMessage</code> 实现跨域通信。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 主页面 (a.com) --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 发送数据到 iframe</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">sendToStorage</span>(<span class="params">data</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> iframe = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;storage-iframe&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    iframe.<span class="property">contentWindow</span>.<span class="title function_">postMessage</span>(</span></span><br><span class="line"><span class="language-javascript">      &#123; <span class="attr">type</span>: <span class="string">&#x27;SET_LS&#x27;</span>, <span class="attr">key</span>: <span class="string">&#x27;sharedData&#x27;</span>, <span class="attr">value</span>: data &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&#x27;https://b.com&#x27;</span> <span class="comment">// 目标域</span></span></span><br><span class="line"><span class="language-javascript">    );</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 接收来自 iframe 的数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;message&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (event.<span class="property">origin</span> !== <span class="string">&#x27;https://b.com&#x27;</span>) <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (event.<span class="property">data</span>.<span class="property">type</span> === <span class="string">&#x27;GET_LS_RESULT&#x27;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Received data:&#x27;</span>, event.<span class="property">data</span>.<span class="property">value</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">id</span>=<span class="string">&quot;storage-iframe&quot;</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">src</span>=<span class="string">&quot;https://b.com/storage-proxy.html&quot;</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">style</span>=<span class="string">&quot;display: none&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- b.com/storage-proxy.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 监听主页面消息</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;message&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (event.<span class="property">origin</span> !== <span class="string">&#x27;https://a.com&#x27;</span>) <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (event.<span class="property">data</span>.<span class="property">type</span> === <span class="string">&#x27;SET_LS&#x27;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 存储到当前域(b.com)的 localStorage</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(event.<span class="property">data</span>.<span class="property">key</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(event.<span class="property">data</span>.<span class="property">value</span>));</span></span><br><span class="line"><span class="language-javascript">      </span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 可选：发送回执</span></span></span><br><span class="line"><span class="language-javascript">      event.<span class="property">source</span>.<span class="title function_">postMessage</span>(</span></span><br><span class="line"><span class="language-javascript">        &#123; <span class="attr">type</span>: <span class="string">&#x27;SET_SUCCESS&#x27;</span>, <span class="attr">key</span>: event.<span class="property">data</span>.<span class="property">key</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">        event.<span class="property">origin</span></span></span><br><span class="line"><span class="language-javascript">      );</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">else</span> <span class="keyword">if</span> (event.<span class="property">data</span>.<span class="property">type</span> === <span class="string">&#x27;GET_LS&#x27;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 读取数据并返回</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> data = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(event.<span class="property">data</span>.<span class="property">key</span>);</span></span><br><span class="line"><span class="language-javascript">      event.<span class="property">source</span>.<span class="title function_">postMessage</span>(</span></span><br><span class="line"><span class="language-javascript">        &#123; <span class="attr">type</span>: <span class="string">&#x27;GET_LS_RESULT&#x27;</span>, <span class="attr">value</span>: data &#125;,</span></span><br><span class="line"><span class="language-javascript">        event.<span class="property">origin</span></span></span><br><span class="line"><span class="language-javascript">      );</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="方案-2：共享子域（同主域适用）"><a href="#方案-2：共享子域（同主域适用）" class="headerlink" title="方案 2：共享子域（同主域适用）"></a>方案 2：共享子域（同主域适用）</h3><p>如果页面属于同一主域（如 <code>app1.example.com</code> 和 <code>app2.example.com</code>）：</p>
<ol>
<li><p>在所有页面设置相同的一级域：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">domain</span> = <span class="string">&quot;example.com&quot;</span>; <span class="comment">// 需所有页面同步设置</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>通过 <code>iframe</code> 或 <code>window.open()</code> 直接访问父&#x2F;子窗口的 <code>localStorage</code>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父窗口访问 iframe</span></span><br><span class="line"><span class="keyword">const</span> iframe = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;my-iframe&#x27;</span>);</span><br><span class="line">iframe.<span class="property">contentWindow</span>.<span class="property">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;key&#x27;</span>, <span class="string">&#x27;value&#x27;</span>);</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="方案-3：服务端代理同步"><a href="#方案-3：服务端代理同步" class="headerlink" title="方案 3：服务端代理同步"></a>方案 3：服务端代理同步</h3><ol>
<li>页面 A 将数据发送到自己的服务器（A.com&#x2F;api&#x2F;save）</li>
<li>服务器将数据同步到页面 B 的服务器（B.com&#x2F;api&#x2F;sync）</li>
<li>页面 B 从自己的服务器获取数据（需轮询或 WebSocket）</li>
</ol>
<hr>
<h3 id="方案-4：第三方库"><a href="#方案-4：第三方库" class="headerlink" title="方案 4：第三方库"></a>方案 4：第三方库</h3><ul>
<li><p><strong>cross-storage</strong>：<br>提供一个中心化的 <code>Hub</code> 管理跨域存储。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 初始化</span></span><br><span class="line"><span class="keyword">const</span> storage = <span class="keyword">new</span> <span class="title class_">CrossStorageClient</span>(<span class="string">&#x27;https://b.com/hub.html&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 读写数据</span></span><br><span class="line">storage.<span class="title function_">onConnect</span>().<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  storage.<span class="title function_">set</span>(<span class="string">&#x27;key&#x27;</span>, <span class="string">&#x27;value&#x27;</span>); <span class="comment">// 写入 b.com</span></span><br><span class="line">  storage.<span class="title function_">get</span>(<span class="string">&#x27;key&#x27;</span>);          <span class="comment">// 读取 b.com</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h3 id="关键注意事项"><a href="#关键注意事项" class="headerlink" title="关键注意事项"></a>关键注意事项</h3><ol>
<li><strong>安全性</strong>：<ul>
<li>使用 <code>postMessage</code> 时严格验证 <code>event.origin</code></li>
<li>避免传输敏感数据</li>
</ul>
</li>
<li><strong>性能</strong>：<ul>
<li>跨域通信有延迟，高频操作需优化</li>
</ul>
</li>
<li><strong>兼容性</strong>：<ul>
<li><code>postMessage</code> 兼容 IE8+，但复杂场景需测试</li>
</ul>
</li>
<li><strong>存储限制</strong>：<ul>
<li>每个域的 <code>localStorage</code> 仍受单独配额限制（通常 5MB）</li>
</ul>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/07/04/%E4%B8%9A%E5%8A%A1/" data-id="cmcygiiyv000fvgur8ak34ij9" data-title="业务" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%9C%BA%E6%99%AF%E8%AE%BE%E8%AE%A1/" rel="tag">场景设计</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Vue" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/07/03/Vue/" class="article-date">
  <time class="dt-published" datetime="2025-07-03T06:56:58.000Z" itemprop="datePublished">2025-07-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/07/03/Vue/">Vue</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="Vue3-和-Vue2-的区别有哪些？说几个主要的"><a href="#Vue3-和-Vue2-的区别有哪些？说几个主要的" class="headerlink" title="Vue3 和 Vue2 的区别有哪些？说几个主要的"></a>Vue3 和 Vue2 的区别有哪些？说几个主要的</h2><p>Vue 3 提供了更现代化、更高性能的架构，通过 <code>Composition API</code> 和 <code>Proxy</code> 响应式系统等改进提升了开发体验 🎉🎉🎉。相比于 Vue 2，它的优势如下:</p>
<details class="details custom-block" open="" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(142, 150, 170, 0.14); margin: 16px 0px;"><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;"><strong style="box-sizing: border-box; font-weight: 600;">性能优化</strong></p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><p style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; line-height: 24px;"><strong style="box-sizing: border-box; font-weight: 600;">虚拟 DOM 重构</strong>：Vue3的虚拟DOM采用了更高效的<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">Diff算法</code>，减少了渲染和更新的开销。</p></li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;"><p style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; line-height: 24px;"><strong style="box-sizing: border-box; font-weight: 600;">Tree-shaking 支持</strong>：Vue3的代码结构模块化，支持按需引入，减小了打包体积。</p></li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;"><strong style="box-sizing: border-box; font-weight: 600;">Composition API</strong></p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><p style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; line-height: 24px;">Vue3引入了Composition API，使代码更模块化、复用性更强。</p></li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;"><p style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; line-height: 24px;">使用<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">setup()</code><span>&nbsp;</span>方法代替了部分选项式 API，通过函数的方式组织逻辑，代码更加清晰简洁。</p></li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;"><strong style="box-sizing: border-box; font-weight: 600;">响应式系统改进</strong></p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;">Vue3使用<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">Proxy</code><span>&nbsp;</span>实现响应式，解决了 Vue2使用Object.defineProperty实现响应式的一些局限性，如无法监听新增属性和数组索引变化。</li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;"><strong style="box-sizing: border-box; font-weight: 600;">新特性和改进</strong></p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><p style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; line-height: 24px;"><strong style="box-sizing: border-box; font-weight: 600;">Teleport</strong>：可以将组件的DOM渲染到指定的DOM节点之外，例如模态框、通知等。</p></li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;"><p style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; line-height: 24px;"><strong style="box-sizing: border-box; font-weight: 600;">Fragment 支持</strong>：Vue3支持组件返回多个根节点，不再需要单一根节点。</p></li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;"><p style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; line-height: 24px;">Vue3原生支持<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">TypeScript</code>，提供更完善的类型推导和开发体验。</p></li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;"><p style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; line-height: 24px;">Vue3支持为一个组件绑定多个<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">v-model</code>，并且可以自定义<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">prop</code><span>&nbsp;</span>和<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">event</code><span>&nbsp;</span>名称。</p></li></ul></details>

<h2 id="🔥Vue-组件的通讯方式有哪些？"><a href="#🔥Vue-组件的通讯方式有哪些？" class="headerlink" title="🔥Vue 组件的通讯方式有哪些？"></a>🔥Vue 组件的通讯方式有哪些？</h2><p>组件之间的通讯通常分为父子组件通讯和跨组件通讯。要注意，vue3 组件的通讯方式和 vue2 有一定的区别。</p>
<details class="details custom-block" open="" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(142, 150, 170, 0.14); margin: 16px 0px;"><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;"><strong style="box-sizing: border-box; font-weight: 600;">父子组件通信</strong></p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;">Props：父组件通过<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">props</code><span>&nbsp;</span>向子组件传递数据。</li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">$emit：子组件通过<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">$emit</code><span>&nbsp;</span>向父组件发送事件，并可以传递数据。</li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">获取组件实例对象，调用属性或方法： 💡 Vue 2：通过<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">this.$parent</code><span>&nbsp;</span>获取父组件实例，或通过<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">this.$children</code><span>&nbsp;</span>获取子组件实例。 💡 Vue 3：通过<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">ref</code><span>&nbsp;</span>引用子组件，直接访问其属性和方法。</li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">Vue 3 组件支持多个<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">v-model</code><span>&nbsp;</span>绑定和自定义属性名，父子之间的双向绑定更加灵活。</li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;"><strong style="box-sizing: border-box; font-weight: 600;">跨组件通信</strong></p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;">Provide / Inject：父组件通过<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">provide</code><span>&nbsp;</span>向后代组件传递数据，后代组件使用<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">inject</code><span>&nbsp;</span>接收数据，适用于深层嵌套组件间的通信。</li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">vuex：通过全局状态管理库 Vuex 共享状态，实现跨组件通信（vue2）。</li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">pinia：Pinia 是 Vue 3 推荐的全局状态管理库，替代了 Vuex。</li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">事件总线（Vue 2）：Vue 2 中可以通过<code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">Event Bus</code>实现组件间的通信，但在 Vue 3 中不推荐使用。</li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">全局事件处理器：通过在根组件$root或全局对象上监听事件，进行跨组件通信（Vue 3 推荐使用外部库，如<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">mitt</code>）。</li></ul></details>

<h2 id="Vue-组件的生命周期"><a href="#Vue-组件的生命周期" class="headerlink" title="Vue 组件的生命周期"></a>Vue 组件的生命周期</h2><p>Vue 组件的生命周期是指组件从创建到销毁的整个过程，包括组件的初始化、渲染、更新和销毁等阶段。在Vue2和Vue3中，组件的生命周期有一些区别。</p>
<details class="details custom-block" open="" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(142, 150, 170, 0.14); margin: 16px 0px;"><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><strong style="box-sizing: border-box; font-weight: 600;">创建阶段</strong></li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">1️⃣<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">beforeCreate</strong>：组件实例刚被创建，数据观测和事件/监听器设置之前。此时无法访问<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">data</code><span>&nbsp;</span>、<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">computed</code><span>&nbsp;</span>和<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">methods</code><span>&nbsp;</span>等。 2️⃣<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">created</strong>：组件实例已创建，数据观测、事件/监听器设置完成，此时可以访问<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">data</code><span>&nbsp;</span>、<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">computed</code><span>&nbsp;</span>和<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">methods</code><span>&nbsp;</span>等，通常用于数据初始化。</p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><strong style="box-sizing: border-box; font-weight: 600;">挂载阶段</strong></li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">3️⃣<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">beforeMount</strong>：在挂载开始之前，模板已编译，<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">el</code><span>&nbsp;</span>和<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">template</code><span>&nbsp;</span>已经确定，但尚未渲染。 4️⃣<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">mounted</strong>：组件实例挂载到 DOM 上之后，此时可以访问和操作 DOM。</p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><strong style="box-sizing: border-box; font-weight: 600;">更新阶段</strong></li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">5️⃣<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">beforeUpdate</strong>：数据发生变化，DOM 尚未更新。可以在这里做一些数据处理，避免不必要的渲染。 6️⃣<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">updated</strong>：数据变化，DOM 更新后调用。此时组件的 DOM 已经更新，可以访问和操作新的 DOM。</p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><strong style="box-sizing: border-box; font-weight: 600;">销毁阶段</strong></li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">7️⃣<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">beforeDestroy</strong>：组件实例销毁之前。可以在此阶段进行清理工作，例如移除事件监听器、定时器等。 8️⃣<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">destroyed</strong>：组件实例销毁之后。此时，所有的事件监听器和子组件已被销毁。</p></details>

<details class="details custom-block" open="" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(142, 150, 170, 0.14); margin: 16px 0px;"><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><strong style="box-sizing: border-box; font-weight: 600;">创建阶段</strong></li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">1️⃣<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">onBeforeMount</strong>：等效于 Vue 2 中的<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">beforeMount</code><span>&nbsp;</span>，在组件挂载之前调用。 2️⃣<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">onMounted</strong>：等效于 Vue 2 中的<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">mounted</code><span>&nbsp;</span>，在组件挂载之后调用。</p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><strong style="box-sizing: border-box; font-weight: 600;">更新阶段</strong></li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">3️⃣<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">onBeforeUpdate</strong>：等效于 Vue 2 中的<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">beforeUpdate</code><span>&nbsp;</span>，在数据更新之前调用。 4️⃣<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">onUpdated</strong>：等效于 Vue 2 中的<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">updated</code><span>&nbsp;</span>，在数据更新并渲染之后调用。</p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><strong style="box-sizing: border-box; font-weight: 600;">销毁阶段</strong></li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">5️⃣<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">onBeforeUnmount</strong>：等效于 Vue 2 中的<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">beforeDestroy</code><span>&nbsp;</span>，在组件卸载前调用。 6️⃣<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">onUnmounted</strong>：等效于 Vue 2 中的<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">destroyed</code><span>&nbsp;</span>，在组件卸载后调用。</p></details>

<p>setup与生命周期</p>
<p>setup 作为 Vue3 的 Composition API 的一部分, 其内部函数的执行时机早于Mounted钩子。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">  import &#123; ref, onMounted &#125; from &#x27;vue&#x27;;</span><br><span class="line">  console.log(&quot;setup&quot;);</span><br><span class="line">  onMounted(() =&gt; &#123;</span><br><span class="line">  console.log(&#x27;onMounted&#x27;);</span><br><span class="line">  &#125;);</span><br><span class="line">  // 执行结果:setup onMounted</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Vue-组件在哪个生命周期发送-ajax-请求？"><a href="#Vue-组件在哪个生命周期发送-ajax-请求？" class="headerlink" title="Vue 组件在哪个生命周期发送 ajax 请求？"></a>Vue 组件在哪个生命周期发送 ajax 请求？</h2><p>在 Vue中，接口请求一般放在 <code>created</code> 或 <code>mounted</code> 生命周期钩子中。</p>
<details class="details custom-block" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(142, 150, 170, 0.14); margin: 16px 0px;"><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;"><strong style="box-sizing: border-box; font-weight: 600;"></strong></p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><p style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; line-height: 24px;"><strong style="box-sizing: border-box; font-weight: 600;"></strong><strong style="box-sizing: border-box; font-weight: 600;"></strong></p></li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;"><p style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; line-height: 24px;"></p></li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;"><strong style="box-sizing: border-box; font-weight: 600;"></strong></p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><p style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; line-height: 24px;"><strong style="box-sizing: border-box; font-weight: 600;"></strong></p></li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;"><p style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; line-height: 24px;"><strong style="box-sizing: border-box; font-weight: 600;"></strong><strong style="box-sizing: border-box; font-weight: 600;"></strong><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;"></code></p></li></ul></details>

<h2 id="Vue-父子组件生命周期调用顺序"><a href="#Vue-父子组件生命周期调用顺序" class="headerlink" title="Vue 父子组件生命周期调用顺序"></a>Vue 父子组件生命周期调用顺序</h2><details class="details custom-block" open="" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(142, 150, 170, 0.14); margin: 16px 0px;"><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">1️⃣ 创建阶段</p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;">父组件：<code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">beforeCreate</code><span>&nbsp;</span>➡️<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">created</code></li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">子组件：<code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">beforeCreate</code><span>&nbsp;</span>➡️<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">created</code></li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">顺序： 父组件的<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">beforeCreate</code><span>&nbsp;</span>和<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">created</code><span>&nbsp;</span>先执行 ，子组件的<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">beforeCreate</code><span>&nbsp;</span>和<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">created</code><span>&nbsp;</span>后执行。<blockquote style="box-sizing: border-box; margin: 16px 0px; border-left: 1.6px solid rgb(226, 226, 227); padding-left: 16px; transition: border-color 0.5s; color: rgba(60, 60, 67, 0.78);"><p style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; line-height: 24px; font-size: 14px; transition: color 0.5s; color: inherit;">原因：父组件需要先完成自身的初始化（如 data、computed 等），才能解析模板中的子组件并触发子组件的初始化。</p></blockquote></li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">2️⃣ 挂载阶段</p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;">父组件：<code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">beforeMount</code></li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">子组件：<code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">beforeMount</code><span>&nbsp;</span>➡️<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">mounted</code></li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">父组件：<code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">mounted</code></li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">顺序： 父<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">beforeMount</code><span>&nbsp;</span>→ 子<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">beforeCreate</code>→ 子<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">created</code>→ 子<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">beforeMount</code>→ 子<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">mounted</code><span>&nbsp;</span>→ 父<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">mounted</code><blockquote style="box-sizing: border-box; margin: 16px 0px; border-left: 1.6px solid rgb(226, 226, 227); padding-left: 16px; transition: border-color 0.5s; color: rgba(60, 60, 67, 0.78);"><p style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; line-height: 24px; font-size: 14px; transition: color 0.5s; color: inherit;">原因：父组件在挂载前（beforeMount）需要先完成子组件的渲染和挂载，因为子组件是父组件模板的一部分。只有当所有子组件挂载完成后，父组件才会触发自身的 mounted。</p></blockquote></li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">3️⃣ 更新阶段</p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;">父组件：<code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">beforeUpdate</code></li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">子组件：<code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">beforeUpdate</code><span>&nbsp;</span>➡️<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">updated</code></li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">父组件：<code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">updated</code></li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">顺序： 父<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">beforeUpdate</code><span>&nbsp;</span>→ 子<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">beforeUpdate</code><span>&nbsp;</span>→ 子<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">updated</code><span>&nbsp;</span>→ 父<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">updated</code><blockquote style="box-sizing: border-box; margin: 16px 0px; border-left: 1.6px solid rgb(226, 226, 227); padding-left: 16px; transition: border-color 0.5s; color: rgba(60, 60, 67, 0.78);"><p style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; line-height: 24px; font-size: 14px; transition: color 0.5s; color: inherit;">原因：父组件的数据变化会触发自身更新流程，但子组件的更新必须在父组件更新前完成（因为子组件可能依赖父组件的数据），最终父组件的视图更新完成。</p></blockquote></li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">4️⃣ 销毁阶段</p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;">父组件：<code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">beforeDestroy</code></li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">子组件：<code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">beforeDestroy</code><span>&nbsp;</span>➡️<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">destroyed</code></li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">父组件：<code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">destroyed</code></li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">顺序： 父<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">beforeDestroy</code><span>&nbsp;</span>→ 子<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">beforeDestroy</code><span>&nbsp;</span>→ 子<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">destroyed</code><span>&nbsp;</span>→ 父<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">destroyed</code><blockquote style="box-sizing: border-box; margin: 16px 0px; border-left: 1.6px solid rgb(226, 226, 227); padding-left: 16px; transition: border-color 0.5s; color: rgba(60, 60, 67, 0.78);"><p style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; line-height: 24px; font-size: 14px; transition: color 0.5s; color: inherit;">原因：父组件销毁前需要先销毁所有子组件，确保子组件的资源释放和事件解绑，避免内存泄漏。</p></blockquote></li></ul><div class="tip custom-block" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(100, 108, 255, 0.14); margin: 16px 0px;"><p class="custom-block-title" style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; font-weight: 600; line-height: 24px;">TIP</p><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">注：vue3中，<code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">setup()</code><span>&nbsp;</span>替代了<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">beforeCreate</code><span>&nbsp;</span>和<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">created</code>，但父子组件的生命周期顺序不变。</p></div></details>

<h2 id="🔥v-show-和-v-if-的区别"><a href="#🔥v-show-和-v-if-的区别" class="headerlink" title="🔥v-show 和 v-if 的区别"></a>🔥v-show 和 v-if 的区别</h2><details class="details custom-block" open="" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(142, 150, 170, 0.14); margin: 16px 0px;"><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><strong style="box-sizing: border-box; font-weight: 600;">渲染方式：</strong><span>&nbsp;</span>💡v-if：条件为 true 时才会渲染元素，条件为 false 时销毁元素。 💡v-show：始终渲染元素，只是通过 CSS 控制<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">display 属性</code>来显示或隐藏。</li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;"><strong style="box-sizing: border-box; font-weight: 600;">适用场景：</strong><span>&nbsp;</span>💡v-if：适用于条件变化不频繁的场景。 💡v-show：适用于条件变化频繁的场景。</li></ul></details>

<h2 id="为何v-if和v-for不能一起使用？"><a href="#为何v-if和v-for不能一起使用？" class="headerlink" title="为何v-if和v-for不能一起使用？"></a>为何v-if和v-for不能一起使用？</h2><p><code>v-if</code> 和 <code>v-for</code> 不能直接一起使用的原因，主要是因为它们在 <strong>解析优先级</strong> 和 <strong>逻辑处理</strong> 上存在冲突。</p>
<details class="details custom-block" open="" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(142, 150, 170, 0.14); margin: 16px 0px;"><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">由于<code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">v-for</code><span>&nbsp;</span>的解析优先级高于<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">v-if</code>，同时使用 v-if 和 v-for，Vue 首先会循环创建所有dom元素，然后根据条件来判断是否渲染每个元素，这种方式可能导致 Vue 进行大量的 DOM 操作，性能较差。其次，<code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">v-for</code><span>&nbsp;</span>会为每个循环项创建一个新的作用域，而<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">v-if</code><span>&nbsp;</span>的条件如果依赖于这个作用域内的数据，可能导致判断逻辑异常。</p><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">为避免上述问题，vue官方推荐我们将<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">v-if</code><span>&nbsp;</span>放到<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">v-for</code><span>&nbsp;</span>外层，或者将<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">v-if</code><span>&nbsp;</span>放置到<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">v-for</code><span>&nbsp;</span>内部的单个节点上。</p><div class="language-js vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> v-if</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"show"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> v-for</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"item in list"</span><span style="box-sizing: border-box; color: rgb(179, 29, 40); --shiki-light: #B31D28; --shiki-light-font-style: italic; --shiki-dark: #FDAEB7; --shiki-dark-font-style: italic;"> :key="item.id"&gt;&#123;&#123;</span><span style="box-sizing: border-box; color: rgb(179, 29, 40); --shiki-light: #B31D28; --shiki-light-font-style: italic; --shiki-dark: #FDAEB7; --shiki-dark-font-style: italic;"> item.name</span><span style="box-sizing: border-box; color: rgb(179, 29, 40); --shiki-light: #B31D28; --shiki-light-font-style: italic; --shiki-dark: #FDAEB7; --shiki-dark-font-style: italic;"> &#125;&#125;&lt;/div&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(179, 29, 40); --shiki-light: #B31D28; --shiki-light-font-style: italic; --shiki-dark: #FDAEB7; --shiki-dark-font-style: italic;">&lt;/div&gt;</span></span></code></pre></div></details>

<h2 id="computed-和-watch-有什么区别"><a href="#computed-和-watch-有什么区别" class="headerlink" title="computed 和 watch 有什么区别"></a>computed 和 watch 有什么区别</h2><details class="details custom-block" open="" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(142, 150, 170, 0.14); margin: 16px 0px;"><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;"><strong style="box-sizing: border-box; font-weight: 600;">computed</strong>用于计算基于响应式数据的值，并缓存结果:</p><div class="language-vue vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">p</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;原始值：&#123;&#123; count &#125;&#125;&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">p</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">p</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;计算后的数值：&#123;&#123; doubledCount &#125;&#125;&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">p</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> setup</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">import</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123; ref, computed &#125; </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">from</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;"> 'vue'</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> count</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> ref</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">2</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 计算属性</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> doubledCount</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> computed</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(() </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> count.value </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">*</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> 2</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span></code></pre></div><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;"><strong style="box-sizing: border-box; font-weight: 600;">watch</strong>用于监听数据变化并执行副作用操作</p><div class="language-vue vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">p</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;原始数值：&#123;&#123; count &#125;&#125;&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">p</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">button</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> @click</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"count++"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;增加数值&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">button</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> setup</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">import</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123; ref, watch &#125; </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">from</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;"> 'vue'</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> count</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> ref</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">0</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 监听器</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">watch</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(count, (</span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">newVal</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">oldVal</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  console.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">log</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">`数值从 $&#123;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">oldVal</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">&#125; 变为 $&#123;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">newVal</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">&#125;`</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span></code></pre></div><table tabindex="0" style="box-sizing: border-box; border-collapse: collapse; display: block; margin: 20px 0px; overflow-x: auto;"><thead style="box-sizing: border-box;"><tr style="box-sizing: border-box; background-color: rgb(255, 255, 255); border-top: 0.8px solid rgb(226, 226, 227); transition: background-color 0.5s;"><th style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; text-align: left; font-size: 14px; font-weight: 600; color: inherit; background-color: rgb(246, 246, 247);">特性</th><th style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; text-align: left; font-size: 14px; font-weight: 600; color: inherit; background-color: rgb(246, 246, 247);"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">computed</code></th><th style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; text-align: left; font-size: 14px; font-weight: 600; color: inherit; background-color: rgb(246, 246, 247);"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">watch</code></th></tr></thead><tbody style="box-sizing: border-box;"><tr style="box-sizing: border-box; background-color: rgb(255, 255, 255); border-top: 0.8px solid rgb(226, 226, 227); transition: background-color 0.5s;"><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;"><strong style="box-sizing: border-box; font-weight: 600;">用途</strong></td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">用于计算基于响应式数据的值，并缓存结果</td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">用于监听数据变化并执行副作用操作</td></tr><tr style="box-sizing: border-box; background-color: rgb(246, 246, 247); border-top: 0.8px solid rgb(226, 226, 227); transition: background-color 0.5s;"><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;"><strong style="box-sizing: border-box; font-weight: 600;">返回值</strong></td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">返回计算结果</td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">不返回值，执行副作用</td></tr><tr style="box-sizing: border-box; background-color: rgb(255, 255, 255); border-top: 0.8px solid rgb(226, 226, 227); transition: background-color 0.5s;"><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;"><strong style="box-sizing: border-box; font-weight: 600;">缓存机制</strong></td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">只有在访问时才会计算，会缓存计算结果，仅当依赖变化时重新计算</td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">数据变化时立即执行回调，不缓存，每次数据变化都会触发回调</td></tr><tr style="box-sizing: border-box; background-color: rgb(246, 246, 247); border-top: 0.8px solid rgb(226, 226, 227); transition: background-color 0.5s;"><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;"><strong style="box-sizing: border-box; font-weight: 600;">适用场景</strong></td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">计算派生数据，避免不必要的重复计算</td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">执行异步操作、处理副作用操作，如 API 请求</td></tr><tr style="box-sizing: border-box; background-color: rgb(255, 255, 255); border-top: 0.8px solid rgb(226, 226, 227); transition: background-color 0.5s;"><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;"><strong style="box-sizing: border-box; font-weight: 600;">性能</strong></td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">性能较好，避免重复计算</td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">每次数据变化时都会执行回调函数</td></tr></tbody></table></details>

<h2 id="🔥watch-和-watchEffect-的区别"><a href="#🔥watch-和-watchEffect-的区别" class="headerlink" title="🔥watch 和 watchEffect 的区别"></a>🔥watch 和 watchEffect 的区别</h2><p><code>watch</code> 和 <code>watchEffect</code> 都是 Vue 3 中用于响应式数据变化时执行副作用的 API，它们的使用场景和工作机制存在区别：</p>
<details class="details custom-block" open="" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(142, 150, 170, 0.14); margin: 16px 0px;"><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><strong style="box-sizing: border-box; font-weight: 600;">依赖追踪方式</strong></li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">watch</code><span>&nbsp;</span>：需要显式声明依赖，监听指定的数据源；可以监听多个数据源或进行深度监听。</p><div class="language-js vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">import</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123; watch, reactive &#125; </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">from</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;"> 'vue'</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> state</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> reactive</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(&#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  count: </span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">0</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">watch</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  () </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> state.count, </span><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 显式声明监听的依赖</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  (</span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">newCount</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">oldCount</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    console.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">log</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">`新值 $&#123;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">newCount</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">&#125; 老值 $&#123;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">oldCount</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">&#125;`</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">)</span></span></code></pre></div><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">watchEffect</code><span>&nbsp;</span>：会自动追踪<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">作用域内所有的响应式依赖</strong>，不需要显式声明依赖。</p><div class="language-js vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">import</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123; watchEffect, reactive &#125; </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">from</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;"> 'vue'</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> state</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> reactive</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(&#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  count: </span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">0</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">watchEffect</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(() </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  console.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">log</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">`Count 变化了: $&#123;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">state</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">.</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">count</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">&#125;`</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) </span><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 自动追踪 `state.count`</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;)</span></span></code></pre></div><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><strong style="box-sizing: border-box; font-weight: 600;">执行时机</strong></li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">watch</code><span>&nbsp;</span>：在监听的响应式数据变化后立即执行。</p><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">watchEffect</code><span>&nbsp;</span>：在<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">组件挂载时</strong><span>&nbsp;</span>执行一次副作用，并在<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">依赖发生变化时</strong><span>&nbsp;</span>再次执行。</p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><strong style="box-sizing: border-box; font-weight: 600;">适用场景</strong></li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">watch</code><span>&nbsp;</span>：适用于<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">监听特定数据</strong><span>&nbsp;</span>变化并执行副作用的场景，如 API 请求、保存操作等。适合需要<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">访问新值和旧值</strong><span>&nbsp;</span>进行比较的场景。</p><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">watchEffect</code><span>&nbsp;</span>：不需要访问旧值，适用于<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">自动追踪多个响应式依赖</strong><span>&nbsp;</span>的副作用，如渲染、自动保存等。</p></details>

<blockquote>
<p>Vue官方API： <a target="_blank" rel="noopener" href="https://cn.vuejs.org/api/reactivity-core.html#watcheffect">watchEffect</a></p>
</blockquote>
<h2 id="🔥Vue3-ref-和-reactive-如何选择？"><a href="#🔥Vue3-ref-和-reactive-如何选择？" class="headerlink" title="🔥Vue3 ref 和 reactive 如何选择？"></a>🔥Vue3 ref 和 reactive 如何选择？</h2><p><code>ref</code> 和 <code>reactive</code> 都是 Vue 3 中用来创建响应式数据的 API，他们的区别及使用场景如下。</p>
<details class="details custom-block" open="" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(142, 150, 170, 0.14); margin: 16px 0px;"><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><p style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; line-height: 24px;"><strong style="box-sizing: border-box; font-weight: 600;">reactive的实现：</strong><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">reactive</code><span>&nbsp;</span>通过<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">Proxy</code><span>&nbsp;</span>对对象或数组的每个属性进行深度代理，实现响应式。这种设计使得<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">reactive</code><span>&nbsp;</span>能自动追踪所有嵌套属性的变化，但由于<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">Proxy</code><span>&nbsp;</span>无法直接处理基本数据类型（如<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">number</code><span>&nbsp;</span>、<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">string</code><span>&nbsp;</span>、<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">boolean</code><span>&nbsp;</span>），因此，<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">reactive</code><span>&nbsp;</span>不适用于基本数据类型。</p></li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;"><p style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; line-height: 24px;"><strong style="box-sizing: border-box; font-weight: 600;">ref的实现：</strong><span>&nbsp;</span>为了实现基本数据类型的响应式，Vue 设计了<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">ref</code><span>&nbsp;</span>。<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">ref</code><span>&nbsp;</span>会将基本数据类型封装为一个包含<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">value</code><span>&nbsp;</span>属性的对象，通过<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">getter</code><span>&nbsp;</span>和<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">setter</code><span>&nbsp;</span>实现响应式依赖追踪和更新。当访问或修改<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">ref.value</code><span>&nbsp;</span>时，Vue 内部会触发依赖更新。此外，对于复杂数据类型（如对象或数组），<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">ref</code><span>&nbsp;</span>的内部实现会直接调用<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">reactive</code><span>&nbsp;</span>，将复杂数据类型变为响应式。</p></li></ul><div class="tip custom-block" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(100, 108, 255, 0.14); margin: 16px 0px;"><p class="custom-block-title" style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; font-weight: 600; line-height: 24px;">如何选择</p><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;"><strong style="box-sizing: border-box; font-weight: 600;">Vue官方建议</strong>使用<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">ref()</code><span>&nbsp;</span>作为声明响应式状态的主要，因为<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">reactive</code><span>&nbsp;</span>存在以下局限性：</p><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">💡有限的值类型：它只能用于对象类型 (对象、数组和如 Map、Set 这样的集合类型)。它不能持有如 string、number 或 boolean 这样的原始类型。 💡不能替换整个对象：由于 Vue 的响应式跟踪是通过属性访问实现的，因此我们必须始终保持对响应式对象的相同引用。这意味着我们不能轻易地“替换”响应式对象，因为这样的话与第一个引用的响应性连接将丢失：</p><div class="language-js vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgba(60, 60, 67, 0.78); background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">let</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> state </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> reactive</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(&#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  count: </span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">0</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 上面的 (&#123; count: 0 &#125;) 引用将不再被追踪</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// (响应性连接已丢失！)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">state </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> reactive</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(&#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  count: </span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">1</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;)</span></span></code></pre></div><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">💡对解构操作不友好：当我们将响应式对象的原始类型属性解构为本地变量时，或者将该属性传递给函数时，我们将丢失响应性连接</p><div class="language-js vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgba(60, 60, 67, 0.78); background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> state</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> reactive</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(&#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  count: </span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">0</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 当解构时，count 已经与 state.count 断开连接</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">let</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123; count &#125; </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> state</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 不会影响原始的 state</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">count</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">++</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 该函数接收到的是一个普通的数字</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 并且无法追踪 state.count 的变化</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 我们必须传入整个对象以保持响应性</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">callSomeFunction</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(state.count)</span></span></code></pre></div></div></details>

<h2 id="什么是动态组件？如何使用它？"><a href="#什么是动态组件？如何使用它？" class="headerlink" title="什么是动态组件？如何使用它？"></a>什么是动态组件？如何使用它？</h2><details class="details custom-block" open="" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(142, 150, 170, 0.14); margin: 16px 0px;"><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">动态组件是 Vue 提供的一种机制，允许我们根据条件动态切换渲染的组件，而不需要手动修改模板。 在Vue中，我们可以通过<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">&lt;component&gt;</code><span>&nbsp;</span>标签的<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">:is</code><span>&nbsp;</span>属性指定需要渲染的组件：</p><div class="language-vue vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">    &lt;!-- 动态渲染组件 --&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">component</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> :is</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"currentComponent"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">component</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">    &lt;!-- 控制组件切换 --&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">button</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> @click</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"currentComponent = 'ComponentA'"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;显示组件A&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">button</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">button</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> @click</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"currentComponent = 'ComponentB'"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;显示组件B&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">button</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> setup</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">import</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123; ref &#125; </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">from</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;"> 'vue'</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">import</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> ComponentA </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">from</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;"> './ComponentA.vue'</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">import</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> ComponentB </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">from</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;"> './ComponentB.vue'</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 当前显示的组件</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> currentComponent</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> ref</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'ComponentA'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span></code></pre></div><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">&lt;component&gt;</code><span>&nbsp;</span>标签的<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">:is</code><span>&nbsp;</span>属性值可以是：</p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;">被注册的组件名</li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">导入的组件对象</li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">一般的 HTML 元素</li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">当使用<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">&lt;component :is="..."&gt;</code><span>&nbsp;</span>来在多个组件间作切换时，被切换掉的组件会被卸载。如果需要保留动态组件状态，使用<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">&lt;KeepAlive&gt;</code><span>&nbsp;</span>组件即可。</p></details>

<h2 id="什么是-slot-，有什么应用场景？"><a href="#什么是-slot-，有什么应用场景？" class="headerlink" title="什么是 slot ，有什么应用场景？"></a>什么是 slot ，有什么应用场景？</h2><p>slot 是 Vue 中的一种用于 组件内容分发 的机制。它允许父组件向子组件插入内容，从而使组件更加灵活和可复用。</p>
<details class="details custom-block" open="" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(142, 150, 170, 0.14); margin: 16px 0px;"><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">在Vue中，插槽的使用方式可以分为四种：<strong style="box-sizing: border-box; font-weight: 600;">默认插槽</strong>、<strong style="box-sizing: border-box; font-weight: 600;">具名插槽</strong>、<strong style="box-sizing: border-box; font-weight: 600;">条件插槽</strong>和<strong style="box-sizing: border-box; font-weight: 600;">作用域插槽</strong>。</p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><strong style="box-sizing: border-box; font-weight: 600;">默认插槽</strong></li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">默认插槽是最简单的插槽形式，它允许我们将组件的内容传递到组件内部的一个占位符中。</p><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">子组件<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">MyComponent.vue</code></p><div class="language-vue vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">p</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;我是子组件的标题&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">p</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">slot</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">slot</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span></code></pre></div><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">父组件</p><div class="language-vue vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">MyComponent</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">p</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;这是插槽内容，由父组件传入&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">p</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">MyComponent</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span></code></pre></div><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">输出结果：</p><div class="language-html vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">p</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;我是子组件的标题&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">p</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">p</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;这是插槽内容，由父组件传入&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">p</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span></code></pre></div><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><strong style="box-sizing: border-box; font-weight: 600;">具名插槽</strong></li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">当子组件需要多个插槽时，可以为插槽命名，并由父组件指定内容放置到哪个插槽。</p><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">子组件<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">MyComponent.vue</code></p><div class="language-vue vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">slot</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> name</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"header"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;默认标题&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">slot</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">slot</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;默认内容&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">slot</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">slot</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> name</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"footer"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;默认页脚&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">slot</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span></code></pre></div><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">父组件</p><div class="language-vue vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">MyComponent</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> v-slot</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">:</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">header</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">      &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">h1</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;我来组成头部&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">h1</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">    &lt;!-- 隐式的默认插槽 --&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">p</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;我来组成身体&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">p</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> v-slot</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">:</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">footer</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">      &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">p</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;我来组成尾部&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">p</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">MyComponent</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span></code></pre></div><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">输出结果：</p><div class="language-html vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">h1</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;我来组成头部&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">h1</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">p</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;我来组成身体&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">p</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">p</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;我来组成尾部&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">p</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span></code></pre></div><blockquote style="box-sizing: border-box; margin: 16px 0px; border-left: 1.6px solid rgb(226, 226, 227); padding-left: 16px; transition: border-color 0.5s; color: rgba(60, 60, 67, 0.78);"><p style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; line-height: 24px; font-size: 14px; transition: color 0.5s; color: inherit;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">v-slot</code><span>&nbsp;</span>有对应的简写<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">#</code><span>&nbsp;</span>，因此<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">&lt;template v-slot:header&gt;</code><span>&nbsp;</span>可以简写为<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">&lt;template #header&gt;</code><span>&nbsp;</span>。其意思就是“将这部分模板片段传入子组件的 header 插槽中”。</p></blockquote><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><strong style="box-sizing: border-box; font-weight: 600;">条件插槽</strong></li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">我们可以根据插槽是否存在来渲染某些内容:</p><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">子组件<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">MyComponent.vue</code></p><div class="language-vue vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> class</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"card"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> v-if</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"$slots.header"</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> class</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"card-header"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">      &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">slot</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> name</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"header"</span><span style="box-sizing: border-box; color: rgb(179, 29, 40); --shiki-light: #B31D28; --shiki-light-font-style: italic; --shiki-dark: #FDAEB7; --shiki-dark-font-style: italic;"> /</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> v-if</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"$slots.default"</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> class</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"card-content"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">      &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">slot</span><span style="box-sizing: border-box; color: rgb(179, 29, 40); --shiki-light: #B31D28; --shiki-light-font-style: italic; --shiki-dark: #FDAEB7; --shiki-dark-font-style: italic;"> /</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> v-if</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"$slots.footer"</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> class</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"card-footer"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">      &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">slot</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> name</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"footer"</span><span style="box-sizing: border-box; color: rgb(179, 29, 40); --shiki-light: #B31D28; --shiki-light-font-style: italic; --shiki-dark: #FDAEB7; --shiki-dark-font-style: italic;"> /</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span></code></pre></div><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><strong style="box-sizing: border-box; font-weight: 600;">作用域插槽</strong></li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">作用域插槽可以让子组件在渲染时将一部分数据提供给插槽，从而实现父组件的插槽访问到子组件的状态。</p><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">子组件<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">MyComponent.vue</code></p><div class="language-vue vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">ul</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">    &lt;!-- 定义作用域插槽，并将 items 数据传递给父组件 --&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">slot</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> :items</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"items"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">slot</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">ul</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> setup</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">import</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123; ref &#125; </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">from</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;"> 'vue'</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 定义数据 items</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> items</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> ref</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">([</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'华为'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'小米'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'苹果'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">])</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span></code></pre></div><div class="language-vue vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: -8px 0px 8px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">MyComponent</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">    &lt;!-- 使用作用域插槽，接收子组件传递的 items 数据 --&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> #</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">default</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#123; items &#125;</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">      &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">li</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> v-for</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"(item, index) in items"</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> :key</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"index"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">        &#123;&#123; item &#125;&#125;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">      &lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">li</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">MyComponent</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> setup</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">import</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> MyComponent </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">from</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;"> './MyComponent.vue'</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span></code></pre></div><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">输出结果：</p><div class="language-html vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">ul</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">li</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;华为&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">li</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">li</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;小米&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">li</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">li</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;苹果&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">li</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">ul</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span></code></pre></div><blockquote style="box-sizing: border-box; margin: 16px 0px; border-left: 1.6px solid rgb(226, 226, 227); padding-left: 16px; transition: border-color 0.5s; color: rgba(60, 60, 67, 0.78);"><p style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; line-height: 24px; font-size: 14px; transition: color 0.5s; color: inherit;">Vue官方API：<span>&nbsp;</span><a href="https://cn.vuejs.org/guide/components/slots.html#scoped-slots" target="_blank" rel="noreferrer" style="box-sizing: border-box; touch-action: manipulation; color: rgb(52, 81, 178); text-decoration: underline; font-weight: 500; text-underline-offset: 2px; transition: color 0.25s, opacity 0.25s;">插槽 Slots</a></p></blockquote><div class="tip custom-block" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(100, 108, 255, 0.14); margin: 16px 0px;"><p class="custom-block-title" style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; font-weight: 600; line-height: 24px;">应用场景</p><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">💡灵活的组件内容插入： 插槽允许我我们将内容插入组件中，而无需修改子组件内部逻辑，极大提高了组件的灵活性。</p><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">💡构建通用组件： 比如开发卡片、模态框、列表等组件，使用插槽可以轻松实现内容的自定义。模态框组件可通过插槽自定义标题、正文和按钮。</p><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">💡减少重复代码： 通过插槽，将公共逻辑封装到子组件中，而在父组件中只需插入变化的内容。</p></div></details>

<h2 id="🚀Vue-项目可做哪些性能优化？"><a href="#🚀Vue-项目可做哪些性能优化？" class="headerlink" title="🚀Vue 项目可做哪些性能优化？"></a>🚀Vue 项目可做哪些性能优化？</h2><p>🔍在 Vue 项目中，我们可以利用 Vue 特有的功能和机制实现性能优化。</p>
<details class="details custom-block" open="" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(142, 150, 170, 0.14); margin: 16px 0px;"><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">1️⃣<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">模板和指令优化</strong></p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;">合理的使用<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">v-if</code><span>&nbsp;</span>和<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">v-show</code><span>&nbsp;</span>指令，避免不必要的渲染。</li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">使用<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">v-for</code><span>&nbsp;</span>时，尽量提供唯一的<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">key</code><span>&nbsp;</span>，避免重复渲染。</li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">使用<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">v-once</code><span>&nbsp;</span>指令，只渲染一次，避免不必要的计算。</li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">使用<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">v-memo</code><span>&nbsp;</span>指令，对使用<code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">v-for</code>生成的列表进行渲染优化。<code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">(vue3.2新增)</code></li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">2️⃣<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">组件优化</strong></p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;">合理使用<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">keep-alive</code><span>&nbsp;</span>组件，缓存组件实例，避免重复渲染。</li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">使用异步组件加载，减少首屏加载时间。</li></ul><div class="language-js vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> AsyncComponent</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> defineAsyncComponent</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(() </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> import</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'./MyComponent.vue'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">))</span></span></code></pre></div><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;">配合 Vue Router 使用路由懒加载，实现路由页面按需加载。</li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">合理划分组件，提升复用性和渲染性能。</li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">3️⃣<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">响应式优化</strong></p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><p style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; line-height: 24px;">使用<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">Object.freeze</code><span>&nbsp;</span>冻结对象，避免不必要的响应式。</p></li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;"><p style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; line-height: 24px;">使用 stop 停止 不必要的watchEffect副作用执行，以减少性能消耗。</p></li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;"><p style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; line-height: 24px;">watch的优化</p><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">💡 避免滥用深度监听，降低性能开销。</p><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">💡 对于频繁触发的响应式数据变化，可以通过防抖和节流优化监听逻辑。</p></li></ul><div class="language-js vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">import</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123; debounce &#125; </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">from</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;"> 'lodash'</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">watch</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  () </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> searchQuery,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">  debounce</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">((</span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">newQuery</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">    fetchSearchResults</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(newQuery)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;, </span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">300</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">)</span></span></code></pre></div><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">💡 可以通过返回函数只监听具体的依赖，减少不必要的触发。</p><div class="language-js vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">watch</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">([() </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> user.name, () </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> user.age], ([</span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">newName</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">newAge</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">]) </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">  //...</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;)</span></span></code></pre></div><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">💡 当监听器在某些条件下不再需要时，可以通过返回的 stop 方法手动停止监听，以节省资源</p><div class="language-js vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> stop</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> watch</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  () </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> data.value,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  (</span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">newValue</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">    if</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> (newValue </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">===</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;"> 'done'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">      stop</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">() </span><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 停止监听</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &#125;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">)</span></span></code></pre></div><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">💡 当多个监听器的回调逻辑类似时，可以合并监听</p><div class="language-js vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">watch</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">([() </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> user.name, () </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> user.age], ([</span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">newName</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">newAge</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">]) </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">  //...</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;)</span></span></code></pre></div></details>

<h2 id="什么是-nextTick-如何应用它"><a href="#什么是-nextTick-如何应用它" class="headerlink" title="什么是 nextTick 如何应用它"></a>什么是 nextTick 如何应用它</h2><details class="details custom-block" open="" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(142, 150, 170, 0.14); margin: 16px 0px;"><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">在 Vue.js 中，<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">nextTick</code><span>&nbsp;</span>是一个核心工具方法，用于处理 DOM 更新时机问题。它的核心作用是：<strong style="box-sizing: border-box; font-weight: 600;">在下次 DOM 更新循环结束后执行回调，确保我们能操作到最新的 DOM 状态。</strong><span>&nbsp;</span>它的使用场景如下：</p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;">数据变化后操作 DOM</li></ul><div class="language-vue vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> setup</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">async</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> function</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> increment</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">() &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  count.value</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">++</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">  // DOM 还未更新</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  console.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">log</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(document.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">getElementById</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'counter'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">).textContent) </span><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 0</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">  await</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> nextTick</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">()</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">  // DOM 此时已经更新</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  console.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">log</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(document.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">getElementById</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'counter'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">).textContent) </span><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 1</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">button</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> id</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"counter"</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> @click</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"increment"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;&#123;&#123; count &#125;&#125;&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">button</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span></code></pre></div><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;">在生命周期钩子中操作 DOM</li></ul><div class="language-vue vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> setup</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">import</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123; ref, onMounted, nextTick &#125; </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">from</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;"> 'vue'</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 创建 DOM 引用</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> element</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> ref</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">null</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">onMounted</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(() </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">  // 直接访问可能未渲染完成</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  console.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">log</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(element.value.offsetHeight) </span><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 0 或未定义</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">  // 使用 nextTick 确保 DOM 已渲染</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">  nextTick</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(() </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    console.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">log</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(element.value.offsetHeight) </span><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 实际高度</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span></code></pre></div><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">注意，在vue2中和vue3的选项式 API中，我们使用this.$nextTick(callback)的方式调用。</p><div class="language-js vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">this</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">$nextTick</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(() </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  console.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">log</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">this</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">.$refs.text.innerText) </span><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// "更新后的文本"</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;)</span></span></code></pre></div></details>

<h2 id="使用-Vue3-Composable-组合式函数，实现-useCount"><a href="#使用-Vue3-Composable-组合式函数，实现-useCount" class="headerlink" title="使用 Vue3 Composable 组合式函数，实现 useCount"></a>使用 Vue3 Composable 组合式函数，实现 useCount</h2><p>TIP</p>
<p>在 Vue 应用的概念中，“<strong>组合式函数</strong>”(Composables) 是一个利用 Vue 的组合式 API 来封装和复用有状态逻辑的函数。它和自定义 <code>React hooks</code> 非常相似。</p>
<p>使用组合式函数实现如下需求：useCount 是一个计数逻辑管理的组合式函数，它返回一个 <code>count</code> 变量和增加、减少、重置count的方法。</p>
<details class="details custom-block" open="" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(142, 150, 170, 0.14); margin: 16px 0px;"><div class="language-vue vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> setup</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">import</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123; ref &#125; </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">from</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;"> 'vue'</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 实现 useCount 组合式函数</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">function</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> useCount</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">() &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">  const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> count</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> ref</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">0</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">  const</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> increment</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> () </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    count.value</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">++</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">  const</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> decrement</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> () </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    count.value</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">--</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">  const</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> reset</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> () </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    count.value </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> 0</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">  return</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    count,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    increment,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    decrement,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    reset,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 使用 useCount 组合式函数</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">const</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123; </span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">count</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">increment</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">decrement</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">reset</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#125; </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> useCount</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">()</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">h2</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;计数器: &#123;&#123; count &#125;&#125;&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">h2</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">button</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> @click</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"increment"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;增加&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">button</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">button</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> @click</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"decrement"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;减少&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">button</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">button</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> @click</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"reset"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;重置&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">button</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span></code></pre></div></details>

<h2 id="使用-Vue3-Composable-组合式函数，实现-useRequest"><a href="#使用-Vue3-Composable-组合式函数，实现-useRequest" class="headerlink" title="使用 Vue3 Composable 组合式函数，实现 useRequest"></a>使用 Vue3 Composable 组合式函数，实现 useRequest</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const &#123; loading, data, error &#125; = useRequest(url) // 可只考虑 get 请求</span><br></pre></td></tr></table></figure>

<details class="details custom-block" open="" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(142, 150, 170, 0.14); margin: 16px 0px;"><div class="language-ts vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">import</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123; ref, computed &#125; </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">from</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;"> 'vue'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">import</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> axios </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">from</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;"> 'axios'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 实现 useRequest 组合式函数</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">function</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> useRequest</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">url</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">  const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> loading</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> ref</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">false</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">); </span><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 请求状态</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">  const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> data</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> ref</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">null</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">); </span><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 响应数据</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">  const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> error</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> ref</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">null</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">); </span><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 错误信息</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">  const</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> fetchData</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> async</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> () </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    loading.value </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> true</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    error.value </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> null</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">    try</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">      const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> response</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> await</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> axios.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">get</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(url); </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">/</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">      data.value </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> response.data;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &#125; </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">catch</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> (err) &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">      error.value </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> err.message </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">||</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;"> '请求失败'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">; </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">/</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &#125; </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">finally</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">      loading.value </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> false</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &#125;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">  // 自动触发请求</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">  fetchData</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">();</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">  return</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    loading,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    data,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    error,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">export</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> default</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> useRequest;</span></span></code></pre></div><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">使用</p><div class="language-vue vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> setup</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">import</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> useRequest </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">from</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;"> './useRequest'</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> url</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;"> 'https://www.mianshipai.com/'</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">const</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123; </span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">loading</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">data</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">error</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#125; </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> useRequest</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(url)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">h2</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;请求数据&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">h2</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> v-if</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"loading"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;加载中...&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> v-else-if</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"error"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;&#123;&#123; error &#125;&#125;&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> v-else</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">      &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">p</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;&#123;&#123; data &#125;&#125;&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">p</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span></code></pre></div></details>

<h2 id="自定义组件如何实现-v-model"><a href="#自定义组件如何实现-v-model" class="headerlink" title="自定义组件如何实现 v-model"></a>自定义组件如何实现 v-model</h2><p><code>v-model</code> 可以在组件上使用以实现双向绑定。</p>
<details class="details custom-block" open="" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(142, 150, 170, 0.14); margin: 16px 0px;"><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">在vue2中，自定义组件使用<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">v-model</code><span>&nbsp;</span>，需要在组件内部定义<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">value</code><span>&nbsp;</span>prop，然后通过<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">this.$emit('input', newValue)</code><span>&nbsp;</span>触发更新即可。</p><div class="language-vue vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">&lt;!-- CustomInput.vue --&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">input</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> :value</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"value"</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> @input</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"$emit('input', $event.target.value)"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> /&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">export</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> default</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  props: [</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'value'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">],</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span></code></pre></div><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">使用方式：</p><div class="language-vue vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">CustomInput</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> v-model</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">searchText</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> /&gt;</span></span></code></pre></div></details>

<details class="details custom-block" open="" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(142, 150, 170, 0.14); margin: 16px 0px;"><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">与vue2类似，vue3自定义组件使用<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">v-model</code><span>&nbsp;</span>，需要在组件内部定义<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">modelValue</code><span>&nbsp;</span>prop，然后通过<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">emit('update:modelValue', newValue)</code><span>&nbsp;</span>触发更新</p><div class="language-vue vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">&lt;!-- CustomInput.vue --&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">input</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> :value</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"modelValue"</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> @input</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"$emit('update:modelValue', $event.target.value)"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> /&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> setup</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">defineProps</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">([</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'modelValue'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">])</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">defineEmits</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">([</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'update:modelValue'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">])</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span></code></pre></div><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">使用方式：</p><div class="language-vue vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">CustomInput</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> v-model</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">searchText</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> /&gt;</span></span></code></pre></div><hr style="box-sizing: border-box; margin: 16px 0px; border-right: none; border-bottom: none; border-left: none; border-image: initial; border-top: 0.8px solid rgb(226, 226, 227);"><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;"><strong style="box-sizing: border-box; font-weight: 600;">👉注意，从 Vue 3.4 开始，官方推荐的实现方式是使用 defineModel() 宏：</strong></p><div class="language-vue vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">&lt;!-- Child.vue --&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> setup</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> model</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> defineModel</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">()</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">function</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> update</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">() &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  model.value</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">++</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;父组件的 v-model 值为: &#123;&#123; model &#125;&#125;&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">button</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> @click</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"update"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;Increment&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">button</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span></code></pre></div><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">父组件使用 v-model 绑定一个值：</p><div class="language-vue vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">&lt;!-- Parent.vue --&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">Child</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> v-model</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">countModel</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> /&gt;</span></span></code></pre></div><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">defineModel</code><span>&nbsp;</span>是一个便利宏，其返回的值是一个<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">ref</code><span>&nbsp;</span>。它可以像其他<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">ref</code><span>&nbsp;</span>一样被访问以及修改，不过它能起到在父组件和当前变量之间的双向绑定的作用：</p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;">它的<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">.value</code><span>&nbsp;</span>和父组件的<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">v-model</code><span>&nbsp;</span>的值同步；</li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">当它被子组件变更了，会触发父组件绑定的值一起更新。 根据<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">defineModel</code><span>&nbsp;</span>的特性，我们可以用<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">v-model</code><span>&nbsp;</span>把这个<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">ref</code><span>&nbsp;</span>绑定到一个原生<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">input</code><span>&nbsp;</span>元素上：</li></ul><div class="language-vue vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> setup</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> model</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> defineModel</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">()</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">input</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> v-model</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"model"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> /&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span></code></pre></div><blockquote style="box-sizing: border-box; margin: 16px 0px; border-left: 1.6px solid rgb(226, 226, 227); padding-left: 16px; transition: border-color 0.5s; color: rgba(60, 60, 67, 0.78);"><p style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; line-height: 24px; font-size: 14px; transition: color 0.5s; color: inherit;">此外，v-model 可以接受自定义参数、添加修饰符，组件也可以绑定多个 v-model ，具体用法请参考 官网文档：<a href="https://cn.vuejs.org/guide/components/v-model" target="_blank" rel="noreferrer" style="box-sizing: border-box; touch-action: manipulation; color: rgb(52, 81, 178); text-decoration: underline; font-weight: 500; text-underline-offset: 2px; transition: color 0.25s, opacity 0.25s;">组件 v-model</a></p></blockquote></details>

<h2 id="如何统一监听-Vue-组件报错"><a href="#如何统一监听-Vue-组件报错" class="headerlink" title="如何统一监听 Vue 组件报错"></a>如何统一监听 Vue 组件报错</h2><details class="details custom-block" open="" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(142, 150, 170, 0.14); margin: 16px 0px;"><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">在 Vue 3 中，可以通过 全局错误处理器<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">（errorHandler）</code><span>&nbsp;</span>和 生命周期钩子（例如<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">onErrorCaptured</code><span>&nbsp;</span>）来统一监听和处理组件中的错误。</p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><strong style="box-sizing: border-box; font-weight: 600;">通过全局错误处理器<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">app.config.errorHandler</code></strong></li></ul><div class="language-TypeScript vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">import</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123; createApp &#125; </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">from</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;"> 'vue'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> app</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> createApp</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(App);</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 设置全局错误处理器</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">app.config.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">errorHandler</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> (</span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">err</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">instance</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">info</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  console.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">error</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'捕获到组件错误: '</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, err);</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  console.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">log</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'发生错误的组件实例: '</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, instance);</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  console.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">log</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'错误信息: '</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, info);</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">app.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">mount</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'#app'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">);</span></span></code></pre></div><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><strong style="box-sizing: border-box; font-weight: 600;">局部错误捕获（onErrorCaptured）</strong></li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">onErrorCaptured</code><span>&nbsp;</span>钩子可以捕获后代组件传递过程中的错误信息</p><div class="language-vue vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> setup</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">import</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123; onErrorCaptured &#125; </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">from</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;"> 'vue'</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">onErrorCaptured</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">((</span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">err</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">instance</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">info</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  console.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">error</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'局部捕获到错误: '</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, err)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  console.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">log</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'错误来源组件: '</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, instance)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  console.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">log</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'错误信息: '</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, info)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">  // 这个钩子可以通过返回 false 来阻止错误继续向上传递。</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">  return</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> false</span><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;"> // 如果需要让错误冒泡到全局，省略或返回 true</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">h2</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;局部错误捕获示例&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">h2</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">ErrorProneComponent</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> /&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">div</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span></code></pre></div><blockquote style="box-sizing: border-box; margin: 16px 0px; border-left: 1.6px solid rgb(226, 226, 227); padding-left: 16px; transition: border-color 0.5s; color: rgba(60, 60, 67, 0.78);"><p style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; line-height: 24px; font-size: 14px; transition: color 0.5s; color: inherit;">Vue官方API：<span>&nbsp;</span><a href="https://cn.vuejs.org/api/composition-api-lifecycle.html#onerrorcaptured" target="_blank" rel="noreferrer" style="box-sizing: border-box; touch-action: manipulation; color: rgb(52, 81, 178); text-decoration: underline; font-weight: 500; text-underline-offset: 2px; transition: color 0.25s, opacity 0.25s;">onErrorCaptured</a>、<a href="https://cn.vuejs.org/api/application.html#app-config-errorhandler" target="_blank" rel="noreferrer" style="box-sizing: border-box; touch-action: manipulation; color: rgb(52, 81, 178); text-decoration: underline; font-weight: 500; text-underline-offset: 2px; transition: color 0.25s, opacity 0.25s;">errorHandler</a></p></blockquote></details>

<h2 id="Vuex-中-mutation-和-action-有什么区别？"><a href="#Vuex-中-mutation-和-action-有什么区别？" class="headerlink" title="Vuex 中 mutation 和 action 有什么区别？"></a>Vuex 中 mutation 和 action 有什么区别？</h2><p>在 Vuex 中， <code>mutation</code> 和 <code>action</code> 是用于管理状态的两种核心概念。</p>
<details class="details custom-block" open="" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(142, 150, 170, 0.14); margin: 16px 0px;"><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">mutation</code><span>&nbsp;</span>可以直接修改<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">store</code><span>&nbsp;</span>中的<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">state</strong>值，它只支持同步操作。<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">Action</code><span>&nbsp;</span>不能直接修改<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">state</strong>，而是通过调用<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">mutation</code><span>&nbsp;</span>来间接修改，它用于处理异步操作。</p><div class="language-js vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> store</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> createStore</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(&#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  state: &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    count: </span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">0</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 定义状态</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  mutations: &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">    // Mutation 示例（同步）</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">    increment</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">state</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">payload</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">      state.count </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">+=</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> payload</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &#125;,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 组件中调用</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">this</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">.$store.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">commit</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'increment'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">5</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">)</span></span></code></pre></div><div class="language-js vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: -8px 0px 8px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> store</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> createStore</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(&#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  state: &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    count: </span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">0</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 定义状态</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  mutations: &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">    // Mutation：同步修改状态</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">    increment</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">state</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">payload</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">      state.count </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">+=</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> payload</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &#125;,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  actions: &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">    // Action：异步操作，延迟1秒后调用 mutation</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">    asyncIncrement</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(&#123; </span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">commit</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#125;, </span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">payload</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">      setTimeout</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(() </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">        commit</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'increment'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, payload) </span><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 提交 mutation 修改状态</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">      &#125;, </span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">1000</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &#125;,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 组件中调用</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">this</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">.$store.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">dispatch</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'asyncIncrement'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">5</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">)</span></span></code></pre></div><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;"><strong style="box-sizing: border-box; font-weight: 600;">总结：</strong></p><table tabindex="0" style="box-sizing: border-box; border-collapse: collapse; display: block; margin: 20px 0px; overflow-x: auto;"><thead style="box-sizing: border-box;"><tr style="box-sizing: border-box; background-color: rgb(255, 255, 255); border-top: 0.8px solid rgb(226, 226, 227); transition: background-color 0.5s;"><th style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; text-align: left; font-size: 14px; font-weight: 600; color: inherit; background-color: rgb(246, 246, 247);">特性</th><th style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; text-align: left; font-size: 14px; font-weight: 600; color: inherit; background-color: rgb(246, 246, 247);">Mutation</th><th style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; text-align: left; font-size: 14px; font-weight: 600; color: inherit; background-color: rgb(246, 246, 247);">Action</th></tr></thead><tbody style="box-sizing: border-box;"><tr style="box-sizing: border-box; background-color: rgb(255, 255, 255); border-top: 0.8px solid rgb(226, 226, 227); transition: background-color 0.5s;"><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">是否同步</td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">✅ 同步</td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">⏳ 异步（也可以处理同步）</td></tr><tr style="box-sizing: border-box; background-color: rgb(246, 246, 247); border-top: 0.8px solid rgb(226, 226, 227); transition: background-color 0.5s;"><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">是否直接修改 state</td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">✅ 直接修改</td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">❌ 通过调用 mutation 修改</td></tr><tr style="box-sizing: border-box; background-color: rgb(255, 255, 255); border-top: 0.8px solid rgb(226, 226, 227); transition: background-color 0.5s;"><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">调用方式</td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">commit('mutationName')</code></td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">dispatch('actionName')</code></td></tr><tr style="box-sizing: border-box; background-color: rgb(246, 246, 247); border-top: 0.8px solid rgb(226, 226, 227); transition: background-color 0.5s;"><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">适用场景</td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">简单的状态修改</td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">异步操作（如 API 调用）</td></tr><tr style="box-sizing: border-box; background-color: rgb(255, 255, 255); border-top: 0.8px solid rgb(226, 226, 227); transition: background-color 0.5s;"><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">调试支持</td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">完全支持，易于追踪</td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">依赖于 mutation 的日志</td></tr></tbody></table><div class="tip custom-block" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(100, 108, 255, 0.14); margin: 16px 0px;"><p class="custom-block-title" style="box-sizing: border-box; margin: 0px; overflow-wrap: break-word; font-weight: 600; line-height: 24px;">⚠️ 为什么要有这样的区分？</p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;">数据可预测性：通过强制<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">Mutation</code><span>&nbsp;</span>同步修改<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">State</strong>，使得状态变更可追踪</li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">调试友好性：DevTools 可以准确捕捉每次状态快照</li><li style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 8px;">代码组织：将同步逻辑与异步逻辑分离，提高代码可维护性</li></ul></div></details>

<p>参考文章：<a target="_blank" rel="noopener" href="https://juejin.cn/post/7249033891809329212">VueX用法快速回顾</a></p>
<h2 id="Vuex-和-Pinia-有什么区别？"><a href="#Vuex-和-Pinia-有什么区别？" class="headerlink" title="Vuex 和 Pinia 有什么区别？"></a>Vuex 和 Pinia 有什么区别？</h2><details class="details custom-block" open="" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(142, 150, 170, 0.14); margin: 16px 0px;"><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">Pinia</code><span>&nbsp;</span>和<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">Vuex</code><span>&nbsp;</span>都是 Vue 的专属状态管理库，允许用户跨组件或页面共享状态。</p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><strong style="box-sizing: border-box; font-weight: 600;">区别</strong></li></ul><table tabindex="0" style="box-sizing: border-box; border-collapse: collapse; display: block; margin: 20px 0px; overflow-x: auto;"><thead style="box-sizing: border-box;"><tr style="box-sizing: border-box; background-color: rgb(255, 255, 255); border-top: 0.8px solid rgb(226, 226, 227); transition: background-color 0.5s;"><th style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; text-align: left; font-size: 14px; font-weight: 600; color: inherit; background-color: rgb(246, 246, 247);">特性</th><th style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; text-align: left; font-size: 14px; font-weight: 600; color: inherit; background-color: rgb(246, 246, 247);"><strong style="box-sizing: border-box; font-weight: 600;">Vuex</strong></th><th style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; text-align: left; font-size: 14px; font-weight: 600; color: inherit; background-color: rgb(246, 246, 247);"><strong style="box-sizing: border-box; font-weight: 600;">Pinia</strong></th></tr></thead><tbody style="box-sizing: border-box;"><tr style="box-sizing: border-box; background-color: rgb(255, 255, 255); border-top: 0.8px solid rgb(226, 226, 227); transition: background-color 0.5s;"><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;"><strong style="box-sizing: border-box; font-weight: 600;">版本支持</strong></td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">Vue 2 和 Vue 3</td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">仅支持 Vue 3（基于<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">Composition API</code><span>&nbsp;</span>）</td></tr><tr style="box-sizing: border-box; background-color: rgb(246, 246, 247); border-top: 0.8px solid rgb(226, 226, 227); transition: background-color 0.5s;"><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;"><strong style="box-sizing: border-box; font-weight: 600;">API 风格</strong></td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">基于传统的对象式 API</td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">基于 Composition API，类似于<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">setup</code><br style="box-sizing: border-box;">语法</td></tr><tr style="box-sizing: border-box; background-color: rgb(255, 255, 255); border-top: 0.8px solid rgb(226, 226, 227); transition: background-color 0.5s;"><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;"><strong style="box-sizing: border-box; font-weight: 600;">模块管理</strong></td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">支持模块化（modules），但语法较复杂</td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">模块化简单，<strong style="box-sizing: border-box; font-weight: 600;">每个 store 就是一个独立模块</strong></td></tr><tr style="box-sizing: border-box; background-color: rgb(246, 246, 247); border-top: 0.8px solid rgb(226, 226, 227); transition: background-color 0.5s;"><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;"><strong style="box-sizing: border-box; font-weight: 600;">TypeScript 支持</strong></td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">TypeScript</code><span>&nbsp;</span>支持不完善，需手动定义类型</td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">开箱即用的<span>&nbsp;</span><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">TypeScript</code><span>&nbsp;</span>支持，类型推导更强大</td></tr><tr style="box-sizing: border-box; background-color: rgb(255, 255, 255); border-top: 0.8px solid rgb(226, 226, 227); transition: background-color 0.5s;"><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;"><strong style="box-sizing: border-box; font-weight: 600;">性能</strong></td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">更适合大型项目，但冗余代码较多</td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">更加轻量，性能更好，支持按需加载</td></tr><tr style="box-sizing: border-box; background-color: rgb(246, 246, 247); border-top: 0.8px solid rgb(226, 226, 227); transition: background-color 0.5s;"><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;"><strong style="box-sizing: border-box; font-weight: 600;">状态持久化</strong></td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">需要额外插件</td><td style="box-sizing: border-box; border-color: rgb(226, 226, 227); border-style: solid; border-width: 0.8px; border-image: none 100% / 1 / 0 stretch; padding: 8px 16px; font-size: 14px;">插件系统更加灵活，支持状态持久化插件</td></tr></tbody></table><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><strong style="box-sizing: border-box; font-weight: 600;">代码对比</strong></li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">📝<span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;">vuex</strong></p><div class="language-javascript vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// store.js</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">import</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123; createStore &#125; </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">from</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;"> 'vuex'</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> store</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> createStore</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(&#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  state: &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    count: </span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">0</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  mutations: &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">    increment</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">state</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">      state.count</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">++</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &#125;,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  actions: &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">    asyncIncrement</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(&#123; </span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">commit</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#125;) &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">      setTimeout</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(() </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">        commit</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'increment'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">      &#125;, </span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">1000</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &#125;,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  getters: &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">    doubleCount</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">: (</span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">state</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> state.count </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">*</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> 2</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">export</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> default</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> store</span></span></code></pre></div><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">vue组件中使用</p><div class="language-vue vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">export</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> default</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">  // 计算属性</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  computed: &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">    count</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">() &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">      return</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> this</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">.$store.state.count</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &#125;,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">    doubleCount</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">() &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">      return</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> this</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">.$store.getters.doubleCount</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &#125;,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  methods: &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">    // 同步增加</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">    increment</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">() &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">      this</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">.$store.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">commit</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'increment'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &#125;,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">    // 异步增加</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">    asyncIncrement</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">() &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">      this</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">.$store.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">dispatch</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'asyncIncrement'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &#125;,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span></code></pre></div><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">📝<strong style="box-sizing: border-box; font-weight: 600;">Pinia</strong></p><div class="language-typescript vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// store.js</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">import</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123; defineStore &#125; </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">from</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;"> 'pinia'</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">export</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> useCounterStore</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> defineStore</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'counter'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">  state</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">: () </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> (&#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    count: </span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">0</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;),</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  actions: &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">    increment</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">() &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">      this</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">.count</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">++</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &#125;,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">    async</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> asyncIncrement</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">() &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">      setTimeout</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(() </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">        this</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">increment</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">()</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">      &#125;, </span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">1000</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">    &#125;,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  getters: &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">    doubleCount</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">: (</span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">state</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> state.count </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">*</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> 2</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;,</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;)</span></span></code></pre></div><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">组件中使用：</p><div class="language-vue vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> setup</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">import</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123; useCounterStore &#125; </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">from</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;"> './store'</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> counter</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> useCounterStore</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">()</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">script</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">h1</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;Count的计算值 &#123;&#123; counter.count &#125;&#125;&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">h1</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">h2</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;Double的计算值 &#123;&#123; counter.doubleCount &#125;&#125;&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">h2</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">button</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> @click</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"counter.increment"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;同步增加&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">button</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &lt;</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">button</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;"> @click</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">=</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">"counter.asyncIncrement"</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;异步增加&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">button</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&lt;/</span><span style="box-sizing: border-box; color: rgb(34, 134, 58); --shiki-light: #22863A; --shiki-dark: #85E89D;">template</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&gt;</span></span></code></pre></div><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;"><strong style="box-sizing: border-box; font-weight: 600;">如何选择？</strong></li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">对于vue3项目，官方推荐使用pinia。因为它<strong style="box-sizing: border-box; font-weight: 600;">更轻量、TypeScript 支持更好、模块化更简单且拥有更强的 DevTools 支持</strong>。</p></details>

<h2 id="Vue-router-导航守卫能用来做什么？"><a href="#Vue-router-导航守卫能用来做什么？" class="headerlink" title="Vue-router 导航守卫能用来做什么？"></a>Vue-router 导航守卫能用来做什么？</h2><details class="details custom-block" open="" style="box-sizing: border-box; border: 1px solid rgba(0, 0, 0, 0); border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: 14px; color: rgb(60, 60, 67); background-color: rgba(142, 150, 170, 0.14); margin: 16px 0px;"><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; color: rgb(52, 81, 178); border-radius: 4px; padding: 3px 6px; background-color: rgba(142, 150, 170, 0.14); transition: color 0.25s, background-color 0.5s;">vue Router</code><span>&nbsp;</span>的<strong style="box-sizing: border-box; font-weight: 600;">导航守卫</strong>用于在路由跳转过程中对导航行为进行<strong style="box-sizing: border-box; font-weight: 600;">拦截</strong>和<strong style="box-sizing: border-box; font-weight: 600;">控制</strong>。这些守卫在路由进入、离开或更新时执行，可以用于多种场景，确保应用的导航逻辑符合预期。以下是常见的用途：</p><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;">认证和授权</li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">用于检查用户的登录状态或权限，防止未授权用户访问受限页面。</p><div class="language-javascript vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">router.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">beforeEach</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">((</span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">to</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">from</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">next</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">  const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> isAuthenticated</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> !!</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">localStorage.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">getItem</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'token'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">  if</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> (to.meta.requiresAuth </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">&amp;&amp;</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> !</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">isAuthenticated) &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">    next</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'/login'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) </span><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 未登录，跳转到登录页</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125; </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">else</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">    next</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">() </span><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 已登录，正常导航</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;)</span></span></code></pre></div><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;">数据预加载</li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">在进入路由前预加载必要的数据，确保页面渲染时数据已准备好。</p><div class="language-javascript vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">router.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">beforeEach</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">async</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> (</span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">to</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">from</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">next</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">  if</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> (to.name </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">===</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;"> 'userInfo'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">    await</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> store.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">dispatch</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'fetchUserData'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) </span><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 预加载用户数据</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">  next</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">()</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;)</span></span></code></pre></div><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;">动态修改页面标题</li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">根据路由信息动态更改浏览器标签页的标题，提升用户体验。</p><div class="language-javascript vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">router.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">afterEach</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">((</span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">to</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  document.title </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> to.meta.title </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">||</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;"> '自定义标题'</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;)</span></span></code></pre></div><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;">动画和加载效果</li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">在路由切换时展示加载动画或过渡效果，提升用户体验。</p><div class="language-javascript vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">router.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">beforeEach</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">((</span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">to</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">from</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">next</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  store.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">commit</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'setLoading'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">true</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) </span><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 开始加载动画</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">  next</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">()</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">router.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">afterEach</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(() </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  store.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">commit</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'setLoading'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;">false</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) </span><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 结束加载动画</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;)</span></span></code></pre></div><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;">日志记录和分析</li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">在路由切换时记录用户行为，用于分析或调试。</p><div class="language-javascript vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">router.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">afterEach</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">((</span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">to</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">from</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  console.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">log</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">`用户从 $&#123;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">from</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">.</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">fullPath</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">&#125; 跳转到 $&#123;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">to</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">.</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">fullPath</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">&#125;`</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;)</span></span></code></pre></div><ul style="box-sizing: border-box; list-style: disc; margin: 16px 0px; padding: 0px 0px 0px 1.25rem;"><li style="box-sizing: border-box; overflow-wrap: break-word;">防止访问不存在的页面</li></ul><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">通过守卫检查路由是否存在，避免导航到无效页面。</p><div class="language-javascript vp-adaptive-theme" style="box-sizing: border-box; position: relative; margin: 8px 0px; background-color: rgb(246, 246, 247); overflow-x: auto; transition: background-color 0.5s; border-radius: 8px;"><button title="Copy Code" class="copy" style="box-sizing: border-box; touch-action: manipulation; border-width: 0.8px; border-style: solid; border-color: rgb(226, 226, 227); border-image: none 100% / 1 / 0 stretch; padding: 0px; line-height: inherit; color: inherit; font-family: inherit; background-color: rgb(246, 246, 247); background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' stroke='rgba(128,128,128,1)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' viewBox='0 0 24 24'%3E%3Crect width='8' height='4' x='8' y='2' rx='1' ry='1'/%3E%3Cpath d='M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2'/%3E%3C/svg%3E&quot;); cursor: pointer; direction: ltr; position: absolute; top: 12px; right: 12px; z-index: 3; border-radius: 4px; width: 40px; height: 40px; opacity: 0; background-position: 50% center; background-size: 20px; background-repeat: no-repeat; transition: border-color 0.25s, background-color 0.25s, opacity 0.25s;"></button><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; position: relative; z-index: 1; margin: 0px; padding: 20px 0px; background: transparent; overflow-x: auto;"><code style="box-sizing: border-box; font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-size: 12.25px; background-color: transparent; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; tab-size: 4; hyphens: none; display: block; padding: 0px 24px; width: fit-content; min-width: 100%; line-height: 1.7; color: rgba(60, 60, 67, 0.78); transition: color 0.5s; font-weight: 400;"><span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">router.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">beforeEach</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">((</span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">to</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">from</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">, </span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">next</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">  const</span><span style="box-sizing: border-box; color: rgb(0, 92, 197); --shiki-light: #005CC5; --shiki-dark: #79B8FF;"> routeExists</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;"> =</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> router.</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">getRoutes</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">().</span><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">some</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">((</span><span style="box-sizing: border-box; color: rgb(227, 98, 9); --shiki-light: #E36209; --shiki-dark: #FFAB70;">route</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">=&gt;</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> route.name </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">===</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> to.name)</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">  if</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> (</span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">!</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">routeExists) &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">    next</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">(</span><span style="box-sizing: border-box; color: rgb(3, 47, 98); --shiki-light: #032F62; --shiki-dark: #9ECBFF;">'/404'</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">) </span><span style="box-sizing: border-box; color: rgb(106, 115, 125); --shiki-light: #6A737D; --shiki-dark: #6A737D;">// 跳转到 404 页面</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125; </span><span style="box-sizing: border-box; color: rgb(215, 58, 73); --shiki-light: #D73A49; --shiki-dark: #F97583;">else</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;"> &#123;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(111, 66, 193); --shiki-light: #6F42C1; --shiki-dark: #B392F0;">    next</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">()</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">  &#125;</span></span>
<span class="line" style="box-sizing: border-box; color: rgba(60, 60, 67, 0.78);"><span style="box-sizing: border-box; color: rgb(36, 41, 46); --shiki-light: #24292E; --shiki-dark: #E1E4E8;">&#125;)</span></span></code></pre></div><p style="box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;">关联文章：<a href="https://juejin.cn/post/7359084604663840820" target="_blank" rel="noreferrer" style="box-sizing: border-box; touch-action: manipulation; color: rgb(52, 81, 178); text-decoration: underline; font-weight: 500; text-underline-offset: 2px; transition: color 0.25s, opacity 0.25s;">5min带你快速回顾、学习VueRouter的使用！</a></p></details>



<p>基本了解了 <code>createApp()</code> 与 <code>app.mount()</code> 两个方法的来源和大致执行过程，这里依然以上文的流程图来进行回顾：</p>
<p><img src="https://segmentfault.com/img/remote/1460000043640783" alt="createApp 过程回顾"></p>
<p>所以在创建好应用 app 后执行 <code>mount</code> 函数，通过 <code>createVNode</code> 将我们的入口组件 <code>App.vue</code> 转换成 <code>VNode</code> 树，最后使用 <code>patch()</code> 函数将 <code>VNode</code> 树转换为真实 Dom 渲染到页面上。</p>
<p>而 Vue 3 的 diff 算法，与 Vue 2 一样，依然在 <code>patch</code> 过程中。</p>
<p>那么首先，先来看一下 VNode 的生成吧~</p>
<h2 id="createVNode-生成虚拟节点"><a href="#createVNode-生成虚拟节点" class="headerlink" title="createVNode - 生成虚拟节点"></a>createVNode - 生成虚拟节点</h2><p><code>createVNode</code>，即创建一个 <code>VNode</code> 虚拟节点对象。</p>
<p>它最多接收 5 个参数（当然在 <code>createApp</code> 的时候只有一个 <code>App.vue</code>），其中 <code>type</code> 可以是一个字符串，也可以是一个 <code>class</code> 组件或者普通组件，甚至可以是一个 <code>VNode</code> 对象。</p>
<p>所以首先会对 <code>type</code> 进行处理，在没有传入 <code>type</code> 或者指定为 <code>v-ndc</code> 时，会自动转成 <strong>注释节点</strong> 类型，然后判断是否已经是一个 <code>VNode</code> 对象；如果是的话，则返回对传入 <code>VNode</code> 的拷贝对象（除了部分属性之外，其他属性都是浅层拷贝）。</p>
<p>如果不是一个 <code>VNode</code> 的话，则进入后续循环（<code>App.vue</code> 就不是）。</p>
<p>之后的过程会先处理组件的 <code>class</code> 和 <code>style</code> 绑定格式，然后处理传入 <code>type</code> 参数对应的 <code>VNode</code> 对象类型，最后通过 <code>createBaseVNode()</code> 创建 <code>VNode</code> 返回。</p>
<p><img src="https://segmentfault.com/img/remote/1460000043640784" alt="image-20230324170019456"></p>
<p>然后，<code>mount</code> 函数内部会通过 <code>render</code> 函数进行 <code>VNode</code> 到真实 <code>dom</code> 的解析和渲染。</p>
<p>而 <code>render</code> 函数内部则是根据是否有新的 <code>VNode</code> 对象来确认是 <strong>挂载&#x2F;更新</strong> 还是 <strong>卸载 dom 节点</strong> —— 如果有新的 <code>VNode</code> 对象，则调用 <code>patch</code> 进行 <code>VNode</code> 的解析与渲染；否则调用 <code>unmount</code> 进行卸载。</p>
<h2 id="patch-函数-VNode-节点的分类处理"><a href="#patch-函数-VNode-节点的分类处理" class="headerlink" title="patch 函数 - VNode 节点的分类处理"></a>patch 函数 - VNode 节点的分类处理</h2><p>在 Vue 项目的开发过程中，我们都知道 <strong>组件与 HTML 元素都是通过标签在模板中使用的</strong>，并且除了元素与组件之外，可能还有注释节点等内容。所以在解析的时候也需要 <strong>根据不同的节点类型进行分类处理</strong>。</p>
<p>所以 <code>patch</code> 函数的主要功能就是 <strong>根据 <code>VNode</code> 对象的不同类型调用对应的处理方法，如果有绑定 <code>ref</code> 属性，则还会将绑定的 <code>ref</code> 元素（dom 节点或者组件实例）添加到当前的 Vue 实例上</strong>。</p>
<p>整个 <code>patch</code> 过程包括以下几步：</p>
<ol>
<li>判断新旧 <code>VNode</code> 对象是否完全一致，一致时直接退出</li>
<li>如果新旧 <code>VNode</code> 对象的 <strong>类型不一致</strong>，则 <strong>卸载旧节点，将旧节点置为 <code>null</code> 进行后续逻辑</strong></li>
<li>根据新节点的 <code>patchFlag</code> 配置是否需要优化</li>
<li>根据新节点的 <code>type</code> 类型，调用不同的处理方法；这里大部分方法名都是以 <code>process</code> 开头，意为加工、处理对应元素</li>
<li>如果设置了 <code>ref</code> 属性，则调用 <code>setRef</code> 处理对应绑定关系</li>
</ol>
<p>过程图如下：</p>
<p><img src="https://segmentfault.com/img/remote/1460000043640785" alt="image-20230327170534619"></p>
<h2 id="processFunctions-节点实际处理过程"><a href="#processFunctions-节点实际处理过程" class="headerlink" title="processFunctions - 节点实际处理过程"></a>processFunctions - 节点实际处理过程</h2><p>在 <code>patch</code> 过程中根据不同的 <code>VNode.type</code> 进行处理之后，分别会调用不同的函数来进行虚拟节点的实际处理与 dom 更新。其中有类似文本与注释这样的简单节点，也有具有多个子元素或者动态组件等这样的复杂标签，那么从易到难，先从简单的标签说起。</p>
<h3 id="processText-与-processCommentNode"><a href="#processText-与-processCommentNode" class="headerlink" title="processText 与 processCommentNode"></a>processText 与 processCommentNode</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">processText</span> = (<span class="params">oldVnode, newVnode, container, anchor</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span>(!oldVnode) &#123;</span><br><span class="line">    <span class="title function_">hostInsert</span>(newVnode.<span class="property">el</span> = <span class="title function_">hostCreateText</span>(newVnode.<span class="property">children</span>), container, anchor)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> el = (newVnode.<span class="property">el</span> = newVnode.<span class="property">el</span>!)</span><br><span class="line">    <span class="keyword">if</span> (newVnode.<span class="property">children</span> !== oldVnode.<span class="property">children</span>) &#123;</span><br><span class="line">      <span class="title function_">hostSetText</span>(el, newVnode.<span class="property">children</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">processCommentNode</span> = (<span class="params">oldVnode, newVnode, container, anchor</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span>(!oldVnode) &#123;</span><br><span class="line">    <span class="title function_">hostInsert</span>(newVnode.<span class="property">el</span> = <span class="title function_">hostCreateComment</span>(newVnode.<span class="property">children</span>), container, anchor)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    newVnode.<span class="property">el</span> = oldVnode.<span class="property">el</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>纯文本节点很好理解，不存在旧内容时就在父级节点（<code>container</code>）中插入节点的文本内容，存在旧节点则首先比较值是否相等，不等就更新。</p>
<p>而注释节点与纯文本不同的是，在更新的时候会直接更新 <code>el</code> 属性。</p>
<h3 id="mountStaticNode-挂载静态节点"><a href="#mountStaticNode-挂载静态节点" class="headerlink" title="mountStaticNode - 挂载静态节点"></a>mountStaticNode - 挂载静态节点</h3><p>如果是 <strong>开发环境</strong>，内容更新时还会用 <code>patchStaticNode</code> 来进行更新，但是 <strong>生产环境下只会在原节点被销毁之后才会进行挂载</strong>，也就是在 Vue 3 中提到的 <strong>静态提升</strong>，用来进行性能优化。</p>
<p>非开发环境下，只有以下逻辑：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="title class_">Static</span>:</span><br><span class="line">  <span class="keyword">if</span> (oldVnode == <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="title function_">mountStaticNode</span>(newVnode, container, anchor, isSVG)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">mountStaticNode</span> = (<span class="params">n2, container, anchor, isSVG</span>) =&gt; &#123;</span><br><span class="line">  [n2.<span class="property">el</span>, n2.<span class="property">anchor</span>] = hostInsertStaticContent!(</span><br><span class="line">    n2.<span class="property">children</span>,</span><br><span class="line">    container,</span><br><span class="line">    anchor,</span><br><span class="line">    isSVG,</span><br><span class="line">    n2.<span class="property">el</span>,</span><br><span class="line">    n2.<span class="property">anchor</span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>即直接将这个节点的内容插入到父级元素的指定位置下。</p>
<blockquote>
<p>根据官方给出的 demo，大部分 <code>template</code> 中的内容都会编译为 <code>StaticNode</code>，例如：</p>
<p><img src="https://segmentfault.com/img/remote/1460000043640786" alt="image-20230327205649220"></p>
</blockquote>
<h3 id="processFragment-多根节点处理"><a href="#processFragment-多根节点处理" class="headerlink" title="processFragment - 多根节点处理"></a>processFragment - 多根节点处理</h3><p>在 Vue 2 中，每个单文件组件下只能有一个根节点，而 Vue 3 中做了改进，我们可以在单个组件的模板中直接添加多个根节点标签（jsx 写法依然只能有一个根节点，因为需要符合 jsx 规范）。</p>
<p>在我们通过 <code>create-vite</code> 脚手架创建的项目中，<code>App.vue</code> 就是一个多根节点组件，此时就会进入到该函数逻辑中。</p>
<p><img src="https://segmentfault.com/img/remote/1460000043640787" alt="image-20230327231249151"></p>
<h4 id="1、-首次渲染"><a href="#1、-首次渲染" class="headerlink" title="1、 首次渲染"></a>1、 首次渲染</h4><p><strong>多根节点在首次渲染时逻辑较为简单</strong>，大致如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">processFragment</span> = (<span class="params">n1, n2, container, anchor, parentComponent, parentSuspense, isSVG,</span></span><br><span class="line"><span class="params">  slotScopeIds, optimized</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> fragmentStartAnchor = (n2.<span class="property">el</span> = n1 ? n1.<span class="property">el</span> : <span class="title function_">hostCreateText</span>(<span class="string">&#x27;&#x27;</span>));</span><br><span class="line">  <span class="keyword">const</span> fragmentEndAnchor = (n2.<span class="property">anchor</span> = n1 ? n1.<span class="property">anchor</span> : <span class="title function_">hostCreateText</span>(<span class="string">&#x27;&#x27;</span>));</span><br><span class="line">  <span class="keyword">let</span> &#123;</span><br><span class="line">      patchFlag,</span><br><span class="line">      dynamicChildren,</span><br><span class="line">      <span class="attr">slotScopeIds</span>: fragmentSlotScopeIds</span><br><span class="line">  &#125; = n2;</span><br><span class="line">  <span class="keyword">if</span> (fragmentSlotScopeIds) &#123;</span><br><span class="line">      slotScopeIds = slotScopeIds ?</span><br><span class="line">          slotScopeIds.<span class="title function_">concat</span>(fragmentSlotScopeIds) :</span><br><span class="line">          fragmentSlotScopeIds;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (n1 == <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="title function_">hostInsert</span>(fragmentStartAnchor, container, anchor);</span><br><span class="line">      <span class="title function_">hostInsert</span>(fragmentEndAnchor, container, anchor);</span><br><span class="line">      <span class="title function_">mountChildren</span>(n2.<span class="property">children</span>, container, fragmentEndAnchor, parentComponent, parentSuspense,</span><br><span class="line">          isSVG, slotScopeIds, optimized);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>首次渲染与更新都有共同逻辑，即 <strong>设置多根节点组件的开始与终止锚点，然后将组件的每个根节点按顺序向中间插入</strong>。</p>
<p>因为 <code>App.vue</code> 中的内容方便解析，我们新增一个多根组件 <code>FragmentOne</code>，内容如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;fragment-1&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123; name &#125;&#125; Page<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;fragment-2&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Fragment Page<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;fragment-3&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Fragment Page<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123;ref&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> name = ref&lt;string | <span class="literal">undefined</span>&gt;(<span class="string">&#x27;FragmentOne&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>当这个组件被解析到时，它会被编译成以下内容：</p>
<p><img src="https://segmentfault.com/img/remote/1460000043640788" alt="image-20230327232159199"></p>
<p>其中 <code>children</code> 数组中就是每一个根节点，然后在处理锚点时，因为是首次渲染，两个锚点会直接设置为两个空文本节点：</p>
<p><img src="https://segmentfault.com/img/remote/1460000043640789" alt="image-20230327232404236"></p>
<p>最后，会通过 <code>mountChildren</code> 方法遍历 <code>children</code> 数组，依次执行 <code>patch()</code> 处理每一个子元素。</p>
<h4 id="2、-派发更新"><a href="#2、-派发更新" class="headerlink" title="2、 派发更新"></a>2、 派发更新</h4><p>多根组件的更新相比首次挂载要 <strong>复杂很多</strong>，会根据 <strong>所有根节点的稳定性</strong> 来分开处理。</p>
<blockquote>
<p>这里的稳定性指的是每个节点是否有 <code>key</code>，顺序是否不变等，一般情况下是 <strong>非直接 <code>v-for</code> 创建的多根节点，顺序与个数都不会改变，但是每个节点内部可能会发生改变</strong>，例如 <code>create-vite</code> 创建的项目中的 <code>App.vue</code>；当是稳定节点时，<code>patchFlag</code> 的值等于 64</p>
</blockquote>
<p>大致代码如下：</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (patchFlag &gt; <span class="number">0</span> &amp;&amp; patchFlag &amp; <span class="number">64</span> &amp;&amp; dynamicChildren &amp;&amp; n1.dynamicChildren) &#123;</span><br><span class="line">    patchBlockChildren(n1.dynamicChildren, dynamicChildren, container, parentComponent, parentSuspense, isSVG, slotScopeIds)<span class="comment">;</span></span><br><span class="line">    <span class="keyword">if</span> (parentComponent &amp;&amp; parentComponent.type.__hmrId) &#123;</span><br><span class="line">        traverseStaticChildren(n1, n2)<span class="comment">;</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (n2.key != <span class="literal">null</span> || (parentComponent &amp;&amp; n2 === parentComponent.subTree)) &#123;</span><br><span class="line">        traverseStaticChildren(n1, n2, <span class="literal">true</span>)<span class="comment">;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    patchChildren(n1, n2, container, fragmentEndAnchor, parentComponent, parentSuspense, isSVG, slotScopeIds, optimized)<span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里有两种情况：</p>
<ol>
<li>是稳定节点但是具有动态节点（<code>v-for</code>循环等），通过 <code>patchBlockChildren</code> 单独处理动态节点；然后通过 <code>traverseStaticChildren</code> 进行所有子节点的 <code>el</code> 属性处理</li>
<li>不是稳定节点，则通过 <code>patchChildren</code> 来对比和更新每个子节点</li>
</ol>
<blockquote>
<p><code>patchChildren</code> 最终就会进入 Vue 3 的核心 <code>diff</code> 过程 —— <code>patchKeyedChildren</code>。</p>
</blockquote>
<p><img src="https://segmentfault.com/img/remote/1460000043640790" alt="image-20230328160349044"></p>
<h3 id="Teleport-process-Suspense-process"><a href="#Teleport-process-Suspense-process" class="headerlink" title="Teleport.process &amp; Suspense.process"></a>Teleport.process &amp; Suspense.process</h3><p>在处理 <strong>普通dom元素 <code>Element</code> 与Vue组件 <code>Component</code></strong> 的渲染之前，我们先来了解一下 Vue 3 新增的 <code>teleport</code> 传送组件和 <code>suspense</code> 异步组件吧。</p>
<p>在上面的 <code>patch</code> 函数中，<code>Teleport</code> 和 <code>Suspense</code> 在 <code>createVNode</code> 阶段，会生成 <strong>相对特殊的 <code>VNode</code> 对象</strong>，在 <code>process</code> 过程中，直接调用 <code>Vnode</code> 的 <code>process()</code> 方法。</p>
<blockquote>
<p>这两个方法都接收一个 <code>internals</code> 参数，包含 <code>renderer.ts</code> 中定义的一系列挂载与更新的方法</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">const</span> <span class="string">internals</span> <span class="string">=</span> &#123;</span><br><span class="line">    <span class="attr">p:</span> <span class="string">patch</span>,</span><br><span class="line">    <span class="attr">um:</span> <span class="string">unmount</span>,</span><br><span class="line">    <span class="attr">m:</span> <span class="string">move</span>,</span><br><span class="line">    <span class="attr">r:</span> <span class="string">remove</span>,</span><br><span class="line">    <span class="attr">mt:</span> <span class="string">mountComponent</span>,</span><br><span class="line">    <span class="attr">mc:</span> <span class="string">mountChildren</span>,</span><br><span class="line">    <span class="attr">pc:</span> <span class="string">patchChildren</span>,</span><br><span class="line">    <span class="attr">pbc:</span> <span class="string">patchBlockChildren</span>,</span><br><span class="line">    <span class="attr">n:</span> <span class="string">getNextHostNode</span>,</span><br><span class="line">    <span class="attr">o:</span> <span class="string">options</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote>
<h4 id="1、-Teleport"><a href="#1、-Teleport" class="headerlink" title="1、 Teleport"></a>1、 Teleport</h4><p>作为新增组件，它的作用是 <strong>将组件内部的内容挂载到指定元素下</strong>，所以它在挂载和更新时需要单独处理。</p>
<p>而内部的逻辑与 <code>fragment</code> 有点儿类似：</p>
<ol>
<li><strong>首次渲染</strong></li>
</ol>
<p>与 <code>fragment</code> 一样需要先设置锚点，然后根据 <code>to</code> 属性查找指定挂载元素 <code>target</code>。</p>
<p>如果 <code>target</code> 存在则将锚点插入进去，然后根据 <code>disabled</code> 配置来确认挂载对象，通过 <code>mountChildren</code> 将内容插入进目标元素中。</p>
<ol>
<li><strong>派发更新</strong></li>
</ol>
<p>在更新时，一样会读取 <code>disabled</code> 和 <code>to</code> 两个属性的配置，但是首先会与 <code>fragment</code> 一样根据内部的动态节点等进行子节点内容先进行更新。</p>
<p>然后判断 <code>disabled</code> 和 <code>to</code> 是否有变化，如果有变化则会通过 <code>moveTeleport</code> 对组件内部的内容进行移动。</p>
<p>最后通过 <code>updateCssVars</code> 更新 <code>data-v</code> 属性，处理 <code>css</code> 变量和作用域等。</p>
<p>大致过程如下：</p>
<p><img src="https://segmentfault.com/img/remote/1460000043640791" alt="image-20230329164519592"></p>
<blockquote>
<p>图中对 <code>patchChildren</code> 进行了省略，与上面 <code>processFragment</code> 的方法是一样的。</p>
</blockquote>
<h4 id="2、-Suspense"><a href="#2、-Suspense" class="headerlink" title="2、 Suspense"></a>2、 Suspense</h4><p>Vue 3 文档中提示的是这是一项 <strong>实验性功能</strong>，用来批量管理异步组件树（感觉有点儿类似于 <code>Promise.all()</code>）。</p>
<p>所以它的场景会有两种：加载中与加载结束。<code>Suspense</code> 提供两个插槽：<code>default</code> 和 <code>fallback</code>，其中 <code>fallback</code> 用来显示加载中状态，当加载结束后，会卸载 <code>pending</code> 状态的 <code>fallback</code> 内容然后加载异步组件的结果（也就是 <code>default</code> 插槽内的内容）。并且只有当 <code>default</code> 插槽内的 <strong>根节点发生改变时</strong>，才会重新触发加载中状态。</p>
<p>所以它的处理过程就是 <strong>首次解析时会重新创建 <code>default</code> 与 <code>fallback</code> 两个插槽中的节点信息，然后根据 <code>default</code> 插槽中的内容加载状态，来确定当前是否需要更新，并且会抛出相应的事件</strong>。</p>
<blockquote>
<p>这个看起来有点儿复杂，以后再详细的解析吧~</p>
</blockquote>
<h3 id="processComponent-组件处理"><a href="#processComponent-组件处理" class="headerlink" title="processComponent 组件处理"></a>processComponent 组件处理</h3><p>对 <code>Component</code> 自定义 Vue 组件的处理，同样会区分 <code>n1 == null</code> 的情况来确认是挂载还是更新；Vue 中内置的 <code>KeepAlive、Translation</code> 等组件也一样会在这里进行处理。</p>
<p>如果是 <code>KeepAlive</code> 组件中包装的组件，会设置标志位 <code>shapeFlag</code> 为 <code>ShapeFlags.COMPONENT_KEPT_ALIVE（1 &lt;&lt; 9 = 512）</code>，因为 <code>KeepAlive</code> 中的组件会被缓存，如果再次切换的话，需要恢复缓存状态，所以在组件重新 <strong>挂载</strong> 时会执行另外的逻辑 <code>parent.ctx.activate()</code>；非 <code>KeepAlive</code> 包裹的组件则直接调用 <code>mountComponent</code> 执行组件挂载。</p>
<p>而组件 <strong>更新</strong> 时，则只需要直接调用 <code>updateComponent</code> 更新组件内容。</p>
<p>在 <code>mountComponent</code> 过程中，会对该组件生成的 <code>VNode</code> 进行调整，通过 <code>createComponentInstance</code> 方法创建一个 <strong>组件实例</strong> 更新到 <code>VNode</code> 对象的 <code>component</code> 属性上，最后通过 <code>setupRenderEffect</code> 设置一个 <code>renderEffect</code>（即将组件的渲染作为副作用函数），进行组件模板中的数据依赖收集，并执行一次副作用函数实现组件的首次渲染（数据更新时就会触发这个 <code>renderEffect</code> 再次执行，更新 dom，组件实例一样有一个 <code>isMounted</code> 属性用来区分是首次渲染还是更新）。</p>
<p>例如我们上面的例子，有一个多根组件 <code>FragmentOne</code>，在引入到 <code>App.vue</code> 中进行解析的时候，会对 <code>FragmentOne</code> 创建一个 <code>VNode</code> 对象，如下图：</p>
<p><img src="https://segmentfault.com/img/remote/1460000043640792" alt="image-20230330141119632"></p>
<blockquote>
<p>这个组件因为是直接使用的，所以会直接调用 <code>mountComponent</code> 方法。</p>
</blockquote>
<p>此时会调用 <code>createComponentInstance</code> 为 <code>VNode</code> 对象创建一个组件实例：</p>
<p><img src="https://segmentfault.com/img/remote/1460000043640793" alt="image-20230330141457207"></p>
<p>然后通过 <code>setupRenderEffect</code> 创建渲染函数副作用。在这个副作用函数中，它对应的执行函数就是组件的解析与更新函数：<code>componentUpdateFn</code>。在 <strong>非SSR</strong> 项目中，会通过 <code>renderComponentRoot(instance)</code> 对组件内容进行解析，得到一个组件内容对应的标准格式子元素 <code>VNode</code> 对象—— <code>subTree</code>，最后会通过 <code>patch</code> 对 <code>subTree</code> 进行解析和更新。</p>
<blockquote>
<p>当然首次挂载的过程中还会对一些属性进行处理，保证后续进行更新时能正常对比。</p>
</blockquote>
<p>而在更新阶段，<strong>首先会通过 <code>shouldUpdateComponent</code> 比较新旧节点的信息（例如 <code>props</code> 参数、<code>slots</code> 插槽内容等是否改变）来确定是否需要对该组件进行全量更新</strong>，如果都没改变则直接继承原来的 dom 节点和 <code>VNode</code> 对象。</p>
<p><img src="https://segmentfault.com/img/remote/1460000043640794" alt="image-20230330163221643"></p>
<h3 id="processElement-HTML元素处理"><a href="#processElement-HTML元素处理" class="headerlink" title="processElement HTML元素处理"></a>processElement HTML元素处理</h3><p>在解析模板生成 <code>VNode</code> 的过程中，没有指定节点类型是默认都会设置 <code>shapeFlag</code> 为 <code>ShapeFlags.ELEMENT</code> （512），也就是原生的 HTML 节点类型；大部分时候，我们所说的 diff 算法核心部分也发生在这个过程中。</p>
<p>与 <code>processComponent</code> 类似，<code>Element</code> 元素的处理主要也只区分 <code>oldVnode</code> （也就是方法中的 <code>n1</code>）是否为 <code>null</code>，如果是，则代表是首次渲染；如果不是，则代表是对这个节点进行更新。</p>
<p>根据这两种情况，源码中分别定义了两个方法：<code>mountElement</code> 挂载节点、<code>patchElement</code> 更新节点。</p>
<p><code>mountElement</code> 的过程比较复杂，包含了根节点（这个元素节点）创建、内容（文本还是包含子节点）处理、样式和类名绑定、自定义指令、生命周期监听等。</p>
<p>而 <code>patchElement</code> 的过程也同样复杂，除了与 <code>mount</code> 阶段一样需要处理样式类名绑定、自定义指令等内容之外，还要比较新旧节点内容进行 <code>patch</code> 相关更新函数的处理。</p>
<p><img src="https://segmentfault.com/img/remote/1460000043640795" alt="image-20230330180756383"></p>
<h2 id="patchChildren-两种子节点-Diff-方式"><a href="#patchChildren-两种子节点-Diff-方式" class="headerlink" title="patchChildren - 两种子节点 Diff 方式"></a>patchChildren - 两种子节点 Diff 方式</h2><p>在上面的不同类型的 <code>VNode</code> 节点的处理过程中，自定义组件 <code>Component</code>、传送组件 <code>Teleport</code>、多根节点 <code>Fragment</code> 和 原始 HTML 节点 <code>Element</code> 在 <code>patch</code> 更新过程中，<strong>在处理子节点时</strong> 都有可能会调用 <code>patchChildren</code> 来处理子节点的更新。</p>
<blockquote>
<p>子节点更新的处理方式有两种：<code>patchBlockChildren</code> 和 <code>patchChildren</code>，其中 <code>patchBlockChildren</code> 一般是在 <strong>动态节点 <code>dynamicChildren</code></strong> 确定时调用，内部会直接 <strong>按照新的节点的动态子节点 <code>dynamicChildren</code> 数组的长度，遍历子节点数组并通过 <code>patch</code> 方法对比旧的子节点数组同位置元素</strong>。</p>
<p>而 <code>patchChildren</code> 则是在节点不存在 <code>dynamicChildren</code> 时对所有子节点数组进行全量的对比更新。</p>
<p><em>关于 <code>block</code> 和 <code>PatchFlags</code> 的相关内容，也可以查看 《Vue.js 设计与实现》一书的第十七章第一节：编译优化 - 动态节点收集与补丁标志</em>。</p>
</blockquote>
<p>在 <code>patchChildren</code> 过程中，会判断节点的 <code>patchFlag</code> 标志位，来确定 <strong>子节点数组是否配置了 <code>key</code> 属性</strong>。如果 <strong>存在 key</strong>，则会通过 <code>patchKeyedChildren</code> 对 <strong>新旧所有子节点进行 <code>diff</code> 处理，详细对比可复用节点并调用 <code>patch</code> 进行节点的最小量更新</strong>；而对于 <strong>不存在 key</strong> 的子节点数组，则调用 <code>patchUnkeyedChildren</code> 方法 <strong>按照新旧子节点数组中的最小长度，遍历最小长度下 新旧节点同位置的元素调用 <code>patch</code> 方法进行对比，遍历结束后在处理剩余节点元素（新的挂载旧的移除）</strong>。</p>
<h3 id="1、patchUnkeyedChildren-无-key-子节点处理"><a href="#1、patchUnkeyedChildren-无-key-子节点处理" class="headerlink" title="1、patchUnkeyedChildren - 无 key 子节点处理"></a>1、patchUnkeyedChildren - 无 key 子节点处理</h3><p>上面说了 <code>patchUnkeyedChildren</code> 会按照新旧子节点数组的 <strong>最小长度</strong> 进行遍历，所以首先会获取他们的长度进行对比得到较小的那个 <code>length</code>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">c1 = c1 || <span class="variable constant_">EMPTY_ARR</span></span><br><span class="line">c2 = c2 || <span class="variable constant_">EMPTY_ARR</span></span><br><span class="line"><span class="keyword">const</span> oldLength = c1.<span class="property">length</span></span><br><span class="line"><span class="keyword">const</span> newLength = c2.<span class="property">length</span></span><br><span class="line"><span class="keyword">const</span> commonLength = <span class="title class_">Math</span>.<span class="title function_">min</span>(oldLength, newLength)</span><br></pre></td></tr></table></figure>

<p>然后通过这个最小长度 <code>commonLength</code> 来进行遍历，处理 <strong>新旧数组的同位置的子节点</strong>：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">let</span> i</span></span><br><span class="line"><span class="function"><span class="title">for</span> (<span class="params">i = <span class="number">0</span>; i &lt; commonLength; i++</span>)</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> nextChild = (c2[i] = optimized</span><br><span class="line">    ? cloneIfMounted(c2[i] <span class="keyword">as</span> VNode)</span><br><span class="line">    : normalizeVNode(c2[i]))</span><br><span class="line">  patch(c1[i], nextChild, container, ... )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后在处理剩余元素，移除旧的添加新的：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (oldLength &gt; newLength) &#123;</span><br><span class="line">  <span class="comment">// remove old</span></span><br><span class="line">  <span class="title function_">unmountChildren</span>(c1, ... , commonLength)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="comment">// mount new</span></span><br><span class="line">  <span class="title function_">mountChildren</span>(c2, ..., commonLength)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">unmountChildren</span> = (<span class="params">children, ... , start = <span class="number">0</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = start; i &lt; children.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="title function_">unmount</span>(children[i], ...)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">mountChildren</span> = (<span class="params">children, container, ... , start = <span class="number">0</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = start; i &lt; children.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">const</span> child = (children[i] = optimized</span><br><span class="line">      ? <span class="title function_">cloneIfMounted</span>(children[i] <span class="keyword">as</span> <span class="title class_">VNode</span>)</span><br><span class="line">      : <span class="title function_">normalizeVNode</span>(children[i]))</span><br><span class="line">    <span class="title function_">patch</span>(<span class="literal">null</span>,child,container, ...)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>因为不存在 <code>key</code>，所以深入对比新旧节点的变化更加消耗性能，不如直接 <strong>当做位置没有发生改变，直接更新同位置节点</strong>。</p>
</blockquote>
<h3 id="2、patchKeyedChildren-核心-Diff-过程"><a href="#2、patchKeyedChildren-核心-Diff-过程" class="headerlink" title="2、patchKeyedChildren - 核心 Diff 过程"></a>2、patchKeyedChildren - 核心 Diff 过程</h3><p>当节点 <strong>具有 <code>key</code> 属性时</strong>，节点更新时就会进行我们常说的 diff 过程，核心也就是为了 <strong>dom 节点复用</strong>，把相同 <code>key</code> 属性的节点视为同一节点，根据属性的实际变化来更新具体的 dom 属性，以达到最少操作的目的。</p>
<p>在 Vue 2 中，对于这种情况采用的是 <strong>双端对比算法</strong> 来完成 <strong>新旧节点数组的全量对比</strong>，<strong>但是这种方法不是最快的</strong>。</p>
<p>Vue 3 在此基础上，借鉴了 <code>ivi</code> 和 <code>inferno</code> 两个框架所用到的 <strong>快速 Diff 算法</strong>，并在此基础上进行了扩展，得到了如今源码中使用的 <code>diff</code> 算法。</p>
<p>因为源码比较长，我将过程简化后以两个字符串数组进行比较：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> list = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#process&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">isSameVNodeType</span> = (<span class="params">n1, n2</span>) =&gt; (n1 === n2);</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">unmount</span> = (<span class="params">node</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;unmount&#x27;</span>, node);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">patch</span> = (<span class="params">n1, n2</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;patch&#x27;</span>, n1, n2);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">move</span> = (<span class="params">node, anchor</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;move&#x27;</span>, node, <span class="string">&#x27;anchor&#x27;</span>, anchor);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// https://en.wikipedia.org/wiki/Longest_increasing_subsequence</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getSequence</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> p = arr.<span class="title function_">slice</span>();</span><br><span class="line">  <span class="keyword">const</span> result = [<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">let</span> i;<span class="keyword">let</span> j;<span class="keyword">let</span> u;<span class="keyword">let</span> v;<span class="keyword">let</span> c;</span><br><span class="line">  <span class="keyword">const</span> len = arr.<span class="property">length</span>;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; len;i++) &#123;</span><br><span class="line">    <span class="keyword">const</span> arrI = arr[i];</span><br><span class="line">    <span class="keyword">if</span> (arrI !== <span class="number">0</span>) &#123;</span><br><span class="line">      j = result[result.<span class="property">length</span> - <span class="number">1</span>];</span><br><span class="line">      <span class="keyword">if</span> (arr[j] &lt; arrI) &#123;</span><br><span class="line">        p[i] = j;</span><br><span class="line">        result.<span class="title function_">push</span>(i);</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      u = <span class="number">0</span>;</span><br><span class="line">      v = result.<span class="property">length</span> - <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">while</span> (u &lt; v) &#123;</span><br><span class="line">        c = (u + v) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (arr[result[c]] &lt; arrI) &#123;</span><br><span class="line">          u = c + <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          v = c;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (arrI &lt; arr[result[u]]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (u &gt; <span class="number">0</span>) &#123;</span><br><span class="line">          p[i] = result[u - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        result[u] = i;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  u = result.<span class="property">length</span>;</span><br><span class="line">  v = result[u - <span class="number">1</span>];</span><br><span class="line">  <span class="keyword">while</span> (u-- &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    result[u] = v;</span><br><span class="line">    v = p[v];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 正式开始</span></span><br><span class="line"><span class="comment">// 定义新旧节点数据</span></span><br><span class="line"><span class="keyword">const</span> c1 = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>];</span><br><span class="line"><span class="keyword">const</span> c2 = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置初始数据</span></span><br><span class="line"><span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">const</span> l2 = c2.<span class="property">length</span>;</span><br><span class="line"><span class="keyword">let</span> e1 = c1.<span class="property">length</span> - <span class="number">1</span>; <span class="comment">// prev ending index</span></span><br><span class="line"><span class="keyword">let</span> e2 = l2 - <span class="number">1</span>; <span class="comment">// next ending index</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. sync from start</span></span><br><span class="line"><span class="keyword">while</span> (i &lt;= e1 &amp;&amp; i &lt;= e2) &#123;</span><br><span class="line">  <span class="keyword">const</span> n1 = c1[i];</span><br><span class="line">  <span class="keyword">const</span> n2 = c2[i];</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">isSameVNodeType</span>(n1, n2)) &#123;</span><br><span class="line">    <span class="title function_">patch</span>(n1, n2);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  i++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. sync from end</span></span><br><span class="line"><span class="keyword">while</span> (i &lt;= e1 &amp;&amp; i &lt;= e2) &#123;</span><br><span class="line">  <span class="keyword">const</span> n1 = c1[e1];</span><br><span class="line">  <span class="keyword">const</span> n2 = c2[e2];</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">isSameVNodeType</span>(n1, n2)) &#123;</span><br><span class="line">    <span class="title function_">patch</span>(n1, n2);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  e1--;</span><br><span class="line">  e2--;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. common sequence + mount</span></span><br><span class="line"><span class="keyword">if</span> (i &gt; e1) &#123;</span><br><span class="line">  <span class="keyword">if</span> (i &lt;= e2) &#123;</span><br><span class="line">    <span class="keyword">const</span> nextPos = e2 + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &lt;= e2) &#123;</span><br><span class="line">      <span class="title function_">patch</span>(<span class="literal">null</span>, c2[i]);</span><br><span class="line">      i++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. common sequence + unmount</span></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (i &gt; e2) &#123;</span><br><span class="line">  <span class="keyword">while</span> (i &lt;= e1) &#123;</span><br><span class="line">    <span class="title function_">unmount</span>(c1[i]);</span><br><span class="line">    i++;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5. unknown sequence</span></span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> s1 = i; <span class="comment">// prev starting index</span></span><br><span class="line">  <span class="keyword">const</span> s2 = i; <span class="comment">// next starting index</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 5.1 build key:index map for newChildren</span></span><br><span class="line">  <span class="keyword">const</span> keyToNewIndexMap = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line">  <span class="keyword">for</span> (i = s2;i &lt;= e2;i++) &#123;</span><br><span class="line">    <span class="keyword">const</span> nextChild = c2[i];</span><br><span class="line">    <span class="keyword">if</span> (nextChild != <span class="literal">null</span>) &#123;</span><br><span class="line">      keyToNewIndexMap.<span class="title function_">set</span>(nextChild, i);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 5.2 loop through old children left to be patched and try to patch</span></span><br><span class="line">  <span class="comment">// matching nodes &amp; remove nodes that are no longer present</span></span><br><span class="line">  <span class="keyword">let</span> j;</span><br><span class="line">  <span class="keyword">let</span> patched = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">const</span> toBePatched = e2 - s2 + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">let</span> moved = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">let</span> maxNewIndexSoFar = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">const</span> newIndexToOldIndexMap = <span class="keyword">new</span> <span class="title class_">Array</span>(toBePatched);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; toBePatched;i++) &#123;</span><br><span class="line">    newIndexToOldIndexMap[i] = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (i = s1;i &lt;= e1;i++) &#123;</span><br><span class="line">    <span class="keyword">const</span> prevChild = c1[i];</span><br><span class="line">    <span class="keyword">if</span> (patched &gt;= toBePatched) &#123;</span><br><span class="line">      <span class="comment">// all new children have been patched so this can only be a removal</span></span><br><span class="line">      <span class="title function_">unmount</span>(prevChild);</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> newIndex;</span><br><span class="line">    <span class="keyword">if</span> (prevChild != <span class="literal">null</span>) &#123;</span><br><span class="line">      newIndex = keyToNewIndexMap.<span class="title function_">get</span>(prevChild);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// key-less node, try to locate a key-less node of the same type</span></span><br><span class="line">      <span class="keyword">for</span> (j = s2;j &lt;= e2;j++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">          newIndexToOldIndexMap[j - s2] === <span class="number">0</span> &amp;&amp;</span><br><span class="line">            <span class="title function_">isSameVNodeType</span>(prevChild, c2[j])</span><br><span class="line">        ) &#123;</span><br><span class="line">          newIndex = j;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (newIndex === <span class="literal">undefined</span>) &#123;</span><br><span class="line">      <span class="title function_">unmount</span>(prevChild);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      newIndexToOldIndexMap[newIndex - s2] = i + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span> (newIndex &gt;= maxNewIndexSoFar) &#123;</span><br><span class="line">        maxNewIndexSoFar = newIndex;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        moved = <span class="literal">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title function_">patch</span>(prevChild, c2[newIndex]);</span><br><span class="line">      patched++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 5.3 move and mount</span></span><br><span class="line">  <span class="keyword">const</span> increasingNewIndexSequence = moved ? <span class="title function_">getSequence</span>(newIndexToOldIndexMap) : [];</span><br><span class="line">  j = increasingNewIndexSequence.<span class="property">length</span> - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (i = toBePatched - <span class="number">1</span>;i &gt;= <span class="number">0</span>;i--) &#123;</span><br><span class="line">    <span class="keyword">const</span> nextIndex = s2 + i;</span><br><span class="line">    <span class="keyword">const</span> nextChild = c2[nextIndex];</span><br><span class="line">    <span class="keyword">const</span> anchor = nextIndex + <span class="number">1</span> &lt; l2 ? c2[nextIndex + <span class="number">1</span>] : <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (newIndexToOldIndexMap[i] === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="comment">// mount new</span></span><br><span class="line">      <span class="title function_">patch</span>(<span class="literal">null</span>, nextChild);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (moved) &#123;</span><br><span class="line">      <span class="keyword">if</span> (j &lt; <span class="number">0</span> || i !== increasingNewIndexSequence[j]) &#123;</span><br><span class="line">        <span class="comment">// move(nextChild, container, anchor, MoveType.REORDER)</span></span><br><span class="line">        <span class="title function_">move</span>(nextChild, anchor);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        j--;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这段代码可以直接在控制台运行，也可以直接查看文章结尾的代码片段（会更新细节问题）。</p>
</blockquote>
<p>假设我们有这样的节点变化：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">旧节点：<span class="selector-attr">[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>]</span></span><br><span class="line"></span><br><span class="line">新节点：<span class="selector-attr">[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>]</span></span><br></pre></td></tr></table></figure>

<p>经过的 diff 过程如下：</p>
<p><img src="https://segmentfault.com/img/remote/1460000043640796" alt="image-20230331161318471"></p>
<p>其中可以分为以下几个大的步骤：</p>
<ol>
<li><strong>从头开始、同位置比较</strong>，直到 <strong>遇到 <code>key</code> 不一样的节点</strong>（也就是第三位 <code>c</code> 和 <code>e</code>，此时 <code>i</code> &#x3D; 2）</li>
<li><strong>从尾开始、倒序同位置比较</strong>，直到 <strong>遇到 <code>key</code> 不一样的节点或者第一步的停止位 <code>i</code></strong>（也就是遇到倒数第三位 <code>e</code> 和 <code>h</code>，此时 <code>e1</code> 和 <code>e2</code> 都等于 4）</li>
<li>经过前两步之后，剩下的节点虽然有相同节点，但是顺序已经改变，所以需要重新处理。这里与 Vue 2 中的 <strong>双端均不相同</strong> 的情况有些类似的过程，都会将一个节点数组转为 <code>map</code> 形式然后遍历另一个数组进行匹配和更新。但是这里也一样有一些不同，我们在后面分析时进行详细说明。</li>
</ol>
<blockquote>
<p>这里可以发现 <strong>实际执行过程并没有完全匹配代码中的 5 种情况</strong>，这是因为 <strong>三和四这两种情况都是发生在前两步结束后已经有一个节点数组已经全部遍历完毕</strong>。</p>
</blockquote>
<h3 id="快速-Diff-算法"><a href="#快速-Diff-算法" class="headerlink" title="快速 Diff 算法"></a>快速 Diff 算法</h3><p>在分析 diff 算法之前，先了解一下这个 <strong>快速 diff 算法</strong> 的“快速”主要是体现在哪个方面。</p>
<p>根据《Vue.js 设计与实现》的说明：<strong>快速 Diff 算法包含预处理步骤，这其实是借鉴了纯文本 Diff 算法的思路。在纯文本 Diff 算法中，存在对两段文本进行预处理的过程</strong>。</p>
<p>在这个过程中，会 <strong>分别查找头部完全一致的内容与尾部完全一致的内容，将其排除后再比较剩余内容</strong>。</p>
<p>例如：</p>
<p><img src="https://segmentfault.com/img/remote/1460000043640797" alt="image-20230331165142312"></p>
<p>两段文本中只需要更新的仅仅只有中间部分，需要将 <code>vue</code> 改为 <code>react</code>。</p>
<p><em>接下来，我们以这个例子进行整个 diff 过程的解析~</em></p>
<h3 id="1、-从头查找最长相同-key-节点"><a href="#1、-从头查找最长相同-key-节点" class="headerlink" title="1、 从头查找最长相同 key 节点"></a>1、 从头查找最长相同 key 节点</h3><p>我们假设现在有这样的内容：</p>
<p><img src="https://segmentfault.com/img/remote/1460000043640798" alt="image-20230331170334019"></p>
<p>它在第一步结束后，更新到了第二个节点；<code>i</code> 会停留在第一个不同的节点位置。</p>
<p><img src="https://segmentfault.com/img/remote/1460000043640799" alt="image-20230331172031058"></p>
<p>此时剩余内容为：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">旧节点： <span class="selector-attr">[<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>]</span>;</span><br><span class="line">新节点： <span class="selector-attr">[<span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>]</span>;</span><br></pre></td></tr></table></figure>

<h3 id="2、-从尾部倒序查找最长相同-key-节点"><a href="#2、-从尾部倒序查找最长相同-key-节点" class="headerlink" title="2、 从尾部倒序查找最长相同 key 节点"></a>2、 从尾部倒序查找最长相同 key 节点</h3><p>在第二步结束之后，会进行这样的更新：</p>
<p><img src="https://segmentfault.com/img/remote/1460000043640800" alt="image-20230331172957109"></p>
<p>这一步不会处理 <code>i</code> 的位置，而是从两个数组的最末尾节点依次按顺序对比同位置节点：</p>
<p><img src="https://segmentfault.com/img/remote/1460000043640801" alt="image-20230331173102486"></p>
<h3 id="3、-旧节点数组被遍历结束"><a href="#3、-旧节点数组被遍历结束" class="headerlink" title="3、 旧节点数组被遍历结束"></a>3、 旧节点数组被遍历结束</h3><p>因为最初的例子中没有触发代码中的第三、四步，所以这里的例子进行一下调整：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">旧节点： <span class="selector-attr">[<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>]</span>;</span><br><span class="line">新节点： <span class="selector-attr">[<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;j&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>]</span>;</span><br></pre></td></tr></table></figure>

<p>此时过程如下：</p>
<p><img src="https://segmentfault.com/img/remote/1460000043640802" alt="image-20230331173641313"></p>
<p><img src="https://segmentfault.com/img/remote/1460000043640803" alt="image-20230331175221206"></p>
<p><strong>也就是对新节点数组剩余元素进行依次遍历和挂载</strong></p>
<h3 id="4、-新节点数组被遍历结束"><a href="#4、-新节点数组被遍历结束" class="headerlink" title="4、 新节点数组被遍历结束"></a>4、 新节点数组被遍历结束</h3><blockquote>
<p>第 三、四、五 三个步骤属于 <strong>互斥情况</strong>，所以源码中采用的是 <code>if</code> 判断</p>
</blockquote>
<p>因为这三个情况不一样，所以这一步需要对前面的例子再进行修改，假设新示例如下：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">旧节点： <span class="selector-attr">[<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;j&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>]</span>;</span><br><span class="line">新节点： <span class="selector-attr">[<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>]</span>;</span><br></pre></td></tr></table></figure>

<p>此时的步骤就刚好与第三步相反：</p>
<p><img src="https://segmentfault.com/img/remote/1460000043640804" alt="image-20230331180836302"></p>
<p><img src="https://segmentfault.com/img/remote/1460000043640805" alt="image-20230331180324169"></p>
<p><strong>也就是对旧节点数组剩余元素进行依次遍历和卸载</strong></p>
<h3 id="5、-剩余节点对比（移动、更新、卸载）"><a href="#5、-剩余节点对比（移动、更新、卸载）" class="headerlink" title="5、 剩余节点对比（移动、更新、卸载）"></a>5、 剩余节点对比（移动、更新、卸载）</h3><blockquote>
<p>只有在这一步才用到了 <strong>最长递增子序列</strong> 算法。</p>
</blockquote>
<p>在这一步开始之前，我们先了解一下什么是 <strong>最长递增子序列算法</strong>。</p>
<h4 id="5-0-最长递增子序列"><a href="#5-0-最长递增子序列" class="headerlink" title="5.0 最长递增子序列"></a>5.0 最长递增子序列</h4><blockquote>
<p>“<strong>在一个给定的数值序列中，找到一个子序列，使得这个子序列元素的数值依次递增，并且这个子序列的长度尽可能地大。最长递增子序列中的元素在原序列中不一定是连续的</strong>“。</p>
<p>—— 维基百科</p>
</blockquote>
<p>对于以下的原始序列</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0, 8, 4, 12, 2, 10, 6, 14, 1, 9, 5, 13, 3, 11, 7, 15</span><br></pre></td></tr></table></figure>

<p>最长递增子序列为：</p>
<p>值得注意的是，生成的递增子序列数组中的元素，在原数组中对应的元素下标不一定是连续的。</p>
<p><img src="/../img/3642183937-e1f201ff7c91ad91_fix732.png" alt="image-20230403093717347"></p>
<p><strong>在 Vue 3 中，这个算法被提取成了一个工具方法 <code>getSequence</code>，位于 <code>renderer.ts</code> 文件的最底部</strong>。并且，Vue 3 中最这个方法进行了改造，最终生成的子序列 <strong>是以可生成 <code>最长</code> 子串数组的可用元素的 <code>最大索引</code></strong>。</p>
<p>如果使用 Vue 3 中的 <code>getSequence</code> 方法来处理上面的这个原始序列，会得到这样的结果：</p>
<p>区别如下：</p>
<p><img src="/../img/3531219669-039bff1cb42e63a0_fix732.png" alt="image-20230403101532141"></p>
<p><code>getSequence</code> 方法的大致过程如下：</p>
<ol>
<li>复制一份 <code>arr</code> 数组，用于记录每个元素在递增子序列中的前驱元素。</li>
<li>初始化 <code>result</code> 数组为 <code>[0]</code>，用于记录递增子序列的索引。</li>
<li>遍历 <code>arr</code> 数组，如果当前元素不为 0，则在递增子序列 <code>result</code> 中查找比当前元素小的最大元素的索引 <code>j</code>。</li>
<li>如果 <code>arr[j] &lt; arr[i]</code>，则将 <code>p[i]</code> 赋值为 <code>j</code>，并将 <code>i</code> 添加到递增子序列 <code>result</code> 中。</li>
<li>否则，使用二分查找在递增子序列 <code>result</code> 中查找比当前元素小的最大元素的索引 <code>u</code>。</li>
<li>如果 <code>arr[i]</code> 小于 <code>result[u]</code>，则将 <code>p[i]</code> 赋值为 <code>result[u-1]</code>。</li>
<li>将 <code>i</code> 添加到递增子序列 <code>result</code> 中。</li>
<li>通过 <code>p</code> 数组回溯递增子序列，生成最终的递增新索引序列。</li>
</ol>
<h4 id="5-1-新节点剩余元素构建-Map"><a href="#5-1-新节点剩余元素构建-Map" class="headerlink" title="5.1 新节点剩余元素构建 Map"></a>5.1 新节点剩余元素构建 Map</h4><p>这一步就很简单了，直接循环 <code>newChildren</code> 的 <code>i</code> 到 <code>e2</code> 之间的剩余元素，组成一个 <code>key =&gt; index</code> 的 <code>Map</code>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> s1 = (s2 = i);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> keyToNewIndexMap = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line"><span class="keyword">for</span> (i = s2;i &lt;= e2;i++) &#123;</span><br><span class="line">  <span class="keyword">const</span> nextChild = c2[i];</span><br><span class="line">  <span class="keyword">if</span> (nextChild != <span class="literal">null</span>) &#123;</span><br><span class="line">    keyToNewIndexMap.<span class="title function_">set</span>(nextChild, i);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5-2-与旧节点的对比复用"><a href="#5-2-与旧节点的对比复用" class="headerlink" title="5.2 与旧节点的对比复用"></a>5.2 与旧节点的对比复用</h4><p>在 <code>newChildren</code> 的对应关系 <code>keyToNewIndexMap</code> 创建好之后，就会遍历 <code>oldChildren</code> 对比 <code>key</code> 相同的 <code>VNode</code> 实例进行复用和更新。</p>
<p>而对于比较结束后依旧剩余的旧节点则直接进行 <code>unmount</code> 卸载（因为剩余的旧节点 <code>key</code> 都不能复用，所以直接视为废弃节点）。</p>
<p>简化代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> j;</span><br><span class="line"><span class="keyword">let</span> patched = <span class="number">0</span>; <span class="comment">// 已更新节点数</span></span><br><span class="line"><span class="keyword">const</span> toBePatched = e2 - s2 + <span class="number">1</span>; <span class="comment">// newChildren 剩余节点数（需要更新）</span></span><br><span class="line"><span class="keyword">let</span> moved = <span class="literal">false</span>; <span class="comment">// 节点位置是否移动标识</span></span><br><span class="line"><span class="keyword">let</span> maxNewIndexSoFar = <span class="number">0</span>; <span class="comment">// 当前元素在新节点数组最大索引</span></span><br><span class="line"><span class="keyword">const</span> newIndexToOldIndexMap = <span class="keyword">new</span> <span class="title class_">Array</span>(toBePatched); <span class="comment">// 新旧节点索引对应关系</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; toBePatched;i++) &#123;</span><br><span class="line">  newIndexToOldIndexMap[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遍历旧节点数组</span></span><br><span class="line"><span class="keyword">for</span> (i = s1;i &lt;= e1;i++) &#123;</span><br><span class="line">  <span class="keyword">const</span> prevChild = c1[i]; <span class="comment">// 当前旧节点元素</span></span><br><span class="line">  <span class="keyword">if</span> (patched &gt;= toBePatched) &#123;</span><br><span class="line">    <span class="comment">// 如果以更新节点数大于等于需要更新节点数，</span></span><br><span class="line">    <span class="comment">// 说明新节点以全部更新，剩余旧节点直接移除，并跳出当次循环</span></span><br><span class="line">    <span class="title function_">unmount</span>(prevChild);</span><br><span class="line">    <span class="keyword">continue</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 判断当前节点是否有key，存在则在 map 中查找，</span></span><br><span class="line">  <span class="comment">// 不存在则遍历新节点剩余数组的相同节点并更新索引</span></span><br><span class="line">  <span class="keyword">let</span> newIndex;</span><br><span class="line">  <span class="comment">// 这里是判断 prevChild.key != null</span></span><br><span class="line">  <span class="keyword">if</span> (prevChild != <span class="literal">null</span>) &#123;</span><br><span class="line">    newIndex = keyToNewIndexMap.<span class="title function_">get</span>(prevChild);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// key-less node, try to locate a key-less node of the same type</span></span><br><span class="line">    <span class="keyword">for</span> (j = s2;j &lt;= e2;j++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (</span><br><span class="line">        newIndexToOldIndexMap[j - s2] === <span class="number">0</span> &amp;&amp;</span><br><span class="line">          <span class="title function_">isSameVNodeType</span>(prevChild, c2[j])</span><br><span class="line">      ) &#123;</span><br><span class="line">        newIndex = j;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (newIndex === <span class="literal">undefined</span>) &#123;</span><br><span class="line">    <span class="comment">// 依然没有找到同key或者同 VNodeType的新节点，则卸载旧节点</span></span><br><span class="line">    <span class="title function_">unmount</span>(prevChild);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 找到了对应新节点，对比索引位置设置 moved 标识，执行 patch 更新</span></span><br><span class="line">    newIndexToOldIndexMap[newIndex - s2] = i + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (newIndex &gt;= maxNewIndexSoFar) &#123;</span><br><span class="line">      <span class="comment">// 如果新节点的索引大于等于 maxNewIndexSoFar，</span></span><br><span class="line">      <span class="comment">// 则将 maxNewIndexSoFar 更新为新节点的索引</span></span><br><span class="line">      maxNewIndexSoFar = newIndex;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 说明向前移动了</span></span><br><span class="line">      moved = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">patch</span>(prevChild, c2[newIndex]);</span><br><span class="line">    patched++; <span class="comment">// 已更新 +1</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>为了能更加体现整个过程中变化，我们将上面的例子进行一下扩充：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">旧节点： <span class="selector-attr">[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;j&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;n&#x27;</span>]</span>;</span><br><span class="line">新节点： <span class="selector-attr">[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;j&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;n&#x27;</span>]</span>;</span><br></pre></td></tr></table></figure>

<p>其中包含了前两步的 <strong>头部相同节点，尾部相同节点</strong>，中间部分也包含了卸载、移动、更新三种情况，并且数据量已经比较大，可以看出整体过程。</p>
<p>在第一步新节点数组索引 <code>Map</code> 对象构建结束之后，我们会的得到一个 <code>size</code> 为 10 的 <code>keyToNewIndexMap</code>，并且此时的 <strong>需要更新节点数标识 <code>toBePatched</code> 为 10</strong>（因为都有 <code>key</code> 属性，所以此时 <code>toBePatched = keyToNewIndexMap.size()</code>）。</p>
<p>然后会遍历旧节点数组查找 <code>key</code> 相同的节点的下标 <code>newIndex</code>（如果找不到还会在 <code>newChildren</code> 新节点的剩余数组中查找 <strong>未被使用过 <code>newIndexToOldIndexMap[j - s2] === 0</code> 且同类型判断 <code>isSameVNodeType</code> 为 <code>true</code> 的节点</strong>，并将它的 <code>index</code> 下标作为 <code>newIndex</code>）。</p>
<p>这个过程结束后，如果 <code>newIndex</code> 依然是 <code>undefined</code>，则证明这个节点无法被复用，直接卸载；如果存在的话，则调用 <code>patch</code> 对比更新新旧节点元素。</p>
<p>大致过程如下：</p>
<p><img src="/../img/3084495202-519becdb323e7aa6_fix732.png" alt="image-20230403131816154"></p>
<p><img src="/../img/1660279722-31220b5e1e662a31_fix732.png" alt="image-20230403125139210"></p>
<blockquote>
<p>此时新节点剩余数组中仍然还有剩余元素没有被挂载，而且节点顺序不对，就需要进行最后一步：新建节点与位置移动</p>
</blockquote>
<h4 id="5-3-新建节点与位置移动"><a href="#5-3-新建节点与位置移动" class="headerlink" title="5.3 新建节点与位置移动"></a>5.3 新建节点与位置移动</h4><p>在这一步的开始，会判断 <code>5.2</code> 结束后的 <code>moved</code> 标识，判断是否需要进行移动判定；如果需要的话，会通过 <code>getSequence</code> 查找位置更新的最长递增子串的 <strong>元素下标</strong>。</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> increasingNewIndexSequence = moved ? getSequence(newIndexToOldIndexMap) : []<span class="comment">;</span></span><br><span class="line">j = increasingNewIndexSequence.length - <span class="number">1</span><span class="comment">;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>这里的 <code>newIndexToOldIndex</code> 记录了新节点剩余数组中，每个节点的在旧节点剩余数组中的位置下标，如果不存在记录则为 0。</p>
</blockquote>
<p>此时数据如下：</p>
<p><img src="/../img/3255277026-e29eed8371329096_fix732.png" alt="image-20230403132629995"></p>
<blockquote>
<p>这里的最长递增子串下标数组就是 <code>[1, 4, 9]</code>，对应的也就是 <code>newChildren[4], newChildren[6], newChildren[11]</code>，剩下的元素会根据这三个元素的位置进行插入。</p>
</blockquote>
<p>然后，对比新旧节点的索引进行移动或者新增：</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (newIndexToOldIndexMap[i] === <span class="number">0</span>) &#123;</span><br><span class="line">  patch(<span class="literal">null</span>, nextChild)<span class="comment">;</span></span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (moved) &#123;</span><br><span class="line">  <span class="keyword">if</span> (j &lt; <span class="number">0</span> || i !== increasingNewIndexSequence[j]) &#123;</span><br><span class="line">    move(nextChild, anchor)<span class="comment">;</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    j--<span class="comment">;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>整个过程大致为：</p>
<ol>
<li>获取子节点在新 <code>VNode</code> 中的位置 <code>nextIndex</code> 和子节点 <code>VNode</code> 对象 <code>nextChild</code>。</li>
<li>获取子节点的后一个兄弟节点或父节点作为锚点 <code>anchor</code>。</li>
<li>如果新旧 <code>VNode</code> 中该子节点对应的旧节点的索引为 0，则表示该子节点在旧 <code>VNode</code> 中不存在，需要新建该节点并挂载到容器中。</li>
<li>如果该子节点需要移动，则根据增序列和当前遍历的位置 i 的关系来判断是否需要移动，如果需要移动，则调用 <code>move</code> 函数来移动该节点到正确的位置。</li>
</ol>
<p><img src="/../img/1470043159-872e87c1beb7489b_fix732.png" alt="image-20230403142758157"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/07/03/Vue/" data-id="cmcygiiyt000cvgur8sab473o" data-title="Vue" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-AI" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/07/01/AI/" class="article-date">
  <time class="dt-published" datetime="2025-07-01T09:52:16.000Z" itemprop="datePublished">2025-07-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/07/01/AI/">AI</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="MCP"><a href="#MCP" class="headerlink" title="MCP"></a>MCP</h1><p><strong>Model context Protocol 模型上下文协议， 出现在2024.11.25</strong></p>
<p><strong>以一致的方式将各种数据源、工具和功能连接到 AI 模型</strong>（一个中间协议层），就像 USB-C 让不同设备能够通过相同的接口连接一样。MCP 的目标是创建一个通用标准，使 AI 应用程序的开发和集成变得更加简单和统一。</p>
<p><img src="/../img/v2-3a242914e1f4958e631dd158e043b7c3_1440w.jpg"></p>
<p><strong>Function call</strong>   函数调用返回结果作为大模型的补充</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/07/01/AI/" data-id="cmcygiiyk0001vgurgjz22c39" data-title="AI" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%A4%A7%E6%A8%A1%E5%9E%8B/" rel="tag">大模型</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-React补充" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/07/01/React%E8%A1%A5%E5%85%85/" class="article-date">
  <time class="dt-published" datetime="2025-07-01T02:54:22.000Z" itemprop="datePublished">2025-07-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/07/01/React%E8%A1%A5%E5%85%85/">React补充</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="React-类组件的this"><a href="#React-类组件的this" class="headerlink" title="React 类组件的this"></a>React 类组件的this</h1><h2 id="this丢失"><a href="#this丢失" class="headerlink" title="this丢失"></a>this丢失</h2><p>类的方法在调用时并没有明确的上下文</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyComponent</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">handleClick</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>); <span class="comment">// undefined</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick&#125;</span>&gt;</span>Click me<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="为什么this会丢失？"><a href="#为什么this会丢失？" class="headerlink" title="为什么this会丢失？"></a>为什么this会丢失？</h3><p>当类方法作为回调传递时（如事件处理函数），<strong>this会丢失绑定</strong>，变成<code>undefined</code>。</p>
<p>原因：</p>
<ul>
<li>JavaScript中的函数有自己的<code>this</code>绑定规则</li>
<li>React事件系统调用处理函数时，不会自动绑定组件实例</li>
<li>类方法默认没有绑定到实例</li>
</ul>
<h3 id="哪些地方容易出现this问题？"><a href="#哪些地方容易出现this问题？" class="headerlink" title="哪些地方容易出现this问题？"></a>哪些地方容易出现this问题？</h3><ul>
<li>事件处理函数（onClick, onChange等）</li>
<li>异步回调函数（setTimeout, Promise等）</li>
<li>将方法作为props传递给子组件</li>
</ul>
<h2 id="绑定this的常见方法"><a href="#绑定this的常见方法" class="headerlink" title="绑定this的常见方法"></a><strong>绑定<code>this</code>的常见方法</strong></h2><p><strong>1</strong>. 在构造函数中绑定</p>
<p>在组件的构造函数中使用<code>bind</code>方法绑定<code>this</code>是最常见的方式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyComponent</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">handleClick</span> = <span class="variable language_">this</span>.<span class="property">handleClick</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">handleClick</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>); <span class="comment">// 指向组件实例</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick&#125;</span>&gt;</span>Click me<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这种方式的好处是只需在构造函数中绑定一次，所有的事件处理函数都会使用相同的<code>this</code>。</p>
<p><strong>2. 使用箭头函数</strong></p>
<p>箭头函数没有自己的<code>this</code>，它会捕获其定义时所在上下文的<code>this</code>值：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyComponent</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  handleClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>); <span class="comment">// 指向组件实例</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick&#125;</span>&gt;</span>Click me<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这种方式简洁明了，但需要注意的是，箭头函数可能会引起内存泄漏，尤其是在大型应用中。</p>
<p><strong>3. 在调用时绑定</strong></p>
<p>在事件处理函数被调用时，使用箭头函数绑定<code>this</code>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyComponent</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">handleClick</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>); <span class="comment">// 指向组件实例</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.handleClick()&#125;&gt;Click me<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这种方式虽然简单，但每次渲染都会创建一个新的函数，可能会导致性能问题。</p>
<h2 id="常见的陷阱及解决方案"><a href="#常见的陷阱及解决方案" class="headerlink" title="常见的陷阱及解决方案"></a><strong>常见的陷阱及解决方案</strong></h2><p><strong>陷阱1：忘记绑定<code>this</code></strong></p>
<p>忘记绑定<code>this</code>会导致方法调用时<code>this</code>为<code>undefined</code>，从而引发错误。解决方案是在构造函数中绑定<code>this</code>，或者使用箭头函数。</p>
<p><strong>陷阱2：在回调函数中使用<code>this</code></strong></p>
<p>在回调函数中，<code>this</code>的指向可能会发生变化：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyComponent</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  handleClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>); <span class="comment">// 指向组件实例</span></span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick&#125;</span>&gt;</span>Click me<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在这种情况下，使用箭头函数可以确保<code>this</code>的正确指向。</p>
<p><strong>陷阱3：在渲染方法中使用箭头函数</strong></p>
<p>在渲染方法中使用箭头函数会导致每次渲染都创建一个新的函数，影响性能：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyComponent</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">handleClick</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.handleClick()&#125;&gt;Click me<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>解决方案是在构造函数中绑定<code>this</code>，或者使用类属性定义箭头函数。</p>
<p>在使用箭头函数时，需要注意性能问题。箭头函数可能会导致组件的渲染性能下降，尤其是在大型应用中。为了避免性能问题，建议在构造函数中绑定<code>this</code>，或者使用类属性定义箭头函数</p>
<h2 id="不需要绑定-this-的情况"><a href="#不需要绑定-this-的情况" class="headerlink" title="不需要绑定 this 的情况"></a>不需要绑定 <code>this</code> 的情况</h2><ul>
<li><strong>生命周期方法</strong>（如 <code>componentDidMount</code>）：React 自动绑定</li>
<li><strong>Render 方法</strong>：React 自动绑定</li>
<li><strong>静态方法</strong>（<code>static</code>）：不访问实例，无需绑定</li>
</ul>
<h1 id="React合成事件顺序"><a href="#React合成事件顺序" class="headerlink" title="React合成事件顺序"></a>React合成事件顺序</h1><p><img src="/../img/image-20250701134656066.png" alt="image-20250701134656066"></p>
<p><img src="/../img/image-20250701134806200.png" alt="image-20250701134806200"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/07/01/React%E8%A1%A5%E5%85%85/" data-id="cmcygiiys0008vgurghck7o1g" data-title="React补充" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8E%9F%E7%90%86/" rel="tag">原理</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-React" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/06/29/React/" class="article-date">
  <time class="dt-published" datetime="2025-06-29T13:00:45.000Z" itemprop="datePublished">2025-06-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/06/29/React/">React</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="React"><a href="#React" class="headerlink" title="React"></a>React</h1><p>由Meta公司研发，是一个用于 构建Web和原生交互界面的库</p>
<p><em>React 是一个用于<strong>构建用户界面的、 声明式、组件化</strong>的 JavaScript 库。</em></p>
<p><strong>主要特点：</strong></p>
<ul>
<li>组件（Component）</li>
<li>声明式界面编程（Declarative UI）</li>
<li>响应式 DOM 更新机制（Reactive DOM updates）</li>
</ul>
<h2 id="HelloWorld"><a href="#HelloWorld" class="headerlink" title="HelloWorld"></a>HelloWorld</h2><p>React的常规开发方式并不是通过浏览器引入外部js脚本来使用，但在入门阶段我们暂且先使用这种方式来简单体会一下React。</p>
<p>使用React开发Web项目，我们需要引入两个js脚本：<strong>react 18</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">react.development.js</span><br></pre></td></tr></table></figure>

<ul>
<li>react 是react核心库，只要使用react就必须要引入</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">react-dom.development.js</span><br></pre></td></tr></table></figure>

<ul>
<li>react-dom 是react的dom包，使用react开发web应用时必须引入</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;zh&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Hello React<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;script/react.development.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;script/react-dom.development.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;root&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> button = <span class="title class_">React</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;button&#x27;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">         <span class="attr">onClick</span>: <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">alert</span>(<span class="string">&#x27;你点了按钮！&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">            e.<span class="title function_">stopPropagation</span>();</span></span><br><span class="line"><span class="language-javascript">         &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;, <span class="string">&#x27;我是一个按钮&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> box = <span class="title class_">React</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">onClick</span>: <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">alert</span>(<span class="string">&#x27;你点了div！&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">           <span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span></span><br><span class="line"><span class="language-javascript">       &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;, <span class="string">&#x27;我是一个div&#x27;</span>, button);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#root&#x27;</span>));</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    root.<span class="title function_">render</span>(box);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>三者的区别</strong></p>
<ul>
<li>react：包含react所必须的核心代码</li>
<li>react-dom：react渲染在不同平台所需要的核心代码</li>
<li>babel：将jsx转换成React代码的工具</li>
</ul>
<h2 id="三个API"><a href="#三个API" class="headerlink" title="三个API"></a>三个API</h2><ul>
<li><pre><code>React.createElement()
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- `React.createElement(type, [props], [...children])`</span><br><span class="line"></span><br><span class="line">- 参数：</span><br><span class="line"></span><br><span class="line">  type：表示要渲染的**元素类型**。这里可以传入一个元素 Tag 名称，也可以传入一个组件（如div span 等，也可以是是函数组件和类组件）</span><br><span class="line"></span><br><span class="line">  props：**创建React元素所需要的props**。</span><br><span class="line"></span><br><span class="line">  childrens（可选参数）：要渲染元素的子元素，这里可以向后传入n个参数。可以为文本字符串，也可以为数组</span><br><span class="line"></span><br><span class="line">  用来创建React元素</span><br><span class="line"></span><br><span class="line">- React元素无法修改   返回的是虚拟dom对象</span><br><span class="line"></span><br><span class="line">```javascript</span><br><span class="line">console.log(</span><br><span class="line">  React.createElement(</span><br><span class="line">    &#x27;h1&#x27;,</span><br><span class="line">    &#123;</span><br><span class="line">      className: &#x27;title&#x27;,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#x27;Hello React&#x27;</span><br><span class="line">  )</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

![img](../img/3058803936-1121353711213220_fix732.png)
返回的这个对象就是虚拟 DOM 了。

我们来分析它返回的对象参数，首先第一个是

- **`$$typeof: REACT_ELEMENT_TYPE`**

这个是 React 元素对象的标识属性

REACT_ELEMENT_TYPE 的值是一个 Symbol 类型，代表了一个独一无二的值。如果浏览器不支持 Symbol类型，值就是一个二进制值。

&gt; 为什么是 Symbol？主要防止 XSS 攻击伪造一个假的 React 组件。**因为 JSON 中是不会存在 Symbol 类型的。**

- key：这个比如循环中会用到这个key值
- props：传入的属性值，比如 id, className, style, children 等
- ref： DOM 的引用
</code></pre>
</li>
<li><pre><code class="language-js">ReactDOM.createRoot()
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- `createRoot(container[, options])`</span><br><span class="line">- 用来创建React的根容器，容器用来放置React元素</span><br><span class="line"></span><br><span class="line">**`createRoot(domNode, options?)`** </span><br><span class="line"></span><br><span class="line">调用 `createRoot` 以在浏览器 DOM 元素中创建根节点显示内容。</span><br><span class="line"></span><br><span class="line">```js</span><br><span class="line">import &#123; createRoot &#125; from &#x27;react-dom/client&#x27;;</span><br><span class="line">const domNode = document.getElementById(&#x27;root&#x27;);</span><br><span class="line">const root = createRoot(domNode);</span><br></pre></td></tr></table></figure>

React 将会为 `domNode` 创建一个根节点，并控制其中的 DOM。在已经创建根节点之后，需要调用 [`root.render`](https://zh-hans.react.dev/reference/react-dom/client/createRoot#root-render) 来显示 React 组件：

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>);</span><br></pre></td></tr></table></figure>

对于一个完全用 React 构建的应用程序，通常会调用一个 `createRoot` 来创建它的根节点。而对于一个使用了“少量” React 来创建部分内容的应用程序，则要按具体需求来确定根节点的数量。

**参数** 

- `domNode`：一个 [DOM 元素](https://developer.mozilla.org/zh-CN/docs/Web/API/Element)。React 将为这个 DOM 元素创建一个根节点然后允许你在这个根节点上调用函数，比如 `render` 来显示渲染的 React 内容。
- **可选** `options`：用于配置这个 React 根节点的对象。
  - **可选** `onRecoverableError`：回调函数，在 React 从异常错误中恢复时自动调用。
  - **可选** `identifierPrefix`：一个 React 用来配合 [`useId`](https://zh-hans.react.dev/reference/react/useId) 生成 id 的字符串前缀。在同一个页面上使用多个根节点的场景下，这将能有效避免冲突。

**返回值** 

`createRoot` 返回一个带有两个方法的的对象，这两个方法是：[`render`](https://zh-hans.react.dev/reference/react-dom/client/createRoot#root-render) 和 [`unmount`](https://zh-hans.react.dev/reference/react-dom/client/createRoot#root-unmount)。

**注意** 

- 如果应用程序是服务端渲染的，那么不能使用 `createRoot()`。请使用 [`hydrateRoot()`](https://zh-hans.react.dev/reference/react-dom/client/hydrateRoot) 替代它。
- 在你的应用程序中，可能只调用了一次 `createRoot`。但如果你使用了框架，它可能已经自动帮你完成了这次调用。
- 当你想要渲染一段 JSX，但是它存在于 DOM 树的其他位置，并非当前组件的子组件  时（比如，一个弹窗或者提示框），使用 [`createPortal`](https://zh-hans.react.dev/reference/react-dom/createPortal) 替代 `createRoot`。
</code></pre>
</li>
<li><pre><code class="language-js">root.render()
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- `root.render(element)`</span><br><span class="line">- 当首次调用时，容器节点里的所有 DOM 元素都会被替换，后续的调用则会使用 React 的 DOM 差分算法（DOM diffing algorithm）进行高效的更新。</span><br><span class="line">- 不会修改容器节点（只会修改容器的子节点）。可以在不覆盖现有子节点的情况下，将组件插入已有的 DOM 节点中。</span><br><span class="line"></span><br><span class="line">**`root.render(reactNode)`** </span><br><span class="line"></span><br><span class="line">调用 `root.render` 以将一段 [JSX](https://zh-hans.react.dev/learn/writing-markup-with-jsx)（“React 节点”）在 React 的根节点中渲染为 DOM 节点并显示。</span><br><span class="line"></span><br></pre></td></tr></table></figure>
root.render(&lt;App /&gt;);
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">React 将会在 `根节点` 中显示 `&lt;App /&gt;` 组件，并且控制组件中的 DOM。</span><br><span class="line"></span><br><span class="line">**参数** </span><br><span class="line"></span><br><span class="line">- `reactNode`：一个你想要显示的 **React 节点**。它总是一段 JSX，就像 `&lt;App /&gt;`，但是你也总是可以传递一个 [`createElement()`](https://zh-hans.react.dev/reference/react/createElement) 构造的 React 元素、一个字符串、一个数字、`null` 或者 `undefined`。</span><br><span class="line"></span><br><span class="line">**返回值** </span><br><span class="line"></span><br><span class="line">`root.render` 返回 `undefined`。</span><br><span class="line"></span><br><span class="line">**注意** </span><br><span class="line"></span><br><span class="line">- 首次调用 `root.render` 时，React 会先清空根节点中所有已经存在的 HTML，然后才会渲染 React 组件。</span><br><span class="line">- 如果你的根节点包含了由 React 在构建期间通过服务端渲染生成的 HTML 内容，请使用 [`hydrateRoot()`](https://zh-hans.react.dev/reference/react-dom/client/hydrateRoot) 替代这个方法，这样才能把事件处理程序和现有的 HTML 绑定。</span><br><span class="line"></span><br><span class="line">如果你在一个根节点上多次调用了 `render`，React 仍然会更新 DOM，这样才能保证显示的内容是最新的。React 将会筛选出可复用的部分和需要更新的部分，对于需要更新的部分，是 React 通过与之前渲染的树进行 [“比较”](https://zh-hans.react.dev/learn/preserving-and-resetting-state) 得到的。在同一个根节点上再次调用 `render` 就和在根节点上调用 [`set` 函数](https://zh-hans.react.dev/reference/react/useState#setstate) 类似：React 会避免没必要的 DOM 更新。</span><br><span class="line"></span><br><span class="line">------</span><br><span class="line"></span><br><span class="line">**`root.unmount()`** </span><br><span class="line"></span><br><span class="line">调用 `root.unmount` 以销毁 React 根节点中的一个已经渲染的树。</span><br><span class="line"></span><br></pre></td></tr></table></figure>
root.unmount();
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  通常情况下，一个完全由 React 构建的应用程序不会调用 `root.unmount`。</span><br><span class="line"></span><br><span class="line">  此方法适用的场景是，React 根节点中的 DOM 节点（或者它的任何一个父级节点）被除了这个方法以外的代码移除了。举个例子，试想在一个 jQuery 选项卡面板中，非活跃状态的选项卡的 DOM 结构将被移除。一个标签页被移除时，它内部的所有内容（包括 React 根节点）也将会从 DOM 树移除。在这种情况下，你才需要调用 `root.unmount` 来通知 React “停止”控制已经被移除的根节点的内容。否则，被移除的根节点的内部组件就不能及时释放消息订阅等资源。</span><br><span class="line"></span><br><span class="line">  调用 `root.unmout` 将卸载根节点内的所有组件，该根节点上的 React 将被剥离，即所有事件处理程序以及组件树上的状态将被移除。</span><br><span class="line"></span><br><span class="line">  **参数** </span><br><span class="line"></span><br><span class="line">  `root.unmount` 不接收任何参数。</span><br><span class="line"></span><br><span class="line">  **返回值** </span><br><span class="line"></span><br><span class="line">  `root.unmount` 返回 `undefined`。</span><br><span class="line"></span><br><span class="line">  **注意事项** </span><br><span class="line"></span><br><span class="line">  - 调用 `root.unmout` 将卸载根节点内的所有组件，该根节点上的 React 将被剥离，即所有事件处理程序以及组件树上的状态将被移除。</span><br><span class="line">  - 一旦调用 `root.unmout`，就不能在该根节点上调用 `root.render`。在一个已经卸载的根节点上尝试调用 `root.render` 将会抛出异常错误信息“无法更新一个未挂载的根节点（Cannot update an unmouted root）”。不过，你可以在卸载一个根节点后又重新创建它</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#  React 、 Vue 异同</span><br><span class="line"></span><br><span class="line">**相似之处：**</span><br><span class="line"></span><br><span class="line">- 都将注意力集中保持在核心库，而将其他功能如路由和全局状态管理交给相关的库</span><br><span class="line">- 都有自己的构建工具，能让你得到一个根据最佳实践设置的项目模板。</span><br><span class="line">- 都使用了Virtual DOM（虚拟DOM）提高重绘性能</span><br><span class="line">- 都有props的概念，允许组件间的数据传递</span><br><span class="line">- 都鼓励组件化应用，将应用分拆成一个个功能明确的模块，提高复用性</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">**不同之处：** </span><br><span class="line"></span><br><span class="line">**1）数据流**</span><br><span class="line"></span><br><span class="line">Vue默认支持数据双向绑定，而React一直提倡单向数据流 </span><br><span class="line"></span><br><span class="line">**2）虚拟DOM**</span><br><span class="line"></span><br><span class="line">Vue2.x开始引入&quot;Virtual DOM&quot;，消除了和React在这方面的差异，但是在具体的细节还是有各自的特点。 </span><br><span class="line"></span><br><span class="line">- Vue宣称可以更快地计算出Virtual DOM的差异，这是由于它在渲染过程中，会跟踪每一个组件的依赖关系，不需要重新渲染整个组件树。</span><br><span class="line">- 对于React而言，每当应用的状态被改变时，全部子组件都会重新渲染。当然，这可以通过 PureComponent/shouldComponentUpdate这个生命周期方法来进行控制，但Vue将此视为默认的优化。</span><br><span class="line"></span><br><span class="line">**3）组件化**</span><br><span class="line"></span><br><span class="line">React与Vue最大的不同是模板的编写。</span><br><span class="line"></span><br><span class="line">- Vue鼓励写近似常规HTML的模板。写起来很接近标准 HTML元素，只是多了一些属性。</span><br><span class="line">- React推荐你所有的模板通用JavaScript的语法扩展——JSX书写。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">具体来讲：React中render函数是支持闭包特性的，所以我们import的组件在render中可以直接调用。但是在Vue中，由于模板中使用的数据都必须挂在 this 上进行一次中转，所以 import 完组件之后，还需要在 components 中再声明下。</span><br><span class="line"></span><br><span class="line">**4）监听数据变化的实现原理不同**</span><br><span class="line"></span><br><span class="line">- Vue 通过 getter/setter 以及一些函数的劫持，能精确知道数据变化，不需要特别的优化就能达到很好的性能</span><br><span class="line">- React 默认是通过比较引用的方式进行的，如果不优化（PureComponent/shouldComponentUpdate）可能导致大量不必要的vDOM的重新渲染。这是因为 Vue 使用的是可变数据，而React更强调数据的不可变。</span><br><span class="line"></span><br><span class="line">**5）高阶组件**</span><br><span class="line"></span><br><span class="line">react可以通过高阶组件（Higher Order Components-- HOC）来扩展，而vue需要通过mixins来扩展。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">原因高阶组件就是高阶函数，而React的组件本身就是纯粹的函数，所以高阶函数对React来说易如反掌。相反Vue.js使用HTML模板创建视图组件，这时模板无法有效的编译，因此Vue不采用HOC来实现。</span><br><span class="line"></span><br><span class="line">**6）构建工具**</span><br><span class="line"></span><br><span class="line">两者都有自己的构建工具</span><br><span class="line"></span><br><span class="line">- React ==&gt; Create React APP</span><br><span class="line">- Vue ==&gt; vue-cli</span><br><span class="line"></span><br><span class="line">**7）跨平台**</span><br><span class="line"></span><br><span class="line">- React ==&gt; React Native</span><br><span class="line">- Vue ==&gt; Weex</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># React 渲染</span><br><span class="line"></span><br><span class="line">##  哪些方法会触发 React 重新渲染？重新渲染 render 会做些什么？</span><br><span class="line"></span><br><span class="line">**（1）哪些方法会触发 react 重新渲染?** </span><br><span class="line"></span><br><span class="line">- **setState（）方法被调用**</span><br><span class="line"></span><br><span class="line">setState 是 React 中最常用的命令，通常情况下，执行 setState 会触发 render。但是这里有个点值得关注，执行 setState 的时候不一定会重新渲染。当 setState 传入 null 时，并不会触发 render。</span><br><span class="line"></span><br><span class="line">```javascript</span><br><span class="line">class App extends React.Component &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    a: 1</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    console.log(&quot;render&quot;);</span><br><span class="line">    return (</span><br><span class="line">      &lt;React.Fragement&gt;</span><br><span class="line">        &lt;p&gt;&#123;this.state.a&#125;&lt;/p&gt;</span><br><span class="line">        &lt;button</span><br><span class="line">          onClick=&#123;() =&gt; &#123;</span><br><span class="line">            this.setState(&#123; a: 1 &#125;); // 这里并没有改变 a 的值</span><br><span class="line">          &#125;&#125;</span><br><span class="line">        &gt;</span><br><span class="line">          Click me</span><br><span class="line">        &lt;/button&gt;</span><br><span class="line">        &lt;button onClick=&#123;() =&gt; this.setState(null)&#125;&gt;setState null&lt;/button&gt;</span><br><span class="line">        &lt;Child /&gt;</span><br><span class="line">      &lt;/React.Fragement&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p><strong>父组件重新渲染</strong></p>
</li>
</ul>
<p>只要父组件重新渲染了，即使传入子组件的 props 未发生变化，那么子组件也会重新渲染，进而触发 render</p>
<p><strong>（2）重新渲染 render 会做些什么?</strong></p>
<ul>
<li>会对新旧 VNode 进行对比，也就是我们所说的Diff算法。</li>
<li>对新旧两棵树进行一个深度优先遍历，这样每一个节点都会一个标记，在到深度遍历的时候，每遍历到一和个节点，就把该节点和新的节点树进行对比，如果有差异就放到一个对象里面</li>
<li>遍历差异对象，根据差异的类型，根据对应对规则更新VNode</li>
</ul>
<p>React 的处理 render 的基本思维模式是每次一有变动就会去重新渲染整个应用。在 Virtual DOM 没有出现之前，最简单的方法就是直接调用 innerHTML。Virtual DOM厉害的地方并不是说它比直接操作 DOM 快，而是说不管数据怎么变，都会尽量以最小的代价去更新 DOM。React 将 render 函数返回的虚拟 DOM 树与老的进行比较，从而确定 DOM 要不要更新、怎么更新。当 DOM 树很大时，遍历两棵树进行各种比对还是相当耗性能的，特别是在顶层 setState 一个微小的修改，默认会去遍历整棵树。尽管 React 使用高度优化的 Diff 算法，但是这个过程仍然会损耗性能.</p>
<h2 id="React如何判断什么时候重新渲染组件？"><a href="#React如何判断什么时候重新渲染组件？" class="headerlink" title="React如何判断什么时候重新渲染组件？"></a>React如何判断什么时候重新渲染组件？</h2><p>组件状态的改变可以因为<code>props</code>的改变，或者直接通过<code>setState</code>方法改变。组件获得新的状态，然后React决定是否应该重新渲染组件。只要组件的state发生变化，React就会对组件进行重新渲染。这是因为React中的<code>shouldComponentUpdate</code>方法默认返回<code>true</code>，这就是导致每次更新都重新渲染的原因。</p>
<p>当React将要渲染组件时会执行<code>shouldComponentUpdate</code>方法来看它是否返回<code>true</code>（组件应该更新，也就是重新渲染）。所以需要重写<code>shouldComponentUpdate</code>方法让它根据情况返回<code>true</code>或者<code>false</code>来告诉React什么时候重新渲染什么时候跳过重新渲染。</p>
<h2 id="React-setState-调用的原理"><a href="#React-setState-调用的原理" class="headerlink" title="React setState 调用的原理"></a>React setState 调用的原理</h2><p><img src="/../img/image.png" alt="img"></p>
<p>具体的执行过程如下（源码级解析）：</p>
<ul>
<li>首先调用了<code>setState</code> 入口函数，入口函数在这里就是充当一个分发器的角色，根据入参的不同，将其分发到不同的功能函数中去；</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">ReactComponent</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">setState</span> = <span class="keyword">function</span> (<span class="params">partialState, callback</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">updater</span>.<span class="title function_">enqueueSetState</span>(<span class="variable language_">this</span>, partialState);</span><br><span class="line">  <span class="keyword">if</span> (callback) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">updater</span>.<span class="title function_">enqueueCallback</span>(<span class="variable language_">this</span>, callback, <span class="string">&#x27;setState&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>enqueueSetState</code> 方法将新的 <code>state</code> 放进组件的状态队列里，并调用 <code>enqueueUpdate</code> 来处理将要更新的实例对象；</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">enqueueSetState</span>: <span class="keyword">function</span> (<span class="params">publicInstance, partialState</span>) &#123;</span><br><span class="line">  <span class="comment">// 根据 this 拿到对应的组件实例</span></span><br><span class="line">  <span class="keyword">var</span> internalInstance = <span class="title function_">getInternalInstanceReadyForUpdate</span>(publicInstance, <span class="string">&#x27;setState&#x27;</span>);</span><br><span class="line">  <span class="comment">// 这个 queue 对应的就是一个组件实例的 state 数组</span></span><br><span class="line">  <span class="keyword">var</span> queue = internalInstance.<span class="property">_pendingStateQueue</span> || (internalInstance.<span class="property">_pendingStateQueue</span> = []);</span><br><span class="line">  queue.<span class="title function_">push</span>(partialState);</span><br><span class="line">  <span class="comment">//  enqueueUpdate 用来处理当前的组件实例</span></span><br><span class="line">  <span class="title function_">enqueueUpdate</span>(internalInstance);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>在 <code>enqueueUpdate</code> 方法中引出了一个关键的对象——<code>batchingStrategy</code>，该对象所具备的<code>isBatchingUpdates</code> 属性直接决定了当下是要走更新流程，还是应该排队等待；如果轮到执行，就调用 <code>batchedUpdates</code> 方法来直接发起更新流程。由此可以推测，<code>batchingStrategy</code> 或许正是 React 内部专门用于管控批量更新的对象。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">enqueueUpdate</span>(<span class="params">component</span>) &#123;</span><br><span class="line">  <span class="title function_">ensureInjected</span>();</span><br><span class="line">  <span class="comment">// 注意这一句是问题的关键，isBatchingUpdates标识着当前是否处于批量创建/更新组件的阶段</span></span><br><span class="line">  <span class="keyword">if</span> (!batchingStrategy.<span class="property">isBatchingUpdates</span>) &#123;</span><br><span class="line">    <span class="comment">// 若当前没有处于批量创建/更新组件的阶段，则立即更新组件</span></span><br><span class="line">    batchingStrategy.<span class="title function_">batchedUpdates</span>(enqueueUpdate, component);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 否则，先把组件塞入 dirtyComponents 队列里，让它“再等等”</span></span><br><span class="line">  dirtyComponents.<span class="title function_">push</span>(component);</span><br><span class="line">  <span class="keyword">if</span> (component.<span class="property">_updateBatchNumber</span> == <span class="literal">null</span>) &#123;</span><br><span class="line">    component.<span class="property">_updateBatchNumber</span> = updateBatchNumber + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong><code>batchingStrategy</code> 对象可以理解为“锁管理器”。这里的“锁”，是指 React 全局唯一的 <code>isBatchingUpdates</code> 变量，<code>isBatchingUpdates</code> 的初始值是 <code>false</code>，意味着“当前并未进行任何批量更新操作”。每当 React 调用 <code>batchedUpdate</code> 去执行更新动作时，会先把这个锁给“锁上”（置为 <code>true</code>），表明“现在正处于批量更新过程中”。当锁被“锁上”的时候，任何需要更新的组件都只能暂时进入 <code>dirtyComponents</code> 里排队等候下一次的批量更新，而不能随意“插队”。此处体现的“任务锁”的思想，是 React 面对大量状态仍然能够实现有序分批处理的基石。</p>
<p><img src="/../img/v2-9fcf2cfa698301ce7bc78bc3857904ed_1440w.png"></p>
<h2 id="requestIdleCallback、requestAnimationFrame"><a href="#requestIdleCallback、requestAnimationFrame" class="headerlink" title="requestIdleCallback、requestAnimationFrame"></a>requestIdleCallback、requestAnimationFrame</h2><p>浏览器用于优化任务调度的两个关键API，其核心区别在于<strong>执行时机、优先级和适用场景</strong>。以下是详细对比：</p>
<hr>
<h3 id="1-执行时机"><a href="#1-执行时机" class="headerlink" title="1. 执行时机"></a><strong>1. 执行时机</strong></h3><ul>
<li><strong><code>requestAnimationFrame</code>（rAF）</strong><ul>
<li><strong>触发时机</strong>：在浏览器每一帧渲染前执行（约16.6ms&#x2F;次，与屏幕刷新率同步）356。</li>
<li><strong>设计目标</strong>：处理与渲染相关的任务（如动画、UI更新），确保任务在布局和绘制前完成。</li>
<li><strong>特点</strong>：<ul>
<li>高优先级，每帧必定执行；</li>
<li>页面隐藏时自动暂停，节省资源27。</li>
</ul>
</li>
</ul>
</li>
<li><strong><code>requestIdleCallback</code>（rIC）</strong><ul>
<li><strong>触发时机</strong>：在浏览器空闲时段执行（即一帧内主线程任务完成后，剩余时间超过16ms时）158。</li>
<li><strong>设计目标</strong>：处理低优先级、非紧急任务（如日志上报、数据预加载）。</li>
<li><strong>特点</strong>：<ul>
<li>低优先级，可能因浏览器繁忙而跳过执行；</li>
<li>需通过<code>timeout</code>参数强制超时执行（可能引起卡顿）12。</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h3 id="2-优先级与性能影响"><a href="#2-优先级与性能影响" class="headerlink" title="2. 优先级与性能影响"></a><strong>2. 优先级与性能影响</strong></h3><table>
<thead>
<tr>
<th align="left"><strong>特性</strong></th>
<th align="left"><strong>rAF</strong></th>
<th align="left"><strong>rIC</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>优先级</strong></td>
<td align="left">高（渲染关键路径）</td>
<td align="left">低（空闲时段）</td>
</tr>
<tr>
<td align="left"><strong>阻塞主线程风险</strong></td>
<td align="left">可能（若任务过重）</td>
<td align="left">极低（任务可拆分）</td>
</tr>
<tr>
<td align="left"><strong>影响FPS</strong></td>
<td align="left">是（若超时导致丢帧）</td>
<td align="left">否（除非强制超时）2</td>
</tr>
<tr>
<td align="left"><strong>执行可靠性</strong></td>
<td align="left">高（每帧必执行）</td>
<td align="left">低（依赖空闲状态）8</td>
</tr>
</tbody></table>
<hr>
<h3 id="3-适用场景"><a href="#3-适用场景" class="headerlink" title="3. 适用场景"></a>3. 适用场景</h3><h5 id="requestAnimationFrame（rAF）"><a href="#requestAnimationFrame（rAF）" class="headerlink" title="requestAnimationFrame（rAF）"></a><strong><code>requestAnimationFrame</code>（rAF）</strong></h5><ul>
<li><strong>动画</strong>：CSS变换、Canvas动画36。</li>
<li><strong>实时UI更新</strong>：滚动效果、WebSocket数据实时渲染38。</li>
<li><strong>高频交互</strong>：确保流畅性，避免<code>setTimeout</code>丢帧56。</li>
</ul>
<h5 id="requestIdleCallback（rIC）"><a href="#requestIdleCallback（rIC）" class="headerlink" title="requestIdleCallback（rIC）"></a><strong><code>requestIdleCallback</code>（rIC）</strong></h5><ul>
<li><strong>非关键任务</strong>：日志上报、性能监控数据批量发送27。</li>
<li><strong>后台计算</strong>：AI推理、大数据处理38。</li>
<li><strong>资源预加载</strong>：非首屏图片或数据35。</li>
</ul>
<blockquote>
<p>💡 <strong>关键区别</strong>：</p>
<ul>
<li>rAF 用于<strong>视觉相关</strong>任务，确保流畅渲染；</li>
<li>rIC 用于<strong>非视觉相关</strong>任务，避免抢占主线程36。</li>
</ul>
</blockquote>
<hr>
<h3 id="4-使用注意事项"><a href="#4-使用注意事项" class="headerlink" title="4. 使用注意事项"></a><strong>4. 使用注意事项</strong></h3><h5 id="rAF-的陷阱"><a href="#rAF-的陷阱" class="headerlink" title="rAF 的陷阱"></a><strong>rAF 的陷阱</strong></h5><ul>
<li><strong>避免重任务</strong>：复杂计算会阻塞渲染，导致卡顿（需拆分任务）8。</li>
<li><strong>隐藏页面暂停</strong>：后台标签页中动画自动停止27。</li>
</ul>
<h5 id="rIC-的陷阱"><a href="#rIC-的陷阱" class="headerlink" title="rIC 的陷阱"></a><strong>rIC 的陷阱</strong></h5><ul>
<li><strong>禁止DOM操作</strong>：<br>空闲时段布局已确定，修改DOM会触发强制重排，严重损害性能15。</li>
<li><strong>慎用Promise</strong>：<br>Promise回调可能在空闲结束后立即执行，拉长帧耗时1。</li>
<li><strong>超时风险</strong>：<br>设置<code>timeout</code>可能强制执行，引发卡顿（超时任务需极轻量）18。</li>
</ul>
<hr>
<h4 id="5-最佳实践"><a href="#5-最佳实践" class="headerlink" title="5. 最佳实践"></a><strong>5. 最佳实践</strong></h4><ol>
<li><strong>混合使用</strong>：<ul>
<li>视觉动画用 <strong>rAF</strong>（如元素移动）6；</li>
<li>非紧急任务用 <strong>rIC</strong>（如埋点上报）27。</li>
</ul>
</li>
<li><strong>任务拆分</strong>：<ul>
<li>在rIC回调中用<code>deadline.timeRemaining()</code>检查剩余时间，分段执行任务58。</li>
</ul>
</li>
<li><strong>兼容性处理</strong>：<ul>
<li>rIC兼容性较差（不支持IE），可用<code>setTimeout(fn, 0)</code>降级8。</li>
</ul>
</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 示例：rIC 分段任务</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">processTasks</span>(<span class="params">deadline</span>) &#123;</span><br><span class="line">  <span class="keyword">while</span> (deadline.<span class="title function_">timeRemaining</span>() &gt; <span class="number">0</span> &amp;&amp; tasks.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="title function_">executeTask</span>(tasks.<span class="title function_">shift</span>());</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (tasks.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="title function_">requestIdleCallback</span>(processTasks, &#123; <span class="attr">timeout</span>: <span class="number">1000</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">requestIdleCallback</span>(processTasks);</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="总结：核心区别"><a href="#总结：核心区别" class="headerlink" title="总结：核心区别"></a><strong>总结：核心区别</strong></h3><table>
<thead>
<tr>
<th align="left"><strong>维度</strong></th>
<th align="left"><strong>requestAnimationFrame</strong></th>
<th align="left"><strong>requestIdleCallback</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>本质</strong></td>
<td align="left">渲染流水线的一部分</td>
<td align="left">空闲时段的任务调度</td>
</tr>
<tr>
<td align="left"><strong>优先级</strong></td>
<td align="left">高（影响用户体验）</td>
<td align="left">低（可被跳过）</td>
</tr>
<tr>
<td align="left"><strong>执行保证</strong></td>
<td align="left">每帧必执行</td>
<td align="left">依赖空闲时间</td>
</tr>
<tr>
<td align="left"><strong>典型场景</strong></td>
<td align="left">动画、实时UI</td>
<td align="left">日志、预加载、后台计算</td>
</tr>
<tr>
<td align="left"><strong>风险操作</strong></td>
<td align="left">避免重计算</td>
<td align="left">禁止DOM修改&#x2F;Promise回调</td>
</tr>
</tbody></table>
<h2 id="Fiber"><a href="#Fiber" class="headerlink" title="Fiber"></a>Fiber</h2><h3 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a><strong>数据结构</strong></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="comment">// 跟当前Fiber相关本地状态（比如浏览器环境就是DOM节点）</span></span><br><span class="line">  <span class="attr">stateNode</span>: any,</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 单链表树结构</span></span><br><span class="line">  <span class="attr">return</span>: <span class="title class_">Fiber</span> | <span class="literal">null</span>,<span class="comment">// 指向他在Fiber节点树中的`parent`，用来在处理完这个节点之后向上返回</span></span><br><span class="line">  <span class="attr">child</span>: <span class="title class_">Fiber</span> | <span class="literal">null</span>,<span class="comment">// 指向自己的第一个子节点</span></span><br><span class="line">  <span class="attr">sibling</span>: <span class="title class_">Fiber</span> | <span class="literal">null</span>,  <span class="comment">// 指向自己的兄弟结构，兄弟节点的return指向同一个父节点</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 更新相关</span></span><br><span class="line">  <span class="attr">pendingProps</span>: any,  <span class="comment">// 新的变动带来的新的props</span></span><br><span class="line">  <span class="attr">memoizedProps</span>: any,  <span class="comment">// 上一次渲染完成之后的props</span></span><br><span class="line">  <span class="attr">updateQueue</span>: <span class="title class_">UpdateQueue</span>&lt;any&gt; | <span class="literal">null</span>,  <span class="comment">// 该Fiber对应的组件产生的Update会存放在这个队列里面</span></span><br><span class="line">  <span class="attr">memoizedState</span>: any, <span class="comment">// 上一次渲染的时候的state</span></span><br><span class="line">    </span><br><span class="line">  <span class="comment">// Scheduler 相关</span></span><br><span class="line">  <span class="attr">expirationTime</span>: <span class="title class_">ExpirationTime</span>,  <span class="comment">// 代表任务在未来的哪个时间点应该被完成，不包括他的子树产生的任务</span></span><br><span class="line">  <span class="comment">// 快速确定子树中是否有不在等待的变化</span></span><br><span class="line">  <span class="attr">childExpirationTime</span>: <span class="title class_">ExpirationTime</span>,</span><br><span class="line">    </span><br><span class="line"> <span class="comment">// 在Fiber树更新的过程中，每个Fiber都会有一个跟其对应的Fiber</span></span><br><span class="line">  <span class="comment">// 我们称他为`current &lt;==&gt; workInProgress`</span></span><br><span class="line">  <span class="comment">// 在渲染完成之后他们会交换位置</span></span><br><span class="line">  <span class="attr">alternate</span>: <span class="title class_">Fiber</span> | <span class="literal">null</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Effect 相关的</span></span><br><span class="line">  <span class="attr">effectTag</span>: <span class="title class_">SideEffectTag</span>, <span class="comment">// 用来记录Side Effect</span></span><br><span class="line">  <span class="attr">nextEffect</span>: <span class="title class_">Fiber</span> | <span class="literal">null</span>, <span class="comment">// 单链表用来快速查找下一个side effect</span></span><br><span class="line">  <span class="attr">firstEffect</span>: <span class="title class_">Fiber</span> | <span class="literal">null</span>,  <span class="comment">// 子树中第一个side effect</span></span><br><span class="line">  <span class="attr">lastEffect</span>: <span class="title class_">Fiber</span> | <span class="literal">null</span>, <span class="comment">// 子树中最后一个side effect</span></span><br><span class="line">  ....</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>


<p><img src="/../img/v2-cfaea6c0e9362b3701b1cf342ed4588b_1440w.png"></p>
<h3 id="构建流程"><a href="#构建流程" class="headerlink" title="构建流程"></a><strong>构建流程</strong></h3><ol>
<li><p><strong>根节点启动</strong>：</p>
<ul>
<li>从根 Fiber 节点开始</li>
<li>创建对应的 WIP 节点（<code>workInProgressRoot</code>）</li>
</ul>
</li>
<li><p><strong>节点克隆&#x2F;创建</strong>：</p>
<ul>
<li>检查当前节点是否有对应的 <code>alternate</code>（上次渲染的 Fiber）</li>
<li>有则克隆，无则创建全新 Fiber 节点</li>
</ul>
</li>
<li><p><strong>属性继承</strong>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 复用状态和属性</span></span><br><span class="line">workInProgress.<span class="property">memoizedState</span> = current.<span class="property">memoizedState</span>;</span><br><span class="line">workInProgress.<span class="property">memoizedProps</span> = current.<span class="property">memoizedProps</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>子节点处理</strong>：</p>
<ul>
<li>递归处理每个子节点</li>
<li>创建子 Fiber 节点并建立父子关系</li>
<li>设置 <code>child</code>、<code>sibling</code>、<code>return</code> 指针</li>
</ul>
</li>
<li><p><strong>深度优先遍历</strong>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">workLoopSync</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">while</span> (workInProgress !== <span class="literal">null</span>) &#123;</span><br><span class="line">    workInProgress = <span class="title function_">performUnitOfWork</span>(workInProgress);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>完成节点</strong>：</p>
<ul>
<li>当节点没有子节点时，调用 <code>completeUnitOfWork</code></li>
<li>处理兄弟节点或回溯到父节点</li>
</ul>
</li>
<li><p>指针关系示例</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父节点</span></span><br><span class="line"><span class="keyword">const</span> parentFiber = &#123;</span><br><span class="line">  <span class="attr">child</span>: child1, <span class="comment">// 第一个子节点</span></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子节点1</span></span><br><span class="line"><span class="keyword">const</span> child1 = &#123;</span><br><span class="line">  <span class="attr">sibling</span>: child2, <span class="comment">// 下一个兄弟节点</span></span><br><span class="line">  <span class="attr">return</span>: parentFiber, <span class="comment">// 指向父节点</span></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子节点2</span></span><br><span class="line"><span class="keyword">const</span> child2 = &#123;</span><br><span class="line">  <span class="attr">sibling</span>: <span class="literal">null</span>, <span class="comment">// 最后一个节点</span></span><br><span class="line">  <span class="attr">return</span>: parentFiber,</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<h3 id="Diff-算法核心原则"><a href="#Diff-算法核心原则" class="headerlink" title="Diff 算法核心原则"></a>Diff 算法核心原则</h3><table>
<thead>
<tr>
<th align="left">原则</th>
<th align="left">描述</th>
<th align="left">优势</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>同级比较</strong></td>
<td align="left">只比较同一层级节点</td>
<td align="left">O(n) 复杂度</td>
</tr>
<tr>
<td align="left"><strong>Key 优化</strong></td>
<td align="left">使用 key 匹配相同节点</td>
<td align="left">减少不必要的重建</td>
</tr>
<tr>
<td align="left"><strong>类型优先</strong></td>
<td align="left">不同类型组件直接替换</td>
<td align="left">避免无效比较</td>
</tr>
<tr>
<td align="left"><strong>组件稳定</strong></td>
<td align="left">相同类型组件复用</td>
<td align="left">保留状态和 DOM</td>
</tr>
</tbody></table>
<p><img src="/../img/v2-8c3b88ee7471ba1303c4460967da36fa_1440w.png"></p>
<h1 id="React-组件"><a href="#React-组件" class="headerlink" title="React 组件"></a><strong>React 组件</strong></h1><h2 id="React-高阶组件是什么，和普通组件有什么区别，适用什么场景"><a href="#React-高阶组件是什么，和普通组件有什么区别，适用什么场景" class="headerlink" title="React 高阶组件是什么，和普通组件有什么区别，适用什么场景"></a>React 高阶组件是什么，和普通组件有什么区别，适用什么场景</h2><p>官方解释∶ </p>
<p>高阶组件（HOC）是 React 中用于复用组件逻辑的一种高级技巧。HOC 自身不是 React API 的一部分，它是一种基于 React 的组合特性而形成的设计模式。</p>
<p>高阶组件（HOC）就是一个函数，且该函数接受一个组件作为参数，并返回一个新的组件，它只是一种组件的设计模式，这种设计模式是由react自身的组合性质必然产生的。我们将它们称为纯组件，因为它们可以接受任何动态提供的子组件，但它们不会修改或复制其输入组件中的任何行为。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// hoc的定义</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">withSubscription</span>(<span class="params">WrappedComponent, selectData</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">class</span> <span class="title class_">extends</span> <span class="title class_">React</span>.<span class="property">Component</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">      <span class="variable language_">super</span>(props);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">        <span class="attr">data</span>: <span class="title function_">selectData</span>(<span class="title class_">DataSource</span>, props)</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 一些通用的逻辑处理</span></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="comment">// ... 并使用新数据渲染被包装的组件!</span></span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">WrappedComponent</span> <span class="attr">data</span>=<span class="string">&#123;this.state.data&#125;</span> &#123;<span class="attr">...this.props</span>&#125; /&gt;</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">BlogPostWithSubscription</span> = <span class="title function_">withSubscription</span>(<span class="title class_">BlogPost</span>,</span><br><span class="line">  <span class="function">(<span class="params">DataSource, props</span>) =&gt;</span> <span class="title class_">DataSource</span>.<span class="title function_">getBlogPost</span>(props.<span class="property">id</span>));</span><br></pre></td></tr></table></figure>

<p><strong>1）HOC的优缺点</strong></p>
<ul>
<li>优点∶ 逻辑服用、不影响被包裹组件的内部逻辑。</li>
<li>缺点∶hoc传递给被包裹组件的props容易和被包裹后的组件重名，进而被覆盖</li>
</ul>
<p><strong>2）适用场景</strong></p>
<ul>
<li>代码复用，逻辑抽象 </li>
<li>渲染劫持 </li>
<li>State 抽象和更改 </li>
<li>Props 更改</li>
</ul>
<p><strong>3）具体应用例子</strong> </p>
<ul>
<li>**权限控制：**利用高阶组件的 <strong>条件渲染</strong> 特性可以对页面进行权限控制，权限控制一般分为两个维度：页面级别和 页面元素级别</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// HOC.js</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">withAdminAuth</span>(<span class="params">WrappedComponent</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">class</span> <span class="title class_">extends</span> <span class="title class_">React</span>.<span class="property">Component</span> &#123;</span><br><span class="line">        state = &#123;</span><br><span class="line">            <span class="attr">isAdmin</span>: <span class="literal">false</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">async</span> <span class="title function_">UNSAFE_componentWillMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> currentRole = <span class="keyword">await</span> <span class="title function_">getCurrentUserRole</span>();</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">                <span class="attr">isAdmin</span>: currentRole === <span class="string">&#x27;Admin&#x27;</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">isAdmin</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">WrappedComponent</span> &#123;<span class="attr">...this.props</span>&#125; /&gt;</span></span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>您没有权限查看该页面，请联系管理员！<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// pages/page-a.js</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PageA</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">        <span class="variable language_">super</span>(props);</span><br><span class="line">        <span class="comment">// something here...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">UNSAFE_componentWillMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// fetching data</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// render page with data</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">withAdminAuth</span>(<span class="title class_">PageA</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// pages/page-b.js</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PageB</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">        <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="comment">// something here...</span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="title function_">UNSAFE_componentWillMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// fetching data</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// render page with data</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">withAdminAuth</span>(<span class="title class_">PageB</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>**组件渲染性能追踪：**借助父组件子组件生命周期规则捕获子组件的生命周期，可以方便的对某个组件的渲染时间进行记录∶</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Home</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">        <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello World.<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">withTiming</span>(<span class="params">WrappedComponent</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">class</span> <span class="title class_">extends</span> <span class="title class_">WrappedComponent</span> &#123;</span><br><span class="line">            <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">                <span class="variable language_">super</span>(props);</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">start</span> = <span class="number">0</span>;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">end</span> = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="title function_">UNSAFE_componentWillMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="variable language_">super</span>.<span class="property">componentWillMount</span> &amp;&amp; <span class="variable language_">super</span>.<span class="title function_">componentWillMount</span>();</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">start</span> = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="variable language_">super</span>.<span class="property">componentDidMount</span> &amp;&amp; <span class="variable language_">super</span>.<span class="title function_">componentDidMount</span>();</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">end</span> = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;WrappedComponent.name&#125;</span> 组件渲染时间为 <span class="subst">$&#123;<span class="variable language_">this</span>.end - <span class="variable language_">this</span>.start&#125;</span> ms`</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable language_">super</span>.<span class="title function_">render</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">withTiming</span>(<span class="title class_">Home</span>);   </span><br></pre></td></tr></table></figure>

<p>注意：withTiming 是利用 反向继承 实现的一个高阶组件，功能是计算被包裹组件（这里是 Home 组件）的渲染时间。</p>
<ul>
<li><strong>页面复用</strong></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">withFetching</span> = fetching =&gt; <span class="function"><span class="params">WrappedComponent</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">class</span> <span class="title class_">extends</span> <span class="title class_">React</span>.<span class="property">Component</span> &#123;</span><br><span class="line">        state = &#123;</span><br><span class="line">            <span class="attr">data</span>: [],</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">async</span> <span class="title function_">UNSAFE_componentWillMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> data = <span class="keyword">await</span> <span class="title function_">fetching</span>();</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">                data,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">WrappedComponent</span> <span class="attr">data</span>=<span class="string">&#123;this.state.data&#125;</span> &#123;<span class="attr">...this.props</span>&#125; /&gt;</span></span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// pages/page-a.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">withFetching</span>(<span class="title function_">fetching</span>(<span class="string">&#x27;science-fiction&#x27;</span>))(<span class="title class_">MovieList</span>);</span><br><span class="line"><span class="comment">// pages/page-b.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">withFetching</span>(<span class="title function_">fetching</span>(<span class="string">&#x27;action&#x27;</span>))(<span class="title class_">MovieList</span>);</span><br><span class="line"><span class="comment">// pages/page-other.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">withFetching</span>(<span class="title function_">fetching</span>(<span class="string">&#x27;some-other-type&#x27;</span>))(<span class="title class_">MovieList</span>);</span><br></pre></td></tr></table></figure>





<h2 id="类组件与函数组件有什么异同"><a href="#类组件与函数组件有什么异同" class="headerlink" title="类组件与函数组件有什么异同"></a>类组件与函数组件有什么异同</h2><p><strong>相同点：</strong></p>
<p><strong>组件是 React 可复用的最小代码片段</strong>，它们会返回要在页面中渲染的 React 元素。也正因为组件是 React 的最小编码单位，所以无论是函数组件还是类组件，在使用方式和最终呈现效果上都是完全一致的。</p>
<p>我们甚至可以将一个类组件改写成函数组件，或者把函数组件改写成一个类组件（虽然并不推荐这种重构行为）。从使用者的角度而言，很难从使用体验上区分两者，而且在现代浏览器中，闭包和类的性能只在极端场景下才会有明显的差别。所以，基本可认为两者作为组件是完全一致的。</p>
<p><strong>不同点：</strong></p>
<ul>
<li>它们在开发时的心智模型上却存在巨大的差异。<strong>类组件是基于面向对象编程的</strong>，它主打的是继承、生命周期等核心概念；而<strong>函数组件内核是函数式编程</strong>，主打的是 immutable、没有副作用、引用透明等特点。</li>
<li>之前，在使用场景上，如果存在需要使用生命周期的组件，那么主推类组件；设计模式上，如果需要使用继承，那么主推类组件。但现在由于 React Hooks 的推出，生命周期概念的淡出，函数组件可以完全取代类组件。其次继承并不是组件最佳的设计模式，官方更推崇“组合优于继承”的设计概念，所以类组件在这方面的优势也在淡出。</li>
<li>性能优化上，<strong>类组件主要依靠 shouldComponentUpdate 阻断渲染来提升性能</strong>，<br>                而<strong>函数组件依靠 React.memo 缓存渲染结果来提升性能</strong>。</li>
<li>从上手程度而言，类组件更容易上手，从未来趋势上看，由于React Hooks 的推出，函数组件成了社区未来主推的方案。</li>
<li>类组件在未来时间切片与并发模式中，由于生命周期带来的复杂度，并不易于优化。而函数组件本身轻量简单，且<strong>在 Hooks 的基础上提供了比原先更细粒度的逻辑组织与复用</strong>，更能适应 React 的未来发展。</li>
</ul>
<h2 id="组件通信"><a href="#组件通信" class="headerlink" title="组件通信"></a>组件通信</h2><ul>
<li><strong>⽗组件向⼦组件通讯</strong>: ⽗组件可以向⼦组件通过传 props 的⽅式，向⼦组件进⾏通讯 </li>
<li><strong>⼦组件向⽗组件通讯</strong>: props+回调的⽅式，⽗组件向⼦组件传递props进⾏通讯，此props为作⽤域为⽗组件⾃身的函 数，⼦组件调⽤该函数，将⼦组件想要传递的信息，作为参数，传递到⽗组件的作⽤域中 </li>
<li><strong>兄弟组件通信</strong>: 找到这两个兄弟节点共同的⽗节点,结合上⾯两种⽅式由⽗节点转发信息进⾏通信 </li>
<li><strong>跨层级通信</strong>: Context 设计⽬的是为了共享那些对于⼀个组件树⽽⾔是“全局”的数据，例如当前认证的⽤户、主题或⾸选语⾔，对于跨越多层的全局数据通过 Context 通信再适合不过 </li>
<li><strong>发布订阅模式</strong>: 发布者发布事件，订阅者监听事件并做出反应,我们可以通过引⼊event模块进⾏通信 </li>
<li><strong>全局状态管理⼯具</strong>: 借助Redux或者Mobx等全局状态管理⼯具进⾏通信,这种⼯具会维护⼀个全局状态中⼼Store,并根据不同的事件产⽣新的状态</li>
</ul>
<h1 id="事件机制"><a href="#事件机制" class="headerlink" title="事件机制"></a>事件机制</h1><p>一个事件触发后，会在子元素和父元素之间传播（propagation）。这种传播分成三个阶段</p>
<p><img src="/../img/2019011111581623.jpg" alt="img"></p>
<p>如上图所示，事件传播分成三个阶段：</p>
<p>捕获阶段：从window对象传导到目标节点（上层传到底层）称为“捕获阶段”（capture phase），捕获阶段不会响应任何事件；<br>目标阶段：在目标节点上触发，称为“目标阶段”<br>冒泡阶段：从目标节点传导回window对象（从底层传回上层），称为“冒泡阶段”（bubbling phase）。事件代理即是利用事件冒泡的机制把里层所需要响应的事件绑定到外层；<br><strong>事件代理</strong></p>
<p>事件代理（Event Delegation），又称之为事件委托。是JavaScript中常用绑定事件的常用技巧。顾名思义，“事件代理”即是把原本需要绑定在子元素的响应事件（click、keydown……）委托给父元素，让父元素担当事件监听的职务。事件代理的原理是DOM元素的事件冒泡在React中事件需要通过元素的属性来设置，</p>
<h3 id="React-事件机制"><a href="#React-事件机制" class="headerlink" title="React 事件机制"></a>React 事件机制</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div onClick=&#123;<span class="variable language_">this</span>.<span class="property">handleClick</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>)&#125;&gt;点我&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<p>React并不是将click事件绑定到了div的真实DOM上，而是<strong>在document处监听了所有的事件，当事件发生并且<font color="red">冒泡</font>到document处的时候，React将事件内容封装并交由真正的处理函数运行</strong>。这样的方式不仅仅减少了内存的消耗，还能在组件挂在销毁时统一订阅和移除事件。</p>
<p>React <strong>基于 Virtual DOM 实现了一个SyntheticEvent（合成事件）层，我们所定义的事件处理器会接收到一个SyntheticEvent对象的实例</strong>。与原生事件直接在元素上注册的方式不同的是，react的合成事件不会直接绑定到目标dom节点上，用事件委托机制，以队列的方式，从触发事件的组件向父组件回溯直到document节点，因此<strong>React组件上声明的事件最终绑定到了document 上</strong>。用一个统一的监听器去监听，这个监听器上保存着目标节点与事件对象的映射，当组件挂载或卸载时，只是在这个统一的事件监听器上插入或删除一些对象；当事件发生时，首先被这个统一的事件监听器处理，然后在映射里找到真正的事件处理函数并调用</p>
<p>除此之外，冒泡到document上的事件也不是原生的浏览器事件，而是由react自己实现的合成事件（SyntheticEvent）。因此如果不想要是事件冒泡的话应该调用<strong>event.preventDefault()方法</strong>，而不是调用event.stopProppagation()方法。</p>
<p><img src="/../img/77fa6b2a59c92e160bc171f9c80783e7.jpg" alt="img"></p>
<p><strong>JSX 上写的事件并没有绑定在对应的真实 DOM 上，而是通过事件代理的方式，将所有的事件都统一绑定在了 <code>document</code> 上。这样的方式不仅减少了内存消耗，还能在组件挂载销毁时统一订阅和移除事件。</strong></p>
<p>另外冒泡到 <code>document</code> 上的事件也不是原生浏览器事件，而是 React 自己实现的合成事件（SyntheticEvent）。因此我们如果不想要事件冒泡的话，调用 <code>event.stopPropagation</code> 是无效的，而应该调用 <code>event.preventDefault</code>。</p>
<p>实现合成事件的目的如下：</p>
<ul>
<li>合成事件首先抹平了浏览器之间的兼容问题，另外这是一个跨浏览器原生事件包装器，赋予了跨浏览器开发的能力；</li>
<li>对于原生浏览器事件来说，浏览器会给监听器创建一个事件对象。如果你有很多的事件监听，那么就需要分配很多的事件对象，造成高额的内存分配问题。但是对于合成事件来说，有一个事件池专门来管理它们的创建和销毁，当事件需要被使用时，就会从池子中复用对象，事件回调结束后，就会销毁事件对象上的属性，从而便于下次复用事件对象。</li>
</ul>
<h3 id="React的事件和普通的HTML事件有什么不同？"><a href="#React的事件和普通的HTML事件有什么不同？" class="headerlink" title="React的事件和普通的HTML事件有什么不同？"></a>React的事件和普通的HTML事件有什么不同？</h3><p>区别：</p>
<ul>
<li><p>对于事件名称命名方式，原生事件为全小写，<strong>react 事件采用小驼峰</strong>；</p>
</li>
<li><p>对于事件函数处理语法，原生事件为字符串，<strong>react 事件为函数</strong>； </p>
<p>和原生JS不同，在React中事件的属性需要使用驼峰命名法：</p>
<p>onclick -&gt; onClick</p>
<p>onchange -&gt; onChange</p>
<p>属性值不能直接执行代码，而是需要一个回调函数：</p>
<p>onclick&#x3D;”alert(123)”<br>onClick&#x3D;{()&#x3D;&gt;{alert(123)}}<br>onClick&#x3D;{handler}</p>
</li>
<li><p>react 事件不能采用 return false 的方式来阻止浏览器的默认行为，而必须要地明确地调用<code>preventDefault()</code>来阻止默认行为。</p>
</li>
</ul>
<p>合成事件是 react 模拟原生 DOM 事件所有能力的一个事件对象，其优点如下：</p>
<ul>
<li>兼容所有浏览器，更好的跨平台；</li>
<li>将事件统一存放在一个数组，避免频繁的新增与删除（垃圾回收）。</li>
<li>方便 react 统一管理和事务机制。</li>
</ul>
<p>事件的执行顺序为<strong>原生事件先执行，合成事件后执行</strong>，<strong>合成事件会冒泡绑定到 document 上</strong>，所以尽量避免原生事件与合成事件混用，如果<strong>原生事件阻止冒泡，可能会导致合成事件不执行</strong>，因为需要冒泡到document 上合成事件才会执行。</p>
<h1 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h1><p><img src="/../img/image-20240225161622185.png" alt="image-20240225161622185"></p>
<p><strong>新的生命周期</strong></p>
<p><img src="/../img/image-20240225160610933.png" alt="image-20240225160610933"></p>
<h2 id="React的生命周期有哪些？"><a href="#React的生命周期有哪些？" class="headerlink" title="React的生命周期有哪些？"></a>React的生命周期有哪些？</h2><p> React 通常将组件生命周期分为三个阶段：</p>
<ul>
<li>装载阶段（Mount），组件第一次在DOM树中被渲染的过程；</li>
<li>更新过程（Update），组件状态发生变化，重新更新渲染的过程；</li>
<li>卸载过程（Unmount），组件从DOM树中被移除的过程；</li>
</ul>
<p><img src="/../img/image1111111.png" alt="img"></p>
<h3 id="1）组件挂载阶段"><a href="#1）组件挂载阶段" class="headerlink" title="1）组件挂载阶段"></a>1）组件挂载阶段</h3><p>挂载阶段组件被创建，然后组件实例插入到 DOM 中，完成组件的第一次渲染，该过程只会发生一次，在此阶段会依次调用以下这些方法：</p>
<ul>
<li>constructor</li>
<li>getDerivedStateFromProps</li>
<li>render</li>
<li>componentDidMount</li>
</ul>
<h4 id="（1）constructor"><a href="#（1）constructor" class="headerlink" title="（1）constructor"></a>（1）constructor</h4><p>组件的构造函数，第一个被执行，若没有显式定义它，会有一个默认的构造函数，但是若显式定义了构造函数，我们必须在构造函数中执行 <code>super(props)</code>，否则无法在构造函数中拿到this。</p>
<p>如果不初始化 state 或不进行方法绑定，则不需要为 React 组件实现构造函数<strong>Constructor</strong>。</p>
<p>constructor中通常只做两件事： </p>
<ul>
<li>初始化组件的 state</li>
<li>给事件处理方法绑定 this</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="variable language_">super</span>(props);</span><br><span class="line">  <span class="comment">// 不要在构造函数中调用 setState，可以直接给 state 设置初始值</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">state</span> = &#123; <span class="attr">counter</span>: <span class="number">0</span> &#125;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">handleClick</span> = <span class="variable language_">this</span>.<span class="property">handleClick</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="（2）getDerivedStateFromProps"><a href="#（2）getDerivedStateFromProps" class="headerlink" title="（2）getDerivedStateFromProps"></a>（2）getDerivedStateFromProps</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="title function_">getDerivedStateFromProps</span>(props, state)</span><br></pre></td></tr></table></figure>

<p>这是个静态方法，所以不能在这个函数里使用 <code>this</code>，有两个参数 <code>props</code> 和 <code>state</code>，分别指接收到的新参数和当前组件的 <code>state</code> 对象，这个函数会返回一个对象用来更新当前的 <code>state</code> 对象，如果不需要更新可以返回 <code>null</code>。</p>
<p>该函数会在装载时，接收到新的 <code>props</code> 或者调用了 <code>setState</code> 和 <code>forceUpdate</code> 时被调用。如当接收到新的属性想修改 <code>state</code> ，就可以使用。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 当 props.counter 变化时，赋值给 state </span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">counter</span>: <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">getDerivedStateFromProps</span>(<span class="params">props, state</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (props.<span class="property">counter</span> !== state.<span class="property">counter</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">counter</span>: props.<span class="property">counter</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  handleClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">counter</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">counter</span> + <span class="number">1</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick&#125;</span>&gt;</span>Hello, world!&#123;this.state.counter&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>现在可以显式传入 <code>counter</code> ，但是这里有个问题，如果想要通过点击实现 <code>state.counter</code> 的增加，但这时会发现值不会发生任何变化，一直保持 <code>props</code> 传进来的值。这是由于在 React 16.4^ 的版本中 <code>setState</code> 和 <code>forceUpdate</code> 也会触发这个生命周期，所以当组件内部 <code>state</code> 变化后，就会重新走这个方法，同时会把 <code>state</code> 值赋值为 <code>props</code> 的值。因此需要多加一个字段来记录之前的 <code>props</code> 值，这样就会解决上述问题。具体如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这里只列出需要变化的地方</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="comment">// 增加一个 preCounter 来记录之前的 props 传来的值</span></span><br><span class="line">      <span class="attr">preCounter</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="attr">counter</span>: <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">getDerivedStateFromProps</span>(<span class="params">props, state</span>) &#123;</span><br><span class="line">    <span class="comment">// 跟 state.preCounter 进行比较</span></span><br><span class="line">    <span class="keyword">if</span> (props.<span class="property">counter</span> !== state.<span class="property">preCounter</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">counter</span>: props.<span class="property">counter</span>,</span><br><span class="line">        <span class="attr">preCounter</span>: props.<span class="property">counter</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">  handleClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">counter</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">counter</span> + <span class="number">1</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick&#125;</span>&gt;</span>Hello, world!&#123;this.state.counter&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="（3）render"><a href="#（3）render" class="headerlink" title="（3）render"></a>（3）render</h4><p>render是React 中最核心的方法，一个组件中必须要有这个方法，它会根据状态 <code>state</code> 和属性 <code>props</code> 渲染组件。这个函数只做一件事，就是返回需要渲染的内容，所以不要在这个函数内做其他业务逻辑，通常调用该方法会返回以下类型中一个：</p>
<ul>
<li><strong>React 元素</strong>：这里包括原生的 DOM 以及 React 组件；</li>
<li><strong>数组和 Fragment（片段）</strong>：可以返回多个元素；</li>
<li><strong>Portals（插槽）</strong>：可以将子元素渲染到不同的 DOM 子树种；</li>
<li><strong>字符串和数字</strong>：被渲染成 DOM 中的 text 节点；</li>
<li><strong>布尔值或 null</strong>：不渲染任何内容。</li>
</ul>
<h4 id="（4）componentDidMount"><a href="#（4）componentDidMount" class="headerlink" title="（4）componentDidMount()"></a>（4）componentDidMount()</h4><p>componentDidMount()会在组件挂载后（插入 DOM 树中）立即调。该阶段通常进行以下操作：</p>
<ul>
<li>执行依赖于DOM的操作；</li>
<li>发送网络请求；（官方建议）</li>
<li>添加订阅消息（会在componentWillUnmount取消订阅）；</li>
</ul>
<p>如果在 <code>componentDidMount</code> 中调用 <code>setState</code> ，就会触发一次额外的渲染，多调用了一次 <code>render</code> 函数，由于它是在浏览器刷新屏幕前执行的，所以用户对此是没有感知的，但是我应当避免这样使用，这样会带来一定的性能问题，尽量是在 <code>constructor</code> 中初始化 <code>state</code> 对象。</p>
<p>在组件装载之后，将计数数字变为1：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span>  &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">counter</span>: <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">componentDidMount</span> () &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">counter</span>: <span class="number">1</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span> ()  &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;counter&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        counter值: &#123; this.state.counter &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2）组件更新阶段"><a href="#2）组件更新阶段" class="headerlink" title="2）组件更新阶段"></a>2）组件更新阶段</h3><p>当组件的 <code>props</code> 改变了，或组件内部调用了 <code>setState/forceUpdate</code>，会触发更新重新渲染，这个过程可能会发生多次。这个阶段会依次调用下面这些方法：</p>
<ul>
<li>getDerivedStateFromProps</li>
<li>shouldComponentUpdate</li>
<li>render</li>
<li>getSnapshotBeforeUpdate</li>
<li>componentDidUpdate</li>
</ul>
<h4 id="（1）shouldComponentUpdate"><a href="#（1）shouldComponentUpdate" class="headerlink" title="（1）shouldComponentUpdate"></a>（1）shouldComponentUpdate</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">shouldComponentUpdate</span>(nextProps, nextState)</span><br></pre></td></tr></table></figure>

<p>在说这个生命周期函数之前，来看两个问题：</p>
<ul>
<li><strong>setState 函数在任何情况下都会导致组件重新渲染吗？例如下面这种情况：</strong></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;<span class="attr">number</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">number</span>&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>如果没有调用 setState，props 值也没有变化，是不是组件就不会重新渲染？</strong></li>
</ul>
<p>第一个问题答案是 <strong>会</strong> ，第二个问题如果是父组件重新渲染时，不管传入的 props 有没有变化，都会引起子组件的重新渲染。</p>
<p>那么有没有什么方法解决在这两个场景下不让组件重新渲染进而提升性能呢？这个时候 <code>shouldComponentUpdate</code> 登场了，这个生命周期函数是用来提升速度的，它是在重新渲染组件开始前触发的，默认返回 <code>true</code>，可以比较 <code>this.props</code> 和 <code>nextProps</code> ，<code>this.state</code> 和 <code>nextState</code> 值是否变化，来确认返回 true 或者 <code>false</code>。当返回 <code>false</code> 时，组件的更新过程停止，后续的 <code>render</code>、<code>componentDidUpdate</code> 也不会被调用。</p>
<p>**注意：**添加 <code>shouldComponentUpdate</code> 方法时，不建议使用深度相等检查（如使用 <code>JSON.stringify()</code>），因为深比较效率很低，可能会比重新渲染组件效率还低。而且该方法维护比较困难，建议使用该方法会产生明显的性能提升时使用。</p>
<h4 id="（2）getSnapshotBeforeUpdate"><a href="#（2）getSnapshotBeforeUpdate" class="headerlink" title="（2）getSnapshotBeforeUpdate"></a>（2）getSnapshotBeforeUpdate</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">getSnapshotBeforeUpdate</span>(prevProps, prevState)</span><br></pre></td></tr></table></figure>

<p>这个方法在 <code>render</code> 之后，<code>componentDidUpdate</code> 之前调用，有两个参数 <code>prevProps</code> 和 <code>prevState</code>，表示更新之前的 <code>props</code> 和 <code>state</code>，这个函数必须要和 <code>componentDidUpdate</code> 一起使用，并且要有一个返回值，默认是 <code>null</code>，这个返回值作为第三个参数传给 <code>componentDidUpdate</code>。</p>
<h4 id="（3）componentDidUpdate"><a href="#（3）componentDidUpdate" class="headerlink" title="（3）componentDidUpdate"></a>（3）componentDidUpdate</h4><p>componentDidUpdate() 会在更新后会被立即调用，首次渲染不会执行此方法。 该阶段通常进行以下操作：</p>
<ul>
<li>当组件更新后，对 DOM 进行操作； </li>
<li>如果你对更新前后的 props 进行了比较，也可以选择在此处进行网络请求；（例如，当 props 未发生变化时，则不会执行网络请求）。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">componentDidUpdate</span>(<span class="params">prevProps, prevState, snapshot</span>)&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>该方法有三个参数：</p>
<ul>
<li>prevProps: 更新前的props</li>
<li>prevState: 更新前的state</li>
<li>snapshot: getSnapshotBeforeUpdate()生命周期的返回值</li>
</ul>
<h3 id="3）组件卸载阶段"><a href="#3）组件卸载阶段" class="headerlink" title="3）组件卸载阶段"></a>3）组件卸载阶段</h3><p>卸载阶段只有一个生命周期函数，componentWillUnmount() 会在组件卸载及销毁之前直接调用。在此方法中执行必要的清理操作：</p>
<ul>
<li>清除 timer，取消网络请求或清除</li>
<li>取消在 componentDidMount() 中创建的订阅等；</li>
</ul>
<p>这个生命周期在一个组件被卸载和销毁之前被调用，因此你不应该再这个方法中使用 <code>setState</code>，因为组件一旦被卸载，就不会再装载，也就不会重新渲染。</p>
<h3 id="4）错误处理阶段"><a href="#4）错误处理阶段" class="headerlink" title="4）错误处理阶段"></a>4）错误处理阶段</h3><p>componentDidCatch(error, info)，此生命周期在后代组件抛出错误后被调用。 它接收两个参数∶</p>
<ul>
<li>error：抛出的错误。</li>
<li>info：带有 componentStack key 的对象，其中包含有关组件引发错误的栈信息</li>
</ul>
<p>React常见的生命周期如下：</p>
<p><img src="/../img/image222222.png" alt="img"></p>
<p><strong>React常见生命周期的过程大致如下：</strong></p>
<ul>
<li>挂载阶段，首先执行constructor构造方法，来创建组件</li>
<li>创建完成之后，就会执行render方法，该方法会返回需要渲染的内容</li>
<li>随后，React会将需要渲染的内容挂载到DOM树上</li>
<li><strong>挂载完成之后就会执行****componentDidMount生命周期函数</strong></li>
<li>如果我们给组件创建一个props（用于组件通信）、调用setState（更改state中的数据）、调用forceUpdate（强制更新组件）时，都会重新调用render函数</li>
<li>render函数重新执行之后，就会重新进行DOM树的挂载</li>
<li><strong>挂载完成之后就会执行****componentDidUpdate生命周期函数</strong></li>
<li><strong>当移除组件时，就会执行****componentWillUnmount生命周期函数</strong></li>
</ul>
<p><strong>React主要生命周期总结：</strong></p>
<ol>
<li><strong>getDefaultProps</strong>：这个函数会在组件创建之前被调用一次（有且仅有一次），它被用来初始化组件的 Props；</li>
<li><strong>getInitialState</strong>：用于初始化组件的 state 值；</li>
<li><strong>componentWillMount</strong>：在组件创建后、render 之前，会走到 componentWillMount 阶段。这个阶段我个人一直没用过、非常鸡肋。后来React 官方已经不推荐大家在 componentWillMount 里做任何事情、到现在 <strong>React16 直接废弃了这个生命周期</strong>，足见其鸡肋程度了；</li>
<li><strong>render</strong>：这是所有生命周期中唯一一个你必须要实现的方法。一般来说需要返回一个 jsx 元素，这时 React 会根据 props 和 state 来把组件渲染到界面上；不过有时，你可能不想渲染任何东西，这种情况下让它返回 null 或者 false 即可；</li>
<li><strong>componentDidMount</strong>：会在组件挂载后（插入 DOM 树中后）立即调用，标志着组件挂载完成。一些操作如果依赖获取到 DOM 节点信息，我们就会放在这个阶段来做。此外，这还是 React 官方推荐的发起 ajax 请求的时机。该方法和 componentWillMount 一样，有且仅有一次调用。</li>
</ol>
<h1 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h1><h2 id="基本原理"><a href="#基本原理" class="headerlink" title="基本原理"></a>基本原理</h2><p><img src="/../img/image-20240225215635333.png" alt="image-20240225215635333"></p>
<h2 id="如何使用"><a href="#如何使用" class="headerlink" title="如何使用"></a>如何使用</h2><h3 id="createStore"><a href="#createStore" class="headerlink" title="createStore"></a>createStore</h3><p><code>createStore</code> 函数通常是用于创建 Redux store 的函数。Redux 是一个用于管理 JavaScript 应用程序状态的流行库。让我们来解析 <code>createStore</code> 函数的一般结构和作用：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">createStore</span>(<span class="params">reducer, preloadedState, enhancer</span>) &#123;</span><br><span class="line">  <span class="comment">// 内部状态 state</span></span><br><span class="line">  <span class="keyword">let</span> currentState = preloadedState;</span><br><span class="line">  <span class="comment">// 内部订阅者列表</span></span><br><span class="line">  <span class="keyword">let</span> currentListeners = [];</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 获取当前状态</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">getState</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> currentState;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 修改状态的唯一方式，通过派发 action</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">dispatch</span>(<span class="params">action</span>) &#123;</span><br><span class="line">    <span class="comment">// 调用 reducer 来获取新的状态</span></span><br><span class="line">    currentState = <span class="title function_">reducer</span>(currentState, action);</span><br><span class="line">    <span class="comment">// 触发所有订阅者</span></span><br><span class="line">    currentListeners.<span class="title function_">forEach</span>(<span class="function"><span class="params">listener</span> =&gt;</span> <span class="title function_">listener</span>());</span><br><span class="line">    <span class="keyword">return</span> action;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 订阅状态的变化，每当状态变化时执行回调函数</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">subscribe</span>(<span class="params">listener</span>) &#123;</span><br><span class="line">    <span class="comment">// 将传入的回调函数加入到订阅者列表中</span></span><br><span class="line">    currentListeners.<span class="title function_">push</span>(listener);</span><br><span class="line">    <span class="comment">// 返回一个取消订阅的函数</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">unsubscribe</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="comment">// 将该回调函数从订阅者列表中移除</span></span><br><span class="line">      <span class="keyword">const</span> index = currentListeners.<span class="title function_">indexOf</span>(listener);</span><br><span class="line">      currentListeners.<span class="title function_">splice</span>(index, <span class="number">1</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 替换 reducer 的函数，用于动态地改变 reducer</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">replaceReducer</span>(<span class="params">nextReducer</span>) &#123;</span><br><span class="line">    reducer = nextReducer;</span><br><span class="line">    <span class="comment">// 调用 dispatch 一个内置的动作，以便更新状态</span></span><br><span class="line">    <span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;@@redux/INIT&#x27;</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 初始化 store，调用 reducer 以获取初始状态，并返回一个 store 对象</span></span><br><span class="line">  <span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;@@redux/INIT&#x27;</span> &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 返回 store 对象，包含 getState、dispatch、subscribe 和 replaceReducer 方法</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    dispatch,</span><br><span class="line">    subscribe,</span><br><span class="line">    getState,</span><br><span class="line">    replaceReducer</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>现在让我来解释一下 <code>createStore</code> 函数的各个部分：</p>
<ol>
<li><p><strong>参数</strong>：</p>
<p>​    在 <code>createStore</code> 函数中涉及到的核心数据类型主要有以下几种：</p>
<ol>
<li><strong>reducer</strong>：<code>reducer</code> 是一个函数，接收当前状态 (<code>state</code>) 和一个动作 (<code>action</code>)，并返回一个新的状态。它是一个纯函数，通常是通过 <code>switch</code> 语句来根据不同的动作类型进行状态更新的。动作类型通常是一个字符串，表示对状态进行何种操作，例如 <code>&#39;INCREMENT&#39;</code>、<code>&#39;DECREMENT&#39;</code> 等。</li>
<li><strong>preloadedState</strong>：<code>preloadedState</code> 是一个 JavaScript 对象，表示应用程序的初始状态。它是可选的，如果不提供则状态将被初始化为 <code>undefined</code>，然后在调用 <code>reducer</code> 时被设置为 <code>reducer</code> 函数的默认值。</li>
<li><strong>currentState</strong>：<code>currentState</code> 是一个变量，用于存储当前的应用程序状态。它会随着动作的派发而改变，通过调用 <code>reducer</code> 函数计算出新的状态。</li>
<li><strong>currentListeners</strong>：<code>currentListeners</code> 是一个数组，用于存储所有订阅状态变化的回调函数。每当状态发生变化时，这些回调函数将会被依次调用。</li>
<li><strong>action</strong>：<code>action</code> 是一个普通的 JavaScript 对象，必须包含一个 <code>type</code> 字段，表示动作的类型。除了 <code>type</code> 字段之外，<code>action</code> 对象可以包含其他字段，用于传递数据给 <code>reducer</code> 函数。</li>
<li><strong>store</strong>：<code>store</code> 是一个对象，包含了 <code>dispatch</code>、<code>subscribe</code>、<code>getState</code> 和 <code>replaceReducer</code> 方法。它是整个 Redux 应用程序的核心，用于管理状态的变化和订阅状态变化。</li>
</ol>
<p>​    7.<code>enhancer</code> (可选): 一个函数，用于增强 <code>store</code> 的功能，例如中间件等。</p>
</li>
<li><p><strong>内部变量</strong>：</p>
<ul>
<li><code>currentState</code>: 存储当前状态的变量。</li>
<li><code>currentListeners</code>: 一个数组，包含当前订阅状态变化的所有回调函数。</li>
</ul>
</li>
<li><p><strong>方法</strong>：</p>
<ul>
<li><code>getState()</code>: 返回当前存储的状态。</li>
<li><code>dispatch(action)</code>: 接收一个动作并触发状态变化。它通过调用 reducer 函数来计算新的状态，并通知所有的订阅者。</li>
<li><code>subscribe(listener)</code>: 接收一个回调函数作为参数，每当状态发生变化时就会调用该回调函数。</li>
<li><code>replaceReducer(nextReducer)</code>: 用于动态替换 reducer 函数。</li>
</ul>
</li>
<li><p><strong>初始化</strong>：</p>
<ul>
<li>在初始化过程中，会调用 <code>dispatch(&#123; type: &#39;@@redux/INIT&#39; &#125;)</code> 来获取初始状态。</li>
</ul>
</li>
<li><p><strong>返回值</strong>：</p>
<ul>
<li>返回一个包含 <code>dispatch</code>、<code>subscribe</code>、<code>getState</code> 和 <code>replaceReducer</code> 方法的对象，也就是 Redux 的 <code>store</code>。</li>
</ul>
</li>
</ol>
<p>PS:<code>redux</code> 发布 <code>4.2.0</code> 版本，该版本将原始 <code>createStore API</code> 标记为 <code>@deprecated</code>(废弃)，并且添加了一个全新的 <code>legacy_createStore API</code>，但是并没有添加弃用警告。</p>
<h3 id="对-Redux-的理解，主要解决什么问题"><a href="#对-Redux-的理解，主要解决什么问题" class="headerlink" title="对 Redux 的理解，主要解决什么问题"></a>对 Redux 的理解，主要解决什么问题</h3><p>React是视图层框架。Redux是一个用来管理数据状态和UI状态的JavaScript应用工具。随着JavaScript单页应用（SPA）开发日趋复杂， JavaScript需要管理比任何时候都要多的state（状态）， Redux就是降低管理难度的。（Redux支持React、Angular、jQuery甚至纯JavaScript）。</p>
<p>在 React 中，UI 以组件的形式来搭建，组件之间可以嵌套组合。但 React 中组件间通信的数据流是单向的，顶层组件可以通过 props 属性向下层组件传递数据，而下层组件不能向上层组件传递数据，兄弟组件之间同样不能。这样简单的单向数据流支撑起了 React 中的数据可控性。</p>
<p>当项目越来越大的时候，管理数据的事件或回调函数将越来越多，也将越来越不好管理。管理不断变化的 state 非常困难。如果一个 model 的变化会引起另一个 model 变化，那么当 view 变化时，就可能引起对应 model 以及另一个 model 的变化，依次地，可能会引起另一个 view 的变化。直至你搞不清楚到底发生了什么。state 在什么时候，由于什么原因，如何变化已然不受控制。 当系统变得错综复杂的时候，想重现问题或者添加新功能就会变得举步维艰。如果这还不够糟糕，考虑一些来自前端开发领域的新需求，如更新调优、服务端渲染、路由跳转前请求数据等。state 的管理在大项目中相当复杂。</p>
<p>Redux 提供了一个叫 store 的统一仓储库，组件通过 dispatch 将 state 直接传入store，不用通过其他的组件。并且组件通过 subscribe 从 store获取到 state 的改变。使用了 Redux，所有的组件都可以从 store 中获取到所需的 state，他们也能从store 获取到 state 的改变。这比组件之间互相传递数据清晰明朗的多。</p>
<p><strong>主要解决的问题：</strong></p>
<p>单纯的Redux只是一个状态机，是没有UI呈现的，react- redux作用是将Redux的状态机和React的UI呈现绑定在一起，当你dispatch action改变state的时候，会自动更新页面。</p>
<h3 id="2-Redux-原理及工作流程"><a href="#2-Redux-原理及工作流程" class="headerlink" title="2. Redux 原理及工作流程"></a>2. Redux 原理及工作流程</h3><p><strong>（1）原理</strong></p>
<p>Redux源码主要分为以下几个模块文件</p>
<ul>
<li>compose.js 提供从右到左进行函数式编程</li>
<li>createStore.js 提供作为生成唯一store的函数</li>
<li>combineReducers.js 提供合并多个reducer的函数，保证store的唯一性</li>
<li>bindActionCreators.js 可以让开发者在不直接接触dispacth的前提下进行更改state的操作</li>
<li>applyMiddleware.js 这个方法通过中间件来增强dispatch的功能</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> actionTypes = &#123;</span><br><span class="line">    <span class="attr">ADD</span>: <span class="string">&#x27;ADD&#x27;</span>,</span><br><span class="line">    <span class="attr">CHANGEINFO</span>: <span class="string">&#x27;CHANGEINFO&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initState = &#123;</span><br><span class="line">    <span class="attr">info</span>: <span class="string">&#x27;初始化&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">initReducer</span>(<span class="params">state=initState, action</span>) &#123;</span><br><span class="line">    <span class="keyword">switch</span>(action.<span class="property">type</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> actionTypes.<span class="property">CHANGEINFO</span>:</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                ...state,</span><br><span class="line">                <span class="attr">info</span>: action.<span class="property">preload</span>.<span class="property">info</span> || <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="attr">default</span>:</span><br><span class="line">            <span class="keyword">return</span> &#123; ...state &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">createStore</span>(<span class="params">reducer, initialState, middleFunc</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (initialState &amp;&amp; <span class="keyword">typeof</span> initialState === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">        middleFunc = initialState;</span><br><span class="line">        initialState = <span class="literal">undefined</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> currentState = initialState;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> listeners = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (middleFunc &amp;&amp; <span class="keyword">typeof</span> middleFunc === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">        <span class="comment">// 封装dispatch </span></span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">middleFunc</span>(createStore)(reducer, initialState);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">getState</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> currentState;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">dispatch</span> = (<span class="params">action</span>) =&gt; &#123;</span><br><span class="line">        currentState = <span class="title function_">reducer</span>(currentState, action);</span><br><span class="line"></span><br><span class="line">        listeners.<span class="title function_">forEach</span>(<span class="function"><span class="params">listener</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">listener</span>();</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">subscribe</span> = (<span class="params">listener</span>) =&gt; &#123;</span><br><span class="line">        listeners.<span class="title function_">push</span>(listener);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        getState,</span><br><span class="line">        dispatch,</span><br><span class="line">        subscribe</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>（2）工作流程</strong></p>
<ul>
<li>const store&#x3D; createStore（fn）生成数据; </li>
<li>action: {type: Symble(‘action01), payload:’payload’ }定义行为; </li>
<li>dispatch发起action：store.dispatch(doSomething(‘action001’)); </li>
<li>reducer：处理action，返回新的state;</li>
</ul>
<p>通俗点解释：</p>
<ul>
<li>首先，用户（通过View）发出Action，发出方式就用到了dispatch方法</li>
<li>然后，Store自动调用Reducer，并且传入两个参数：当前State和收到的Action，Reducer会返回新的State</li>
<li>State—旦有变化，Store就会调用监听函数，来更新View</li>
</ul>
<p>以 store 为核心，可以把它看成数据存储中心，但是他要更改数据的时候不能直接修改，数据修改更新的角色由Reducers来担任，store只做存储，中间人，当Reducers的更新完成以后会通过store的订阅来通知react component，组件把新的状态重新获取渲染，组件中也能主动发送action，创建action后这个动作是不会执行的，所以要dispatch这个action，让store通过reducers去做更新React Component 就是react的每个组件。</p>
<h3 id="3-Redux-中异步的请求怎么处理"><a href="#3-Redux-中异步的请求怎么处理" class="headerlink" title="3. Redux 中异步的请求怎么处理"></a>3. Redux 中异步的请求怎么处理</h3><p>可以在 componentDidmount 中直接进⾏请求⽆须借助redux。但是在⼀定规模的项⽬中,上述⽅法很难进⾏异步流的管理,通常情况下我们会借助redux的异步中间件进⾏异步处理。redux异步流中间件其实有很多，当下主流的异步中间件有两种redux-thunk、redux-saga。</p>
<p><strong>（1）使用react-thunk中间件</strong></p>
<p><strong>redux-thunk</strong>优点**:** </p>
<ul>
<li>体积⼩: redux-thunk的实现⽅式很简单,只有不到20⾏代码 </li>
<li>使⽤简单: redux-thunk没有引⼊像redux-saga或者redux-observable额外的范式,上⼿简单</li>
</ul>
<p><strong>redux-thunk</strong>缺陷**:** </p>
<ul>
<li>样板代码过多: 与redux本身⼀样,通常⼀个请求需要⼤量的代码,⽽且很多都是重复性质的 </li>
<li>耦合严重: 异步操作与redux的action偶合在⼀起,不⽅便管理 </li>
<li>功能孱弱: 有⼀些实际开发中常⽤的功能需要⾃⼰进⾏封装</li>
</ul>
<p>使用步骤：</p>
<ul>
<li>配置中间件，在store的创建中配置</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createStore, applyMiddleware, compose&#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">&#x27;./reducer&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> thunk <span class="keyword">from</span> <span class="string">&#x27;redux-thunk&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置调试工具</span></span><br><span class="line"><span class="keyword">const</span> composeEnhancers = <span class="variable language_">window</span>.<span class="property">__REDUX_DEVTOOLS_EXTENSION_COMPOSE__</span> ? <span class="variable language_">window</span>.<span class="title function_">__REDUX_DEVTOOLS_EXTENSION_COMPOSE__</span>(&#123;&#125;) : compose;</span><br><span class="line"><span class="comment">// 设置中间件</span></span><br><span class="line"><span class="keyword">const</span> enhancer = <span class="title function_">composeEnhancers</span>(</span><br><span class="line">  <span class="title function_">applyMiddleware</span>(thunk)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(reducer, enhancer);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></table></figure>

<ul>
<li>添加一个返回函数的actionCreator，将异步请求逻辑放在里面</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  发送get请求，并生成相应action，更新store的函数</span></span><br><span class="line"><span class="comment">  <span class="doctag">@param</span> url &#123;string&#125; 请求地址</span></span><br><span class="line"><span class="comment">  <span class="doctag">@param</span> func &#123;function&#125; 真正需要生成的action对应的actionCreator</span></span><br><span class="line"><span class="comment">  <span class="doctag">@return</span> &#123;<span class="type">function</span>&#125; </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// dispatch为自动接收的store.dispatch函数 </span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getHttpAction</span> = (<span class="params">url, func</span>) =&gt; <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</span><br><span class="line">    axios.<span class="title function_">get</span>(url).<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">res</span>)&#123;</span><br><span class="line">        <span class="keyword">const</span> action = <span class="title function_">func</span>(res.<span class="property">data</span>)</span><br><span class="line">        <span class="title function_">dispatch</span>(action)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>生成action，并发送action</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">componentDidMount</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> action = <span class="title function_">getHttpAction</span>(<span class="string">&#x27;/getData&#x27;</span>, getInitTodoItemAction)</span><br><span class="line">    <span class="comment">// 发送函数类型的action时，该action的函数体会自动执行</span></span><br><span class="line">    store.<span class="title function_">dispatch</span>(action)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>（2）使用redux-saga中间件</strong></p>
<p><strong>redux-saga</strong>优点**:** </p>
<ul>
<li>异步解耦: 异步操作被被转移到单独 saga.js 中，不再是掺杂在 action.js 或 component.js 中 </li>
<li>action摆脱thunk function: dispatch 的参数依然是⼀个纯粹的 action (FSA)，⽽不是充满 “⿊魔法” thunk function </li>
<li>异常处理: 受益于 generator function 的 saga 实现，代码异常&#x2F;请求失败 都可以直接通过 try&#x2F;catch 语法直接捕获处理</li>
<li>功能强⼤: redux-saga提供了⼤量的Saga 辅助函数和Effect 创建器供开发者使⽤,开发者⽆须封装或者简单封装即可使⽤ </li>
<li>灵活: redux-saga可以将多个Saga可以串⾏&#x2F;并⾏组合起来,形成⼀个⾮常实⽤的异步flow </li>
<li>易测试，提供了各种case的测试⽅案，包括mock task，分⽀覆盖等等</li>
</ul>
<p><strong>redux-saga</strong>缺陷**:** </p>
<ul>
<li>额外的学习成本: redux-saga不仅在使⽤难以理解的 generator function,⽽且有数⼗个API,学习成本远超redux-thunk,最重要的是你的额外学习成本是只服务于这个库的,与redux-observable不同,redux-observable虽然也有额外学习成本但是背后是rxjs和⼀整套思想 </li>
<li>体积庞⼤: 体积略⼤,代码近2000⾏，min版25KB左右 </li>
<li>功能过剩: 实际上并发控制等功能很难⽤到,但是我们依然需要引⼊这些代码 </li>
<li>ts⽀持不友好: yield⽆法返回TS类型</li>
</ul>
<p>redux-saga可以捕获action，然后执行一个函数，那么可以把异步代码放在这个函数中，使用步骤如下：</p>
<ul>
<li>配置中间件</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createStore, applyMiddleware, compose&#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">&#x27;./reducer&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> createSagaMiddleware <span class="keyword">from</span> <span class="string">&#x27;redux-saga&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">TodoListSaga</span> <span class="keyword">from</span> <span class="string">&#x27;./sagas&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> composeEnhancers = <span class="variable language_">window</span>.<span class="property">__REDUX_DEVTOOLS_EXTENSION_COMPOSE__</span> ? <span class="variable language_">window</span>.<span class="title function_">__REDUX_DEVTOOLS_EXTENSION_COMPOSE__</span>(&#123;&#125;) : compose;</span><br><span class="line"><span class="keyword">const</span> sagaMiddleware = <span class="title function_">createSagaMiddleware</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> enhancer = <span class="title function_">composeEnhancers</span>(</span><br><span class="line">  <span class="title function_">applyMiddleware</span>(sagaMiddleware)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(reducer, enhancer);</span><br><span class="line">sagaMiddleware.<span class="title function_">run</span>(<span class="title class_">TodoListSaga</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></table></figure>

<ul>
<li>将异步请求放在sagas.js中</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;takeEvery, put&#125; <span class="keyword">from</span> <span class="string">&#x27;redux-saga/effects&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;initTodoList&#125; <span class="keyword">from</span> <span class="string">&#x27;./actionCreator&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="variable constant_">GET_INIT_ITEM</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;./actionTypes&#x27;</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span>* <span class="title function_">func</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="comment">// 可以获取异步返回数据</span></span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">yield</span> axios.<span class="title function_">get</span>(<span class="string">&#x27;/getData&#x27;</span>)</span><br><span class="line">        <span class="keyword">const</span> action = <span class="title function_">initTodoList</span>(res.<span class="property">data</span>)</span><br><span class="line">        <span class="comment">// 将action发送到reducer</span></span><br><span class="line">        <span class="keyword">yield</span> <span class="title function_">put</span>(action)</span><br><span class="line">    &#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;网络请求失败&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span>* <span class="title function_">mySaga</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">// 自动捕获GET_INIT_ITEM类型的action，并执行func</span></span><br><span class="line">    <span class="keyword">yield</span> <span class="title function_">takeEvery</span>(<span class="variable constant_">GET_INIT_ITEM</span>, func)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> mySaga</span><br></pre></td></tr></table></figure>

<ul>
<li>发送action</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">componentDidMount</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">const</span> action = <span class="title function_">getInitTodoItemAction</span>()</span><br><span class="line">  store.<span class="title function_">dispatch</span>(action)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-Redux-怎么实现属性传递，介绍下原理"><a href="#4-Redux-怎么实现属性传递，介绍下原理" class="headerlink" title="4. Redux 怎么实现属性传递，介绍下原理"></a>4. Redux 怎么实现属性传递，介绍下原理</h3><p>react-redux 数据传输∶ view–&gt;action–&gt;reducer–&gt;store–&gt;view。看下点击事件的数据是如何通过redux传到view上：</p>
<ul>
<li>view 上的AddClick 事件通过mapDispatchToProps 把数据传到action —&gt; click:()&#x3D;&gt;dispatch(ADD)</li>
<li>action 的ADD 传到reducer上</li>
<li>reducer传到store上 const store &#x3D; createStore(reducer);</li>
<li>store再通过 mapStateToProps 映射穿到view上text:State.text</li>
</ul>
<p>代码示例∶</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Provider</span>, connect &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span>;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span>&#123;</span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> &#123; text, click, clickR &#125; = <span class="variable language_">this</span>.<span class="property">props</span>;</span><br><span class="line">        <span class="keyword">return</span>(</span><br><span class="line">            <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span>&gt;</span>数据:已有人&#123;text&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">onClick</span>=<span class="string">&#123;click&#125;</span>&gt;</span>加人<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">onClick</span>=<span class="string">&#123;clickR&#125;</span>&gt;</span>减人<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> initialState = &#123;</span><br><span class="line">    <span class="attr">text</span>:<span class="number">5</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> reducer = <span class="keyword">function</span>(<span class="params">state,action</span>)&#123;</span><br><span class="line">    <span class="keyword">switch</span>(action.<span class="property">type</span>)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;ADD&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="attr">text</span>:state.<span class="property">text</span>+<span class="number">1</span>&#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;REMOVE&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="attr">text</span>:state.<span class="property">text</span>-<span class="number">1</span>&#125;</span><br><span class="line">        <span class="attr">default</span>:</span><br><span class="line">            <span class="keyword">return</span> initialState;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="variable constant_">ADD</span> = &#123;</span><br><span class="line">    <span class="attr">type</span>:<span class="string">&#x27;ADD&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="title class_">Remove</span> = &#123;</span><br><span class="line">    <span class="attr">type</span>:<span class="string">&#x27;REMOVE&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(reducer);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> mapStateToProps = <span class="keyword">function</span> (<span class="params">state</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span>&#123;</span><br><span class="line">        <span class="attr">text</span>:state.<span class="property">text</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> mapDispatchToProps = <span class="keyword">function</span>(<span class="params">dispatch</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span>&#123;</span><br><span class="line">        <span class="attr">click</span>:<span class="function">()=&gt;</span><span class="title function_">dispatch</span>(<span class="variable constant_">ADD</span>),</span><br><span class="line">        <span class="attr">clickR</span>:<span class="function">()=&gt;</span><span class="title function_">dispatch</span>(<span class="title class_">Remove</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App1</span> = <span class="title function_">connect</span>(mapStateToProps,mapDispatchToProps)(<span class="title class_">App</span>);</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span> = <span class="string">&#123;store&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">App1</span>&gt;</span><span class="tag">&lt;/<span class="name">App1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span>,<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h3 id="5-Redux-中间件是什么？接受几个参数？柯里化函数两端的参数具体是什么？"><a href="#5-Redux-中间件是什么？接受几个参数？柯里化函数两端的参数具体是什么？" class="headerlink" title="5. Redux 中间件是什么？接受几个参数？柯里化函数两端的参数具体是什么？"></a>5. Redux 中间件是什么？接受几个参数？柯里化函数两端的参数具体是什么？</h3><p>Redux 的中间件提供的是位于 action 被发起之后，到达 reducer 之前的扩展点，换而言之，原本 view -→&gt; action -&gt; reducer -&gt; store 的数据流加上中间件后变成了 view -&gt; action -&gt; middleware -&gt; reducer -&gt; store ，在这一环节可以做一些”副作用”的操作，如异步请求、打印日志等。</p>
<p>applyMiddleware源码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">applyMiddleware</span>(<span class="params">...middlewares</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">createStore</span> =&gt;</span> <span class="function">(<span class="params">...args</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 利用传入的createStore和reducer和创建一个store</span></span><br><span class="line">        <span class="keyword">const</span> store = <span class="title function_">createStore</span>(...args)</span><br><span class="line">        <span class="keyword">let</span> <span class="title function_">dispatch</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> middlewareAPI = &#123;</span><br><span class="line">            <span class="attr">getState</span>: store.<span class="property">getState</span>,</span><br><span class="line">            <span class="attr">dispatch</span>: <span class="function">(<span class="params">...args</span>) =&gt;</span> <span class="title function_">dispatch</span>(...args)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 让每个 middleware 带着 middlewareAPI 这个参数分别执行一遍</span></span><br><span class="line">        <span class="keyword">const</span> chain = middlewares.<span class="title function_">map</span>(<span class="function"><span class="params">middleware</span> =&gt;</span> <span class="title function_">middleware</span>(middlewareAPI))</span><br><span class="line">        <span class="comment">// 接着 compose 将 chain 中的所有匿名函数，组装成一个新的函数，即新的 dispatch</span></span><br><span class="line">        dispatch = <span class="title function_">compose</span>(...chain)(store.<span class="property">dispatch</span>)</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            ...store,</span><br><span class="line">            dispatch</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>从applyMiddleware中可以看出∶</p>
<ul>
<li>redux中间件接受一个对象作为参数，对象的参数上有两个字段 dispatch 和 getState，分别代表着 Redux Store 上的两个同名函数。</li>
<li>柯里化函数两端一个是 middewares，一个是store.dispatch</li>
</ul>
<h3 id="6-Redux-请求中间件如何处理并发"><a href="#6-Redux-请求中间件如何处理并发" class="headerlink" title="6. Redux 请求中间件如何处理并发"></a>6. Redux 请求中间件如何处理并发</h3><p><strong>使用redux-Saga</strong></p>
<p>redux-saga是一个管理redux应用异步操作的中间件，用于代替 redux-thunk 的。它通过创建 Sagas 将所有异步操作逻辑存放在一个地方进行集中处理，以此将react中的同步操作与异步操作区分开来，以便于后期的管理与维护。 redux-saga如何处理并发：</p>
<ul>
<li><strong>takeEvery</strong></li>
</ul>
<p>可以让多个 saga 任务并行被 fork 执行。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">    fork,</span><br><span class="line">    take</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;redux-saga/effects&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">takeEvery</span> = (<span class="params">pattern, saga, ...args</span>) =&gt; <span class="title function_">fork</span>(<span class="keyword">function</span>*() &#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> action = <span class="keyword">yield</span> <span class="title function_">take</span>(pattern)</span><br><span class="line">        <span class="keyword">yield</span> <span class="title function_">fork</span>(saga, ...args.<span class="title function_">concat</span>(action))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>takeLatest</strong></li>
</ul>
<p>takeLatest 不允许多个 saga 任务并行地执行。一旦接收到新的发起的 action，它就会取消前面所有 fork 过的任务（如果这些任务还在执行的话）。</p>
<p>在处理 AJAX 请求的时候，如果只希望获取最后那个请求的响应， takeLatest 就会非常有用。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">    cancel,</span><br><span class="line">    fork,</span><br><span class="line">    take</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;redux-saga/effects&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">takeLatest</span> = (<span class="params">pattern, saga, ...args</span>) =&gt; <span class="title function_">fork</span>(<span class="keyword">function</span>*() &#123;</span><br><span class="line">    <span class="keyword">let</span> lastTask</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> action = <span class="keyword">yield</span> <span class="title function_">take</span>(pattern)</span><br><span class="line">        <span class="keyword">if</span> (lastTask) &#123;</span><br><span class="line">            <span class="keyword">yield</span> <span class="title function_">cancel</span>(lastTask) <span class="comment">// 如果任务已经结束，则 cancel 为空操作</span></span><br><span class="line">        &#125;</span><br><span class="line">        lastTask = <span class="keyword">yield</span> <span class="title function_">fork</span>(saga, ...args.<span class="title function_">concat</span>(action))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="7-Redux-状态管理器和变量挂载到-window-中有什么区别"><a href="#7-Redux-状态管理器和变量挂载到-window-中有什么区别" class="headerlink" title="7. Redux 状态管理器和变量挂载到 window 中有什么区别"></a>7. Redux 状态管理器和变量挂载到 window 中有什么区别</h3><p>两者都是存储数据以供后期使用。但是Redux状态更改可回溯——Time travel，数据多了的时候可以很清晰的知道改动在哪里发生，完整的提供了一套状态管理模式。</p>
<p>随着 JavaScript 单页应用开发日趋复杂，JavaScript 需要管理比任何时候都要多的 state （状态）。 这些 state 可能包括服务器响应、缓存数据、本地生成尚未持久化到服务器的数据，也包括 UI状态，如激活的路由，被选中的标签，是否显示加载动效或者分页器等等。</p>
<p>管理不断变化的 state 非常困难。如果一个 model 的变化会引起另一个 model 变化，那么当 view 变化时，就可能引起对应 model 以及另一个model 的变化，依次地，可能会引起另一个 view 的变化。直至你搞不清楚到底发生了什么。state 在什么时候，由于什么原因，如何变化已然不受控制。 当系统变得错综复杂的时候，想重现问题或者添加新功能就会变得举步维艰。</p>
<p>如果这还不够糟糕，考虑一些来自前端开发领域的新需求，如更新调优、服务端渲染、路由跳转前请求数据等等。前端开发者正在经受前所未有的复杂性，难道就这么放弃了吗?当然不是。</p>
<p>这里的复杂性很大程度上来自于：我们总是将两个难以理清的概念混淆在一起：变化和异步。 可以称它们为曼妥思和可乐。如果把二者分开，能做的很好，但混到一起，就变得一团糟。一些库如 React 视图在视图层禁止异步和直接操作 DOM来解决这个问题。美中不足的是，React 依旧把处理 state 中数据的问题留给了你。Redux就是为了帮你解决这个问题。</p>
<h3 id="8-mobox-和-redux-有什么区别？"><a href="#8-mobox-和-redux-有什么区别？" class="headerlink" title="8. mobox 和 redux 有什么区别？"></a>8. mobox 和 redux 有什么区别？</h3><p><strong>（1）共同点</strong></p>
<ul>
<li>为了解决状态管理混乱，无法有效同步的问题统一维护管理应用状态;</li>
<li>某一状态只有一个可信数据来源（通常命名为store，指状态容器）;</li>
<li>操作更新状态方式统一，并且可控（通常以action方式提供更新状态的途径）;</li>
<li>支持将store与React组件连接，如react-redux，mobx- react;</li>
</ul>
<p><strong>（2）区别</strong></p>
<p>Redux更多的是遵循Flux模式的一种实现，是一个 JavaScript库，它关注点主要是以下几方面∶ </p>
<ul>
<li>Action∶ 一个JavaScript对象，描述动作相关信息，主要包含type属性和payload属性∶</li>
</ul>
<p>​         o type∶ action 类型; </p>
<p>​         o payload∶ 负载数据;</p>
<ul>
<li>Reducer∶ 定义应用状态如何响应不同动作（action），如何更新状态;</li>
<li>Store∶ 管理action和reducer及其关系的对象，主要提供以下功能∶</li>
</ul>
<p>​         o 维护应用状态并支持访问状态(getState());</p>
<p>​         o 支持监听action的分发，更新状态(dispatch(action)); </p>
<p>​         o 支持订阅store的变更(subscribe(listener));</p>
<ul>
<li>异步流∶ 由于Redux所有对store状态的变更，都应该通过action触发，异步任务（通常都是业务或获取数据任务）也不例外，而为了不将业务或数据相关的任务混入React组件中，就需要使用其他框架配合管理异步任务流程，如redux-thunk，redux-saga等;</li>
</ul>
<p>Mobx是一个透明函数响应式编程的状态管理库，它使得状态管理简单可伸缩∶</p>
<ul>
<li>Action∶定义改变状态的动作函数，包括如何变更状态;</li>
<li>Store∶ 集中管理模块状态（State）和动作(action)</li>
<li>Derivation（衍生）∶ 从应用状态中派生而出，且没有任何其他影响的数据</li>
</ul>
<p><strong>对比总结：</strong></p>
<ul>
<li>redux将数据保存在单一的store中，mobx将数据保存在分散的多个store中</li>
<li>redux使用plain object保存数据，需要手动处理变化后的操作;mobx适用observable保存数据，数据变化后自动处理响应的操作</li>
<li>redux使用不可变状态，这意味着状态是只读的，不能直接去修改它，而是应该返回一个新的状态，同时使用纯函数;mobx中的状态是可变的，可以直接对其进行修改</li>
<li>mobx相对来说比较简单，在其中有很多的抽象，mobx更多的使用面向对象的编程思维;redux会比较复杂，因为其中的函数式编程思想掌握起来不是那么容易，同时需要借助一系列的中间件来处理异步和副作用</li>
<li>mobx中有更多的抽象和封装，调试会比较困难，同时结果也难以预测;而redux提供能够进行时间回溯的开发工具，同时其纯函数以及更少的抽象，让调试变得更加的容易</li>
</ul>
<h3 id="9-Redux-和-Vuex-有什么区别，它们的共同思想"><a href="#9-Redux-和-Vuex-有什么区别，它们的共同思想" class="headerlink" title="9. Redux 和 Vuex 有什么区别，它们的共同思想"></a>9. Redux 和 Vuex 有什么区别，它们的共同思想</h3><p><strong>（1）Redux 和 Vuex区别</strong></p>
<ul>
<li>Vuex改进了Redux中的Action和Reducer函数，以mutations变化函数取代Reducer，无需switch，只需在对应的mutation函数里改变state值即可</li>
<li>Vuex由于Vue自动重新渲染的特性，无需订阅重新渲染函数，只要生成新的State即可</li>
<li>Vuex数据流的顺序是∶View调用store.commit提交对应的请求到Store中对应的mutation函数-&gt;store改变（vue检测到数据变化自动渲染）</li>
</ul>
<p>通俗点理解就是，vuex 弱化 dispatch，通过commit进行 store状态的一次更变；取消了action概念，不必传入特定的 action形式进行指定变更；弱化reducer，基于commit参数直接对数据进行转变，使得框架更加简易; </p>
<p><strong>（2）共同思想</strong></p>
<ul>
<li>单—的数据源 </li>
<li>变化可以预测</li>
</ul>
<p>本质上∶ redux与vuex都是对mvvm思想的服务，将数据从视图中抽离的一种方案。</p>
<h3 id="10-Redux-中间件是怎么拿到store-和-action-然后怎么处理"><a href="#10-Redux-中间件是怎么拿到store-和-action-然后怎么处理" class="headerlink" title="10. Redux 中间件是怎么拿到store 和 action? 然后怎么处理?"></a>10. Redux 中间件是怎么拿到store 和 action? 然后怎么处理?</h3><p>redux中间件本质就是一个函数柯里化。redux applyMiddleware Api 源码中每个middleware 接受2个参数， Store 的getState 函数和dispatch 函数，分别获得store和action，最终返回一个函数。该函数会被传入 next 的下一个 middleware 的 dispatch 方法，并返回一个接收 action 的新函数，这个函数可以直接调用 next（action），或者在其他需要的时刻调用，甚至根本不去调用它。调用链中最后一个 middleware 会接受真实的 store的 dispatch 方法作为 next 参数，并借此结束调用链。所以，middleware 的函数签名是（{ getState，dispatch })&#x3D;&gt; next &#x3D;&gt; action。</p>
<h3 id="11-Redux中的connect有什么作用"><a href="#11-Redux中的connect有什么作用" class="headerlink" title="11. Redux中的connect有什么作用"></a>11. Redux中的connect有什么作用</h3><p>connect负责连接React和Redux</p>
<p><strong>（1）获取state</strong></p>
<p>connect 通过 context获取 Provider 中的 store，通过<code> store.getState()</code> 获取整个store tree 上所有state </p>
<p><strong>（2）包装原组件</strong></p>
<p>将state和action通过props的方式传入到原组件内部 wrapWithConnect 返回—个 ReactComponent 对 象 Connect，Connect 重 新 render 外部传入的原组件 WrappedComponent ，并把 connect 中传入的 mapStateToProps，mapDispatchToProps与组件上原有的 props合并后，通过属性的方式传给WrappedComponent </p>
<p><strong>（3）监听store tree变化</strong></p>
<p>connect缓存了store tree中state的状态，通过当前state状态 和变更前 state 状态进行比较，从而确定是否调用 <code>this.setState()</code>方法触发Connect及其子组件的重新渲染</p>
<h1 id="React-Hooks"><a href="#React-Hooks" class="headerlink" title="React Hooks"></a>React Hooks</h1><p>React Hooks 主要解决了以下问题：</p>
<p><strong>（1）在组件之间复用状态逻辑很难</strong></p>
<p>React 没有提供将可复用性行为“附加”到组件的途径（例如，把组件连接到 store）解决此类问题可以使用 render props 和 高阶组件。但是这类方案需要重新组织组件结构，这可能会很麻烦，并且会使代码难以理解。由 providers，consumers，高阶组件，render props 等其他抽象层组成的组件会形成“嵌套地狱”。尽管可以在 DevTools 过滤掉它们，但这说明了一个更深层次的问题：React 需要为共享状态逻辑提供更好的原生途径。</p>
<p>可以使用 Hook 从组件中提取状态逻辑，使得这些逻辑可以单独测试并复用。Hook 使我们在无需修改组件结构的情况下复用状态逻辑。 这使得在组件间或社区内共享 Hook 变得更便捷。</p>
<p><strong>（2）复杂组件变得难以理解</strong></p>
<p>在组件中，每个生命周期常常包含一些不相关的逻辑。例如，组件常常在 componentDidMount 和 componentDidUpdate 中获取数据。但是，同一个 componentDidMount 中可能也包含很多其它的逻辑，如设置事件监听，而之后需在 componentWillUnmount 中清除。相互关联且需要对照修改的代码被进行了拆分，而完全不相关的代码却在同一个方法中组合在一起。如此很容易产生 bug，并且导致逻辑不一致。</p>
<p>在多数情况下，不可能将组件拆分为更小的粒度，因为状态逻辑无处不在。这也给测试带来了一定挑战。同时，这也是很多人将 React 与状态管理库结合使用的原因之一。但是，这往往会引入了很多抽象概念，需要你在不同的文件之间来回切换，使得复用变得更加困难。</p>
<p>为了解决这个问题，Hook 将组件中相互关联的部分拆分成更小的函数（比如设置订阅或请求数据），而并非强制按照生命周期划分。你还可以使用 reducer 来管理组件的内部状态，使其更加可预测。</p>
<p><strong>（3）难以理解的 class</strong></p>
<p>除了代码复用和代码管理会遇到困难外，class 是学习 React 的一大屏障。我们必须去理解 JavaScript 中 this 的工作方式，这与其他语言存在巨大差异。还不能忘记绑定事件处理器。没有稳定的语法提案，这些代码非常冗余。大家可以很好地理解 props，state 和自顶向下的数据流，但对 class 却一筹莫展。即便在有经验的 React 开发者之间，对于函数组件与 class 组件的差异也存在分歧，甚至还要区分两种组件的使用场景。</p>
<p>为了解决这些问题，Hook 使你在非 class 的情况下可以使用更多的 React 特性。 从概念上讲，React 组件一直更像是函数。而 Hook 则拥抱了函数，同时也没有牺牲 React 的精神原则。Hook 提供了问题的解决方案，无需学习复杂的函数式或响应式编程技术</p>
<h2 id="React-Hook-的使用限制"><a href="#React-Hook-的使用限制" class="headerlink" title="React Hook 的使用限制"></a>React Hook 的使用限制</h2><p>React Hooks 的限制主要有两条：</p>
<ul>
<li>不要在循环、条件或嵌套函数中调用 Hook；</li>
<li>在 React 的函数组件中调用 Hook。</li>
</ul>
<p>那为什么会有这样的限制呢？Hooks 的设计初衷是为了改进 React 组件的开发模式。在旧有的开发模式下遇到了三个问题。</p>
<ul>
<li>组件之间难以复用状态逻辑。过去常见的解决方案是高阶组件、render props 及状态管理框架。</li>
<li>复杂的组件变得难以理解。生命周期函数与业务逻辑耦合太深，导致关联部分难以拆分。</li>
<li>人和机器都很容易混淆类。常见的有 this 的问题，但在 React 团队中还有类难以优化的问题，希望在编译优化层面做出一些改进。</li>
</ul>
<p>这三个问题在一定程度上阻碍了 React 的后续发展，所以为了解决这三个问题，Hooks <strong>基于函数组件</strong>开始设计。然而第三个问题决定了 Hooks 只支持函数组件。</p>
<p>那为什么不要在循环、条件或嵌套函数中调用 Hook 呢？因为 Hooks 的设计是基于数组实现。在调用时按顺序加入数组中，如果使用循环、条件或嵌套函数很有可能导致数组取值错位，执行错误的 Hook。当然，实质上 React 的源码里不是数组，是链表。</p>
<p>这些限制会在编码上造成一定程度的心智负担，新手可能会写错，为了避免这样的情况，可以引入 ESLint 的 Hooks 检查插件进行预防。</p>
<h2 id="useEffect-与-useLayoutEffect-的区别"><a href="#useEffect-与-useLayoutEffect-的区别" class="headerlink" title="useEffect 与 useLayoutEffect 的区别"></a>useEffect 与 useLayoutEffect 的区别</h2><p><strong>（1）共同点</strong></p>
<ul>
<li>**运用效果：**useEffect 与 useLayoutEffect 两者都是用于处理副作用，这些副作用包括改变 DOM、设置订阅、操作定时器等。在函数组件内部操作副作用是不被允许的，所以需要使用这两个函数去处理。</li>
<li>**使用方式：**useEffect 与 useLayoutEffect 两者底层的函数签名是完全一致的，都是调用的 mountEffectImpl方法，在使用上也没什么差异，基本可以直接替换。</li>
</ul>
<p><strong>（2）不同点</strong></p>
<ul>
<li><strong>使用场景</strong>**：**useEffect 在 React 的渲染过程中是被异步调用的，用于绝大多数场景；而 useLayoutEffect 会在所有的 DOM 变更之后同步调用，主要用于处理 DOM 操作、调整样式、避免页面闪烁等问题。也正因为是同步处理，所以需要避免在 useLayoutEffect 做计算量较大的耗时任务从而造成阻塞。</li>
<li>**使用效果：**useEffect是按照顺序执行代码的，改变屏幕像素之后执行（先渲染，后改变DOM），当改变屏幕内容时可能会产生闪烁；useLayoutEffect是改变屏幕像素之前就执行了（会推迟页面显示的事件，先改变DOM后渲染），不会产生闪烁。<strong>useLayoutEffect总是比useEffect先执行。</strong></li>
</ul>
<p>在未来的趋势上，两个 API 是会长期共存的，暂时没有删减合并的计划，需要开发者根据场景去自行选择。React 团队的建议非常实用，如果实在分不清，先用 useEffect，一般问题不大；如果页面有异常，再直接替换为 useLayoutEffect 即可。</p>
<h2 id="React-Hooks在平时开发中需要注意的问题和原因"><a href="#React-Hooks在平时开发中需要注意的问题和原因" class="headerlink" title="React Hooks在平时开发中需要注意的问题和原因"></a>React Hooks在平时开发中需要注意的问题和原因</h2><p>（1）<strong>不要在循环，条件或嵌套函数中调用Hook，必须始终在 React函数的顶层使用Hook</strong></p>
<p>这是因为React需要利用调用顺序来正确更新相应的状态，以及调用相应的钩子函数。一旦在循环或条件分支语句中调用Hook，就容易导致调用顺序的不一致性，从而产生难以预料到的后果。</p>
<p>**（2）<strong><strong>使用useState时候，使用push，pop，splice等直接更改数组</strong></strong>对象的坑**</p>
<p>使用push直接更改数组无法获取到新值，应该采用析构方式，但是在class里面不会有这个问题。代码示例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Indicatorfilter</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> [num,setNums] = <span class="title function_">useState</span>([<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">test</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 这里坑是直接采用push去更新num</span></span><br><span class="line">    <span class="comment">// setNums(num)是无法更新num的</span></span><br><span class="line">    <span class="comment">// 必须使用num = [...num ,1]</span></span><br><span class="line">    num.<span class="title function_">push</span>(<span class="number">1</span>)</span><br><span class="line">    <span class="comment">// num = [...num ,1]</span></span><br><span class="line">    <span class="title function_">setNums</span>(num)</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#x27;filter&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">onClick</span>=<span class="string">&#123;test&#125;</span>&gt;</span>测试<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;num.map((item,index) =&gt; (</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span>&gt;</span>&#123;item&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          ))&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Indicatorfilter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span>&lt;any,any&gt;&#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props:any</span>)&#123;</span><br><span class="line">      <span class="variable language_">super</span>(props)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">          <span class="attr">nums</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">test</span> = <span class="variable language_">this</span>.<span class="property">test</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">test</span>(<span class="params"></span>)&#123;</span><br><span class="line">      <span class="comment">// class采用同样的方式是没有问题的</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">nums</span>.<span class="title function_">push</span>(<span class="number">1</span>)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">          <span class="attr">nums</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">nums</span></span><br><span class="line">      &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>)&#123;</span><br><span class="line">      <span class="keyword">let</span> &#123;nums&#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">      <span class="keyword">return</span>(</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">onClick</span>=<span class="string">&#123;this.test&#125;</span>&gt;</span>测试<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                      &#123;nums.map((item:any,index:number) =&gt; (</span></span><br><span class="line"><span class="language-xml">                          <span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span>&gt;</span>&#123;item&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                      ))&#125;</span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">      )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>（3）<strong>useState设置状态的时候，只有第一次生效，后期需要更新状态，必须通过useEffect</strong></p>
<p>TableDeail是一个公共组件，在调用它的父组件里面，我们通过set改变columns的值，以为传递给TableDeail 的 columns是最新的值，所以tabColumn每次也是最新的值，但是实际tabColumn是最开始的值，不会随着columns的更新而更新：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">TableDeail</span> = (<span class="params">&#123;</span></span><br><span class="line"><span class="params">    columns,</span></span><br><span class="line"><span class="params">&#125;:TableData</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> [tabColumn, setTabColumn] = <span class="title function_">useState</span>(columns) </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 正确的做法是通过useEffect改变这个值</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">TableDeail</span> = (<span class="params">&#123;</span></span><br><span class="line"><span class="params">    columns,</span></span><br><span class="line"><span class="params">&#125;:TableData</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> [tabColumn, setTabColumn] = <span class="title function_">useState</span>(columns) </span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span>&#123;<span class="title function_">setTabColumn</span>(columns)&#125;,[columns])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>（4）善用useCallback</strong></p>
<p>父组件传递给子组件事件句柄时，如果我们没有任何参数变动可能会选用useMemo。但是每一次父组件渲染子组件即使没变化也会跟着渲染一次。 </p>
<p><strong>（5）不要滥用useContext</strong></p>
<p>可以使用基于 useContext 封装的状态管理工具。</p>
<h1 id="React-Router"><a href="#React-Router" class="headerlink" title="React-Router"></a>React-Router</h1><h2 id="实现原理"><a href="#实现原理" class="headerlink" title="实现原理"></a>实现原理</h2><p>客户端路由实现的思想：</p>
<ul>
<li><p>基于 hash 的路由：通过监听<code>hashchange</code>事件，感知 hash 的变化</p>
</li>
<li><ul>
<li>改变 hash 可以直接通过 location.hash&#x3D;xxx</li>
</ul>
</li>
<li><p>基于 H5 history 路由：</p>
</li>
<li><ul>
<li>改变 url 可以通过 history.pushState 和 resplaceState 等，会将URL压入堆栈，同时能够应用 <code>history.go()</code> 等 API</li>
<li>监听 url 的变化可以通过自定义事件触发实现</li>
</ul>
</li>
</ul>
<p><strong>react-router 实现的思想：</strong></p>
<ul>
<li>基于 <code>history</code> 库来实现上述不同的客户端路由实现思想，并且能够保存历史记录等，磨平浏览器差异，上层无感知</li>
<li>通过维护的列表，在每次 URL 发生变化的回收，通过配置的 路由路径，匹配到对应的 Component，并且 render</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/06/29/React/" data-id="cmcygiiyr0006vgurg5uca8w0" data-title="React" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React/" rel="tag">React</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-TS" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/06/29/TS/" class="article-date">
  <time class="dt-published" datetime="2025-06-29T10:37:18.000Z" itemprop="datePublished">2025-06-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/06/29/TS/">TS</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="TypeScript"><a href="#TypeScript" class="headerlink" title="TypeScript"></a>TypeScript</h1><p>一、核心区别对比</p>
<table>
<thead>
<tr>
<th align="left">特性</th>
<th align="left">JavaScript (JS)</th>
<th align="left">TypeScript (TS)</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>类型系统</strong></td>
<td align="left">动态类型，运行时类型检查</td>
<td align="left">静态类型，编译时类型检查</td>
</tr>
<tr>
<td align="left"><strong>编译过程</strong></td>
<td align="left">直接由浏览器&#x2F;Node.js 执行</td>
<td align="left">需要编译为 JS 才能执行</td>
</tr>
<tr>
<td align="left"><strong>语法扩展</strong></td>
<td align="left">标准 ECMAScript 语法</td>
<td align="left">ES6+ 超集，添加类型注解和接口等</td>
</tr>
<tr>
<td align="left"><strong>错误发现</strong></td>
<td align="left">运行时才能发现错误</td>
<td align="left">编码和编译阶段即可发现大多数错误</td>
</tr>
<tr>
<td align="left"><strong>工具支持</strong></td>
<td align="left">基础代码补全</td>
<td align="left">强大的智能提示、重构和导航功能</td>
</tr>
<tr>
<td align="left"><strong>项目规模适应性</strong></td>
<td align="left">更适合小型项目</td>
<td align="left">更适合中大型复杂项目</td>
</tr>
<tr>
<td align="left"><strong>学习曲线</strong></td>
<td align="left">相对简单</td>
<td align="left">需要学习类型系统和额外语法</td>
</tr>
<tr>
<td align="left"><strong>执行环境</strong></td>
<td align="left">所有浏览器和 Node.js 原生支持</td>
<td align="left">需要编译为 JS 后运行</td>
</tr>
</tbody></table>
<p>二、TypeScript 编译原理</p>
<p>TypeScript 编译器 (tsc) 的工作流程：</p>
<ol>
<li>源代码解析阶段</li>
</ol>
<ul>
<li><strong>词法分析</strong>：将源代码分解为 token 流</li>
<li><strong>语法分析</strong>：根据 token 生成抽象语法树 (AST)</li>
<li><strong>生成符号表</strong>：记录所有变量、函数等的类型信息</li>
</ul>
<ol start="2">
<li>类型检查阶段</li>
</ol>
<ul>
<li><strong>类型解析</strong>：解析类型注解和推断隐式类型</li>
<li><strong>类型检查</strong>：验证类型兼容性，发现类型错误</li>
<li><strong>类型擦除</strong>：准备移除类型信息（最终JS不需要类型）</li>
</ul>
<ol start="3">
<li>代码转换阶段</li>
</ol>
<ul>
<li><strong>降级编译</strong>：将新语法转换为目标ES版本的等效代码</li>
<li><strong>接口擦除</strong>：移除纯类型声明的接口和类型别名</li>
<li><strong>装饰器转换</strong>：处理装饰器语法（如果启用）</li>
</ul>
<ol start="4">
<li>代码生成阶段</li>
</ol>
<ul>
<li><strong>生成目标代码</strong>：输出纯 JavaScript 代码</li>
<li><strong>SourceMap 生成</strong>：创建调试映射文件</li>
<li><strong>声明文件生成</strong>：生成 .d.ts 类型声明文件（如果配置）</li>
</ul>
<h2 id="TypeScript基本类型："><a href="#TypeScript基本类型：" class="headerlink" title="TypeScript基本类型："></a>TypeScript基本类型：</h2><ol>
<li><strong>基础类型</strong>：<ul>
<li><code>number</code>：数字</li>
<li><code>string</code>：字符串</li>
<li><code>boolean</code>：布尔值</li>
<li><code>null</code>和<code>undefined</code></li>
<li><code>void</code>：通常用于函数返回值</li>
<li><code>any</code>：任意类型</li>
<li><code>never</code>：永不存在的值的类型</li>
</ul>
</li>
<li><strong>对象类型</strong>：<ul>
<li><code>object</code>：对象类型</li>
<li><code>array</code>：数组类型</li>
<li><code>tuple</code>：元组类型</li>
</ul>
</li>
</ol>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">typescript 体验<span class="variable constant_">AI</span>代码助手 代码解读复制代码<span class="comment">// 基础类型示例</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">isDone</span>: <span class="built_in">boolean</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">decimal</span>: <span class="built_in">number</span> = <span class="number">6</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">color</span>: <span class="built_in">string</span> = <span class="string">&quot;blue&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">list</span>: <span class="built_in">number</span>[] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> <span class="attr">tuple</span>: [<span class="built_in">string</span>, <span class="built_in">number</span>] = [<span class="string">&quot;hello&quot;</span>, <span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 枚举类型</span></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Color</span> &#123;<span class="title class_">Red</span>, <span class="title class_">Green</span>, <span class="title class_">Blue</span>&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">c</span>: <span class="title class_">Color</span> = <span class="title class_">Color</span>.<span class="property">Green</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// void类型</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">warnUser</span>(<span class="params"></span>): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;This is a warning message&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// any类型</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">notSure</span>: <span class="built_in">any</span> = <span class="number">4</span>;</span><br><span class="line">notSure = <span class="string">&quot;maybe a string&quot;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="什么是类型断言？如何使用？"><a href="#什么是类型断言？如何使用？" class="headerlink" title="什么是类型断言？如何使用？"></a>什么是类型断言？如何使用？</h2><p>类型断言用于告诉编译器”相信我，我知道自己在做什么”。它有两种形式：</p>
<ol>
<li>尖括号语法</li>
<li>as语法（推荐，特别是在JSX中）</li>
</ol>
<p>示例代码：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">typescript 体验<span class="variable constant_">AI</span>代码助手 代码解读复制代码<span class="comment">// 尖括号语法</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">someValue</span>: <span class="built_in">any</span> = <span class="string">&quot;this is a string&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">strLength</span>: <span class="built_in">number</span> = (&lt;<span class="built_in">string</span>&gt;someValue).<span class="property">length</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// as语法</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">someValue2</span>: <span class="built_in">any</span> = <span class="string">&quot;this is a string&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">strLength2</span>: <span class="built_in">number</span> = (someValue2 <span class="keyword">as</span> <span class="built_in">string</span>).<span class="property">length</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实际应用场景</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">data</span>: <span class="built_in">any</span> = &#123; <span class="attr">name</span>: <span class="string">&quot;John&quot;</span>, <span class="attr">age</span>: <span class="number">30</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> person = data <span class="keyword">as</span> <span class="title class_">Person</span>;</span><br></pre></td></tr></table></figure>

<h2 id="进阶特性篇"><a href="#进阶特性篇" class="headerlink" title="进阶特性篇"></a>进阶特性篇</h2><h3 id="什么是泛型？为什么要使用泛型？"><a href="#什么是泛型？为什么要使用泛型？" class="headerlink" title="什么是泛型？为什么要使用泛型？"></a>什么是泛型？为什么要使用泛型？</h3><p>泛型是一种在定义函数、接口或类时不预先指定具体类型，而在使用时再指定类型的特性。</p>
<p>优点：</p>
<ul>
<li>代码复用</li>
<li>类型安全</li>
<li>减少冗余代码</li>
</ul>
<p>示例代码：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 泛型函数</span></span><br><span class="line"><span class="keyword">function</span> identity&lt;T&gt;(<span class="attr">arg</span>: T): T &#123;</span><br><span class="line">    <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用泛型函数</span></span><br><span class="line"><span class="keyword">let</span> output1 = identity&lt;<span class="built_in">string</span>&gt;(<span class="string">&quot;myString&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> output2 = <span class="title function_">identity</span>(<span class="number">42</span>); <span class="comment">// 类型推断为number</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 泛型接口</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">GenericIdentityFn</span>&lt;T&gt; &#123;</span><br><span class="line">    (<span class="attr">arg</span>: T): T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 泛型类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GenericNumber</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="attr">zeroValue</span>: T;</span><br><span class="line">    <span class="attr">add</span>: <span class="function">(<span class="params"><span class="attr">x</span>: T, <span class="attr">y</span>: T</span>) =&gt;</span> T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 泛型约束</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Lengthwise</span> &#123;</span><br><span class="line">    <span class="attr">length</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> loggingIdentity&lt;T <span class="keyword">extends</span> <span class="title class_">Lengthwise</span>&gt;(<span class="attr">arg</span>: T): T &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(arg.<span class="property">length</span>);</span><br><span class="line">    <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="装饰器是什么？如何使用？"><a href="#装饰器是什么？如何使用？" class="headerlink" title="装饰器是什么？如何使用？"></a>装饰器是什么？如何使用？</h3><p>装饰器是一种特殊类型的声明，可以附加到类、方法、访问符、属性或参数上。</p>
<p>示例代码：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 类装饰器</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sealed</span>(<span class="params"><span class="attr">constructor</span>: <span class="title class_">Function</span></span>) &#123;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">seal</span>(constructor);</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">seal</span>(constructor.<span class="property"><span class="keyword">prototype</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@sealed</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Greeter</span> &#123;</span><br><span class="line">    <span class="attr">greeting</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"><span class="attr">message</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">greeting</span> = message;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">greet</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello, &quot;</span> + <span class="variable language_">this</span>.<span class="property">greeting</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方法装饰器</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">log</span>(<span class="params"><span class="attr">target</span>: <span class="built_in">any</span>, <span class="attr">propertyKey</span>: <span class="built_in">string</span>, <span class="attr">descriptor</span>: <span class="title class_">PropertyDescriptor</span></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> originalMethod = descriptor.<span class="property">value</span>;</span><br><span class="line">    descriptor.<span class="property">value</span> = <span class="keyword">function</span>(<span class="params">...<span class="attr">args</span>: <span class="built_in">any</span>[]</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Calling <span class="subst">$&#123;propertyKey&#125;</span> with`</span>, args);</span><br><span class="line">        <span class="keyword">return</span> originalMethod.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> descriptor;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Calculator</span> &#123;</span><br><span class="line">    <span class="meta">@log</span></span><br><span class="line">    <span class="title function_">add</span>(<span class="params"><span class="attr">x</span>: <span class="built_in">number</span>, <span class="attr">y</span>: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> x + y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="实战应用篇"><a href="#实战应用篇" class="headerlink" title="实战应用篇"></a>实战应用篇</h2><h3 id="TypeScript中如何实现接口继承？"><a href="#TypeScript中如何实现接口继承？" class="headerlink" title="TypeScript中如何实现接口继承？"></a>TypeScript中如何实现接口继承？</h3><p>接口继承允许我们从一个接口复制成员到另一个接口，实现代码重用。</p>
<p>示例代码：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Pet</span> <span class="keyword">extends</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="attr">breed</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Dog</span> <span class="keyword">extends</span> <span class="title class_">Pet</span> &#123;</span><br><span class="line">    <span class="title function_">bark</span>(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">dog</span>: <span class="title class_">Dog</span> = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;Max&quot;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="attr">breed</span>: <span class="string">&quot;Labrador&quot;</span>,</span><br><span class="line">    <span class="title function_">bark</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Woof!&quot;</span>);</span><br><span class="line">    &#125;   </span><br><span class="line">        </span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GoldenRetriever</span> <span class="keyword">implements</span> <span class="title class_">Dog</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">    <span class="attr">breed</span>: <span class="built_in">string</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"><span class="attr">name</span>: <span class="built_in">string</span>, <span class="attr">age</span>: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">breed</span> = <span class="string">&quot;Golden Retriever&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">bark</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Woof!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-如何在TypeScript中处理异步操作？"><a href="#7-如何在TypeScript中处理异步操作？" class="headerlink" title="7. 如何在TypeScript中处理异步操作？"></a>7. 如何在TypeScript中处理异步操作？</h3><p>TypeScript完全支持现代JavaScript的异步特性，包括Promise、async&#x2F;await等。</p>
<p>示例代码：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Promise示例</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fetchUser</span>(<span class="params"><span class="attr">id</span>: <span class="built_in">number</span></span>): <span class="title class_">Promise</span>&lt;<span class="title class_">User</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">resolve</span>(&#123;</span><br><span class="line">                <span class="attr">id</span>: id,</span><br><span class="line">                <span class="attr">name</span>: <span class="string">&quot;John Doe&quot;</span></span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;, <span class="number">1000</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// async/await示例</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getUser</span>(<span class="params"><span class="attr">id</span>: <span class="built_in">number</span></span>): <span class="title class_">Promise</span>&lt;<span class="title class_">User</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> user = <span class="keyword">await</span> <span class="title function_">fetchUser</span>(id);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(user.<span class="property">name</span>);</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Error fetching user:&quot;</span>, error);</span><br><span class="line">        <span class="keyword">throw</span> error;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实际应用</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">processUser</span>(<span class="params"><span class="attr">id</span>: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> user = <span class="keyword">await</span> <span class="title function_">getUser</span>(id);</span><br><span class="line">    <span class="comment">// 处理用户数据</span></span><br><span class="line">    <span class="keyword">return</span> user;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="高级特性篇"><a href="#高级特性篇" class="headerlink" title="高级特性篇"></a>高级特性篇</h2><h3 id="什么是条件类型？如何使用？"><a href="#什么是条件类型？如何使用？" class="headerlink" title="什么是条件类型？如何使用？"></a>什么是条件类型？如何使用？</h3><p>条件类型是TypeScript中的高级类型特性，允许我们基于类型关系进行类型选择。</p>
<p>示例代码：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">TypeName</span>&lt;T&gt; = </span><br><span class="line">    T <span class="keyword">extends</span> <span class="built_in">string</span> ? <span class="string">&quot;string&quot;</span> :</span><br><span class="line">    T <span class="keyword">extends</span> <span class="built_in">number</span> ? <span class="string">&quot;number&quot;</span> :</span><br><span class="line">    T <span class="keyword">extends</span> <span class="built_in">boolean</span> ? <span class="string">&quot;boolean&quot;</span> :</span><br><span class="line">    T <span class="keyword">extends</span> <span class="literal">undefined</span> ? <span class="string">&quot;undefined&quot;</span> :</span><br><span class="line">    T <span class="keyword">extends</span> <span class="title class_">Function</span> ? <span class="string">&quot;function&quot;</span> :</span><br><span class="line">    <span class="string">&quot;object&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用示例</span></span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">T0</span> = <span class="title class_">TypeName</span>&lt;<span class="built_in">string</span>&gt;;  <span class="comment">// &quot;string&quot;</span></span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">T1</span> = <span class="title class_">TypeName</span>&lt;<span class="string">&quot;hello&quot;</span>&gt;; <span class="comment">// &quot;string&quot;</span></span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">T2</span> = <span class="title class_">TypeName</span>&lt;<span class="function">() =&gt;</span> <span class="built_in">void</span>&gt;; <span class="comment">// &quot;function&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 实际应用</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">NonNullable</span>&lt;T&gt; = T <span class="keyword">extends</span> <span class="literal">null</span> | <span class="literal">undefined</span> ? <span class="built_in">never</span> : T;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Flatten</span>&lt;T&gt; = T <span class="keyword">extends</span> <span class="title class_">Array</span>&lt;infer U&gt; ? U : T;</span><br></pre></td></tr></table></figure>

<h3 id="如何使用映射类型？"><a href="#如何使用映射类型？" class="headerlink" title="如何使用映射类型？"></a>如何使用映射类型？</h3><p>映射类型允许我们从现有类型创建新类型，通过映射现有类型的每个属性。</p>
<p>示例代码：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将所有属性变为可选</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Partial</span>&lt;T&gt; = &#123;</span><br><span class="line">    [P <span class="keyword">in</span> keyof T]?: T[P];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将所有属性变为只读</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Readonly</span>&lt;T&gt; = &#123;</span><br><span class="line">    <span class="keyword">readonly</span> [P <span class="keyword">in</span> keyof T]: T[P];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实际应用</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PartialPerson</span> = <span class="title class_">Partial</span>&lt;<span class="title class_">Person</span>&gt;;</span><br><span class="line"><span class="comment">// 等价于：</span></span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//     name?: string;</span></span><br><span class="line"><span class="comment">//     age?: number;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ReadonlyPerson</span> = <span class="title class_">Readonly</span>&lt;<span class="title class_">Person</span>&gt;;</span><br><span class="line"><span class="comment">// 等价于：</span></span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//     readonly name: string;</span></span><br><span class="line"><span class="comment">//     readonly age: number;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="工程实践篇"><a href="#工程实践篇" class="headerlink" title="工程实践篇"></a>工程实践篇</h2><h3 id="TypeScript项目中如何处理模块化？"><a href="#TypeScript项目中如何处理模块化？" class="headerlink" title="TypeScript项目中如何处理模块化？"></a>TypeScript项目中如何处理模块化？</h3><p>TypeScript支持现代JavaScript的模块化语法，同时提供了额外的类型系统支持。</p>
<p>示例代码：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// math.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">MathOperations</span> &#123;</span><br><span class="line">    <span class="title function_">add</span>(<span class="attr">x</span>: <span class="built_in">number</span>, <span class="attr">y</span>: <span class="built_in">number</span>): <span class="built_in">number</span>;</span><br><span class="line">    <span class="title function_">subtract</span>(<span class="attr">x</span>: <span class="built_in">number</span>, <span class="attr">y</span>: <span class="built_in">number</span>): <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">Calculator</span> <span class="keyword">implements</span> <span class="title class_">MathOperations</span> &#123;</span><br><span class="line">    <span class="title function_">add</span>(<span class="attr">x</span>: <span class="built_in">number</span>, <span class="attr">y</span>: <span class="built_in">number</span>): <span class="built_in">number</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x + y;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">subtract</span>(<span class="attr">x</span>: <span class="built_in">number</span>, <span class="attr">y</span>: <span class="built_in">number</span>): <span class="built_in">number</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x - y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// app.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Calculator</span>, <span class="title class_">MathOperations</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./math&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> calc = <span class="keyword">new</span> <span class="title class_">Calculator</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(calc.<span class="title function_">add</span>(<span class="number">5</span>, <span class="number">3</span>)); <span class="comment">// 8</span></span><br></pre></td></tr></table></figure>

<h2 id="补充重点篇"><a href="#补充重点篇" class="headerlink" title="补充重点篇"></a>补充重点篇</h2><p>什么是类型收窄（Type Narrowing）？</p>
<p>类型收窄是TypeScript中缩小类型范围的过程，有多种方式可以实现类型收窄。</p>
<p>示例代码：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用类型守卫</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">padLeft</span>(<span class="params"><span class="attr">padding</span>: <span class="built_in">number</span> | <span class="built_in">string</span>, <span class="attr">input</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> padding === <span class="string">&quot;number&quot;</span>) &#123;</span><br><span class="line">        <span class="comment">// 这里padding的类型被收窄为number</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot; &quot;</span>.<span class="title function_">repeat</span>(padding) + input;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 这里padding的类型被收窄为string</span></span><br><span class="line">    <span class="keyword">return</span> padding + input;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用instanceof</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Bird</span> &#123;</span><br><span class="line">    <span class="title function_">fly</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;flying...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Fish</span> &#123;</span><br><span class="line">    <span class="title function_">swim</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;swimming...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">move</span>(<span class="params"><span class="attr">animal</span>: <span class="title class_">Bird</span> | <span class="title class_">Fish</span></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (animal <span class="keyword">instanceof</span> <span class="title class_">Bird</span>) &#123;</span><br><span class="line">        <span class="comment">// 这里animal的类型被收窄为Bird</span></span><br><span class="line">        animal.<span class="title function_">fly</span>();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 这里animal的类型被收窄为Fish</span></span><br><span class="line">        animal.<span class="title function_">swim</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用in操作符</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Admin</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">privileges</span>: <span class="built_in">string</span>[];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Employee</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">startDate</span>: <span class="title class_">Date</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">printEmployeeInformation</span>(<span class="params"><span class="attr">emp</span>: <span class="title class_">Admin</span> | <span class="title class_">Employee</span></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&quot;privileges&quot;</span> <span class="keyword">in</span> emp) &#123;</span><br><span class="line">        <span class="comment">// 这里emp的类型被收窄为Admin</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Privileges: &quot;</span> + emp.<span class="property">privileges</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&quot;startDate&quot;</span> <span class="keyword">in</span> emp) &#123;</span><br><span class="line">        <span class="comment">// 这里emp的类型被收窄为Employee</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Start Date: &quot;</span> + emp.<span class="property">startDate</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="12-TypeScript中的tsconfig-json重要配置有哪些？"><a href="#12-TypeScript中的tsconfig-json重要配置有哪些？" class="headerlink" title="12. TypeScript中的tsconfig.json重要配置有哪些？"></a>12. TypeScript中的tsconfig.json重要配置有哪些？</h3><p>tsconfig.json是TypeScript项目的配置文件，包含许多重要选项。</p>
<p>示例代码：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="comment">// 目标JavaScript版本</span></span><br><span class="line">        <span class="attr">&quot;target&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ES2020&quot;</span><span class="punctuation">,</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 模块系统</span></span><br><span class="line">        <span class="attr">&quot;module&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CommonJS&quot;</span><span class="punctuation">,</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 严格类型检查</span></span><br><span class="line">        <span class="attr">&quot;strict&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 允许从没有默认导出的模块中默认导入</span></span><br><span class="line">        <span class="attr">&quot;allowSyntheticDefaultImports&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 生成声明文件</span></span><br><span class="line">        <span class="attr">&quot;declaration&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 允许装饰器</span></span><br><span class="line">        <span class="attr">&quot;experimentalDecorators&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 模块解析策略</span></span><br><span class="line">        <span class="attr">&quot;moduleResolution&quot;</span><span class="punctuation">:</span> <span class="string">&quot;node&quot;</span><span class="punctuation">,</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 基础目录</span></span><br><span class="line">        <span class="attr">&quot;baseUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./src&quot;</span><span class="punctuation">,</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 路径别名</span></span><br><span class="line">        <span class="attr">&quot;paths&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;@/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;*&quot;</span><span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;include&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;src/**/*&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;exclude&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;node_modules&quot;</span><span class="punctuation">,</span> <span class="string">&quot;**/*.spec.ts&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="13-联合类型和交叉类型的区别是什么？"><a href="#13-联合类型和交叉类型的区别是什么？" class="headerlink" title="13. 联合类型和交叉类型的区别是什么？"></a>13. 联合类型和交叉类型的区别是什么？</h3><p>联合类型和交叉类型是TypeScript中两种重要的类型组合方式。</p>
<p>示例代码：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 联合类型（Union Types）</span></span><br><span class="line"><span class="comment">// 表示可以是多种类型中的一种</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">StringOrNumber</span> = <span class="built_in">string</span> | <span class="built_in">number</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">printId</span>(<span class="params"><span class="attr">id</span>: <span class="title class_">StringOrNumber</span></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> id === <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(id.<span class="title function_">toUpperCase</span>());</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 交叉类型（Intersection Types）</span></span><br><span class="line"><span class="comment">// 表示同时具有多种类型的特性</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ErrorHandling</span> &#123;</span><br><span class="line">    <span class="attr">success</span>: <span class="built_in">boolean</span>;</span><br><span class="line">    <span class="attr">error</span>?: &#123; <span class="attr">message</span>: <span class="built_in">string</span> &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ArtworksData</span> &#123;</span><br><span class="line">    <span class="attr">artworks</span>: &#123; <span class="attr">title</span>: <span class="built_in">string</span> &#125;[];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 同时具有两个接口的所有属性</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ArtworksResponse</span> = <span class="title class_">ArtworksData</span> &amp; <span class="title class_">ErrorHandling</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">response</span>: <span class="title class_">ArtworksResponse</span> = &#123;</span><br><span class="line">    <span class="attr">artworks</span>: [&#123; <span class="attr">title</span>: <span class="string">&quot;Mona Lisa&quot;</span> &#125;],</span><br><span class="line">    <span class="attr">success</span>: <span class="literal">true</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="14-TypeScript-4-x和5-x有哪些重要新特性？"><a href="#14-TypeScript-4-x和5-x有哪些重要新特性？" class="headerlink" title="14. TypeScript 4.x和5.x有哪些重要新特性？"></a>14. TypeScript 4.x和5.x有哪些重要新特性？</h3><p>TypeScript的新版本带来了许多有用的特性。</p>
<p>示例代码：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// TypeScript 4.0+: 可变元组类型</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Strings</span> = [<span class="built_in">string</span>, <span class="built_in">string</span>];</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Numbers</span> = [<span class="built_in">number</span>, <span class="built_in">number</span>];</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">StringsAndNumbers</span> = [...<span class="title class_">Strings</span>, ...<span class="title class_">Numbers</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// TypeScript 4.3+: override关键字</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Base</span> &#123;</span><br><span class="line">    <span class="title function_">greet</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Derived</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Base</span> &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="title function_">greet</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hi&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TypeScript 4.4+: 控制流分析的改进</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">example</span>(<span class="params"><span class="attr">value</span>: <span class="built_in">string</span> | <span class="built_in">number</span></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">random</span>()) &#123;</span><br><span class="line">        value = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> value === <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">        <span class="comment">// TypeScript知道这里value一定是string</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(value.<span class="title function_">toUpperCase</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TypeScript 4.5+: Awaited类型</span></span><br><span class="line"><span class="keyword">type</span> A = <span class="title class_">Awaited</span>&lt;<span class="title class_">Promise</span>&lt;<span class="built_in">string</span>&gt;&gt;; <span class="comment">// string</span></span><br><span class="line"><span class="keyword">type</span> B = <span class="title class_">Awaited</span>&lt;<span class="title class_">Promise</span>&lt;<span class="title class_">Promise</span>&lt;<span class="built_in">number</span>&gt;&gt;&gt;; <span class="comment">// number</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// TypeScript 4.9+: satisfies操作符</span></span><br><span class="line"><span class="keyword">const</span> palette = &#123;</span><br><span class="line">    <span class="attr">red</span>: [<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">    <span class="attr">green</span>: <span class="string">&quot;#00ff00&quot;</span>,</span><br><span class="line">&#125; <span class="keyword">satisfies</span> <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="built_in">string</span> | <span class="built_in">number</span>[]&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TypeScript 5.0+: const类型参数</span></span><br><span class="line"><span class="keyword">function</span> first&lt;<span class="keyword">const</span> T <span class="keyword">extends</span> <span class="keyword">readonly</span> <span class="built_in">unknown</span>[]&gt;(<span class="attr">arr</span>: T) &#123;</span><br><span class="line">    <span class="keyword">return</span> arr[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TypeScript 5.2+: using关键字和显式资源管理</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FileHandle</span> <span class="keyword">implements</span> <span class="title class_">Disposable</span> &#123;</span><br><span class="line">    <span class="title function_">dispose</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 清理资源</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">using</span> handle = <span class="keyword">new</span> <span class="title class_">FileHandle</span>();</span><br><span class="line">    <span class="comment">// 使用handle</span></span><br><span class="line">    <span class="comment">// 作用域结束时自动调用dispose</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="15-TypeScript中的类型体操实战有哪些？"><a href="#15-TypeScript中的类型体操实战有哪些？" class="headerlink" title="15. TypeScript中的类型体操实战有哪些？"></a>15. TypeScript中的类型体操实战有哪些？</h3><p>类型体操是TypeScript中高级类型的实际应用，经常出现在面试中。</p>
<p>示例代码：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实现Pick类型  Pick</span></span><br><span class="line"><span class="comment">// Pick 从对象类型中仅保留指定的键，移除其他所有键</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">MyPick</span>&lt;T, K <span class="keyword">extends</span> keyof T&gt; = &#123;</span><br><span class="line">    [P <span class="keyword">in</span> K]: T[P];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现Readonly类型</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">MyReadonly</span>&lt;T&gt; = &#123;</span><br><span class="line">    <span class="keyword">readonly</span> [P <span class="keyword">in</span> keyof T]: T[P];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现深度Readonly</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">DeepReadonly</span>&lt;T&gt; = &#123;</span><br><span class="line">    <span class="keyword">readonly</span> [P <span class="keyword">in</span> keyof T]: T[P] <span class="keyword">extends</span> <span class="built_in">object</span> </span><br><span class="line">        ? <span class="title class_">DeepReadonly</span>&lt;T[P]&gt; </span><br><span class="line">        : T[P];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现Partial类型</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">MyPartial</span>&lt;T&gt; = &#123;</span><br><span class="line">    [P <span class="keyword">in</span> keyof T]?: T[P];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现Required类型 //移除可选符</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">MyRequired</span>&lt;T&gt; = &#123;</span><br><span class="line">    [P <span class="keyword">in</span> keyof T]-?: T[P];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现Record类型</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">MyRecord</span>&lt;K <span class="keyword">extends</span> keyof <span class="built_in">any</span>, T&gt; = &#123;</span><br><span class="line">    [P <span class="keyword">in</span> K]: T;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现Exclude类型 Exclude 从联合类型中移除类型。</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">MyExclude</span>&lt;T, U&gt; = T <span class="keyword">extends</span> U ? <span class="built_in">never</span> : T;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现Extract类型</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">MyExtract</span>&lt;T, U&gt; = T <span class="keyword">extends</span> U ? T : <span class="built_in">never</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现ReturnType类型 ReturnType 提取函数类型的返回类型。</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">MyReturnType</span>&lt;T <span class="title function_">extends</span> (...<span class="attr">args</span>: <span class="built_in">any</span>) =&gt; <span class="built_in">any</span>&gt; = </span><br><span class="line">    T <span class="title function_">extends</span> (...<span class="attr">args</span>: <span class="built_in">any</span>) =&gt; infer R ? R : <span class="built_in">any</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实际应用示例</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Todo</span> &#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">description</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">completed</span>: <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 只读的Todo类型</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ReadonlyTodo</span> = <span class="title class_">MyReadonly</span>&lt;<span class="title class_">Todo</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可选的Todo类型</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PartialTodo</span> = <span class="title class_">MyPartial</span>&lt;<span class="title class_">Todo</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 提取Todo中的字符串类型属性</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">StringProps</span> = <span class="title class_">MyExtract</span>&lt;keyof <span class="title class_">Todo</span>, <span class="built_in">string</span>&gt;;</span><br></pre></td></tr></table></figure>




      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/06/29/TS/" data-id="cmcygiiys0009vgurbxlyc48a" data-title="TS" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/typescript/" rel="tag">typescript</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Node" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/06/29/Node/" class="article-date">
  <time class="dt-published" datetime="2025-06-29T10:36:35.000Z" itemprop="datePublished">2025-06-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/06/29/Node/">Node</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Node-js"><a href="#Node-js" class="headerlink" title="Node.js"></a>Node.js</h1><p>Node.js 是一个基于 Chrome V8 引擎的 JavaScript 运行时环境，它让开发者能够使用 JavaScript 编写服务器端代码。与传统的服务器端技术不同，Node.js 采用了<strong>事件驱动</strong>和<strong>非阻塞 I&#x2F;O</strong>模型，这使得它特别适合处理高并发的网络应用。</p>
<p><strong>核心特点</strong></p>
<ol>
<li><strong>单线程</strong>：Node.js 使用单线程处理请求</li>
<li><strong>事件循环</strong>：通过事件驱动机制处理并发</li>
<li><strong>非阻塞 I&#x2F;O</strong>：I&#x2F;O 操作不会阻塞主线程</li>
<li><strong>跨平台</strong>：可以在 Windows、Linux、macOS 等系统上运行</li>
</ol>
<p>Node.js 通过 V8 引擎执行 JavaScript 代码，使用 Node.js API 与操作系统交互，并通过 Libuv 处理异步 I&#x2F;O 操作。事件循环和工作线程确保了 Node.js 的高效和非阻塞特性。</p>
<h2 id="通讯方法"><a href="#通讯方法" class="headerlink" title="通讯方法"></a>通讯方法</h2><table>
<thead>
<tr>
<th align="left">特性</th>
<th align="left">XHR</th>
<th align="left">Fetch</th>
<th align="center">Axios</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>基本架构</strong></td>
<td align="left">事件回调机制</td>
<td align="left">Promise API</td>
<td align="center">Promise API</td>
</tr>
<tr>
<td align="left"><strong>浏览器支持</strong></td>
<td align="left">所有浏览器</td>
<td align="left">现代浏览器(不兼容IE)</td>
<td align="center">所有浏览器(通过polyfill)</td>
</tr>
<tr>
<td align="left"><strong>请求取消</strong></td>
<td align="left">支持</td>
<td align="left">需要AbortController</td>
<td align="center">支持</td>
</tr>
<tr>
<td align="left"><strong>超时设置</strong></td>
<td align="left">支持</td>
<td align="left">不支持(需手动实现)</td>
<td align="center">支持</td>
</tr>
<tr>
<td align="left"><strong>进度监控</strong></td>
<td align="left">支持(upload&#x2F;download)</td>
<td align="left">仅支持下载进度</td>
<td align="center">支持</td>
</tr>
<tr>
<td align="left"><strong>拦截器</strong></td>
<td align="left">不支持</td>
<td align="left">不支持</td>
<td align="center">支持</td>
</tr>
<tr>
<td align="left"><strong>自动JSON转换</strong></td>
<td align="left">需要手动处理</td>
<td align="left">需要手动调用.json()</td>
<td align="center">自动转换</td>
</tr>
<tr>
<td align="left"><strong>CSRF防护</strong></td>
<td align="left">需要手动设置</td>
<td align="left">需要手动设置</td>
<td align="center">内置支持</td>
</tr>
<tr>
<td align="left"><strong>HTTP方法</strong></td>
<td align="left">需要.open()设置</td>
<td align="left">通过options.method设置</td>
<td align="center">提供对应方法别名</td>
</tr>
<tr>
<td align="left"><strong>请求&#x2F;响应拦截</strong></td>
<td align="left">不支持</td>
<td align="left">不支持</td>
<td align="center">支持</td>
</tr>
</tbody></table>
<h1 id="Node-js-事件循环"><a href="#Node-js-事件循环" class="headerlink" title="Node.js 事件循环"></a>Node.js 事件循环</h1><p>事件循环是 Node.js 处理非阻塞 I&#x2F;O 操作的核心机制，使得单线程能够高效处理多个并发请求。</p>
<p>Node.js 是基于单线程的 JavaScript 运行时，利用事件循环来处理异步操作，如文件读取、网络请求和数据库查询。</p>
<p>事件循环使得 Node.js 能够非阻塞地运行代码、处理多个连接、以及执行异步 I&#x2F;O 操作。</p>
<p>事件循环使得 Node.js 能够处理大量并发的 I&#x2F;O 操作而不会导致线程阻塞，这是 Node.js 高效处理并发请求的关键。</p>
<p><img src="/../img/1_SvTxMIEudVv8YRW_ELRamw.png" alt="img"></p>
<h3 id="事件循环的阶段"><a href="#事件循环的阶段" class="headerlink" title="事件循环的阶段"></a>事件循环的阶段</h3><p>事件循环分为多个阶段，每个阶段处理特定的任务。关键阶段如下：</p>
<ul>
<li><strong>Timers</strong>：执行 <code>setTimeout()</code> 和 <code>setInterval()</code> 的回调。</li>
<li><strong>I&#x2F;O Callbacks</strong>：处理一些延迟的 I&#x2F;O 回调。</li>
<li><strong>Idle, prepare</strong>：内部使用，不常见。</li>
<li><strong>Poll</strong>：检索新的 I&#x2F;O 事件，执行与 I&#x2F;O 相关的回调。</li>
<li><strong>Check</strong>：执行 <code>setImmediate()</code> 回调。</li>
<li><strong>Close Callbacks</strong>：处理关闭的回调，如 <code>socket.on(&#39;close&#39;, ...)</code>。</li>
</ul>
<h3 id="事件循环的流程"><a href="#事件循环的流程" class="headerlink" title="事件循环的流程"></a>事件循环的流程</h3><ul>
<li><strong>任务进入事件循环队列</strong>。</li>
<li>事件循环按照阶段顺序进行处理，每个阶段有自己的回调队列。</li>
<li>事件循环会在 <code>poll</code> 阶段等待新的事件到达，如果没有事件，会检查其他阶段的回调。</li>
<li>如果 <code>setImmediate()</code> 和 <code>setTimeout()</code> 都存在，<code>setImmediate()</code> 在 <code>check</code> 阶段先执行，而 <code>setTimeout()</code> 在 <code>timers</code> 阶段执行。</li>
</ul>
<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">setTimeout(() =&gt; &#123;</span><br><span class="line"> console.log(&#x27;Timeout callback&#x27;);</span><br><span class="line">&#125;, 0);</span><br><span class="line"></span><br><span class="line">setImmediate(() =&gt; &#123;</span><br><span class="line"> console.log(&#x27;Immediate callback&#x27;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">console.log(&#x27;Main thread execution&#x27;);</span><br></pre></td></tr></table></figure>

<p>输出顺序：</p>
<ul>
<li><code>Main thread execution</code> 先打印。</li>
<li><code>setImmediate()</code> 和 <code>setTimeout()</code> 的执行顺序取决于当前事件循环的状态，一般 <code>setImmediate()</code> 会先执行。</li>
</ul>
<h3 id="宏任务与微任务"><a href="#宏任务与微任务" class="headerlink" title="宏任务与微任务"></a>宏任务与微任务</h3><ul>
<li><strong>宏任务</strong>：<code>setTimeout</code>、<code>setInterval</code>、<code>setImmediate</code>、I&#x2F;O 操作等。</li>
<li><strong>微任务</strong>：<code>process.nextTick</code>、<code>Promise.then</code>。</li>
</ul>
<p>**执行顺序：**微任务优先级高于宏任务，会在当前阶段的回调结束后立即执行。</p>
<h2 id="实例-1"><a href="#实例-1" class="headerlink" title="实例"></a>实例</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">setTimeout(() =&gt; &#123;</span><br><span class="line"> console.log(&#x27;Timeout callback&#x27;);</span><br><span class="line">&#125;, 0);</span><br><span class="line"></span><br><span class="line">Promise.resolve().then(() =&gt; &#123;</span><br><span class="line"> console.log(&#x27;Promise callback&#x27;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">console.log(&#x27;Main thread execution&#x27;);</span><br></pre></td></tr></table></figure>

<p>执行输出结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Main thread execution</span><br><span class="line">Promise callback</span><br><span class="line">Timeout callback</span><br></pre></td></tr></table></figure>

<h3 id="process-nextTick"><a href="#process-nextTick" class="headerlink" title="process.nextTick()"></a>process.nextTick()</h3><p>process.nextTick() 会在当前操作结束后、下一个阶段开始前执行微任务，优先级高于 Promise。</p>
<h2 id="实例-2"><a href="#实例-2" class="headerlink" title="实例"></a>实例</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">process.nextTick(() =&gt; &#123;</span><br><span class="line"> console.log(&#x27;Next tick callback&#x27;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">console.log(&#x27;Main thread execution&#x27;);</span><br></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Main thread execution</span><br><span class="line">Next tick callback</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="事件驱动程序"><a href="#事件驱动程序" class="headerlink" title="事件驱动程序"></a>事件驱动程序</h2><p>在 Node.js 中，事件驱动编程主要通过 EventEmitter 类来实现。</p>
<p>EventEmitter 是一个内置类，位于 events 模块中，通过继承 EventEmitter，你可以创建自己的事件发射器，并注册和触发事件。</p>
<p>通过这种机制，Node.js 可以高效地处理异步任务，即使在单线程的环境下也能实现并发处理。</p>
<p><img src="/../img/event_loop.jpg" alt="img"></p>
<p>整个事件驱动的流程就是这么实现的，非常简洁。有点类似于观察者模式，事件相当于一个主题(Subject)，而所有注册到这个事件上的处理函数相当于观察者(Observer)。</p>
<p><strong>基本概念：</strong></p>
<ul>
<li><strong>事件</strong>：在程序中发生的动作或状态改变，例如一个文件读取完成或一个 HTTP 请求到达。</li>
<li><strong>事件触发器</strong>：<code>EventEmitter</code> 是 Node.js 的内置模块，用来发出和监听事件。</li>
<li><strong>事件处理器</strong>：与事件关联的回调函数，事件发生时被调用。</li>
</ul>
<p><strong>事件驱动的流程：</strong></p>
<ul>
<li><strong>注册事件</strong>：在程序中通过 <code>EventEmitter</code> 实例注册事件和对应的处理器。</li>
<li><strong>触发事件</strong>：当指定的事件发生时，<code>EventEmitter</code> 会触发该事件。</li>
<li><strong>处理事件</strong>：事件循环会调度相应的回调函数来执行任务。</li>
</ul>
<p>Node.js 有多个内置的事件，我们可以通过引入 events 模块，并通过实例化 EventEmitter 类来绑定和监听事件，如下实例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 引入 events 模块</span><br><span class="line">var events = require(&#x27;events&#x27;);</span><br><span class="line">// 创建 eventEmitter 对象</span><br><span class="line">var eventEmitter = new events.EventEmitter();</span><br></pre></td></tr></table></figure>

<p>以下程序绑定事件处理程序：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 绑定事件及事件的处理程序</span><br><span class="line">eventEmitter.on(&#x27;eventName&#x27;, eventHandler);</span><br></pre></td></tr></table></figure>

<p>我们可以通过程序触发事件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 触发事件</span><br><span class="line">eventEmitter.emit(&#x27;eventName&#x27;);</span><br></pre></td></tr></table></figure>

<h3 id="实例-3"><a href="#实例-3" class="headerlink" title="实例"></a>实例</h3><p>创建 hello.js 文件，代码如下所示：</p>
<h2 id="实例-1"><a href="#实例-1" class="headerlink" title="实例 1"></a>实例 1</h2><p><strong>const</strong> EventEmitter &#x3D; require(‘events’);<br><strong>const</strong> myEmitter &#x3D; <strong>new</strong> EventEmitter();</p>
<p><em>&#x2F;&#x2F; 注册事件处理器</em><br>myEmitter.on(‘greet’, () &#x3D;&gt; {<br> console.log(‘Hello, world!’);<br>});</p>
<p><em>&#x2F;&#x2F; 触发事件</em><br>myEmitter.emit(‘greet’);</p>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello, world!</span><br></pre></td></tr></table></figure>

<p>创建 main.js 文件，代码如下所示：</p>
<h2 id="实例-2"><a href="#实例-2" class="headerlink" title="实例 2"></a>实例 2</h2><p>&#x2F;&#x2F; 引入 events 模块 var events &#x3D; require(‘events’); &#x2F;&#x2F; 创建 eventEmitter 对象 var eventEmitter &#x3D; new events.EventEmitter();  &#x2F;&#x2F; 创建事件处理程序 var connectHandler &#x3D; function connected() {   console.log(‘连接成功。’);     &#x2F;&#x2F; 触发 data_received 事件    eventEmitter.emit(‘data_received’); }  &#x2F;&#x2F; 绑定 connection 事件处理程序 eventEmitter.on(‘connection’, connectHandler);  &#x2F;&#x2F; 使用匿名函数绑定 data_received 事件 eventEmitter.on(‘data_received’, function(){   console.log(‘数据接收成功。’); });  &#x2F;&#x2F; 触发 connection 事件  eventEmitter.emit(‘connection’);  console.log(“程序执行完毕。”);</p>
<p>接下来让我们执行以上代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ node main.js</span><br><span class="line">连接成功。</span><br><span class="line">数据接收成功。</span><br><span class="line">程序执行完毕。</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Node-应用程序是如何工作的？"><a href="#Node-应用程序是如何工作的？" class="headerlink" title="Node 应用程序是如何工作的？"></a>Node 应用程序是如何工作的？</h2><p>在 Node 应用程序中，执行异步操作的函数将回调函数作为最后一个参数， 回调函数接收错误对象作为第一个参数。</p>
<p>接下来让我们来重新看下前面的实例，创建一个 input.txt ,文件内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">菜鸟教程官网地址：www.runoob.com</span><br></pre></td></tr></table></figure>

<p>创建 main.js 文件，代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">var fs = require(&quot;fs&quot;);</span><br><span class="line"></span><br><span class="line">fs.readFile(&#x27;input.txt&#x27;, function (err, data) &#123;</span><br><span class="line">   if (err)&#123;</span><br><span class="line">      console.log(err.stack);</span><br><span class="line">      return;</span><br><span class="line">   &#125;</span><br><span class="line">   console.log(data.toString());</span><br><span class="line">&#125;);</span><br><span class="line">console.log(&quot;程序执行完毕&quot;);</span><br></pre></td></tr></table></figure>

<p>以上程序中 fs.readFile() 是异步函数用于读取文件。 如果在读取文件过程中发生错误，错误 err 对象就会输出错误信息。</p>
<p>如果没发生错误，readFile 跳过 err 对象的输出，文件内容就通过回调函数输出。</p>
<p>执行以上代码，执行结果如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">程序执行完毕</span><br><span class="line">菜鸟教程官网地址：www.runoob.com</span><br></pre></td></tr></table></figure>

<p>接下来我们删除 input.txt 文件，执行结果如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">程序执行完毕</span><br><span class="line">Error: ENOENT, open &#x27;input.txt&#x27;</span><br></pre></td></tr></table></figure>

<p>因为文件 input.txt 不存在，所以输出了错误信息。</p>
<h1 id="Node-js-中的流-Stream-、缓冲区-Buffer-与浏览器中的Blob对比"><a href="#Node-js-中的流-Stream-、缓冲区-Buffer-与浏览器中的Blob对比" class="headerlink" title="Node.js 中的流(Stream)、缓冲区(Buffer)与浏览器中的Blob对比"></a>Node.js 中的流(Stream)、缓冲区(Buffer)与浏览器中的Blob对比</h1><h2 id="一、核心概念对比"><a href="#一、核心概念对比" class="headerlink" title="一、核心概念对比"></a>一、核心概念对比</h2><table>
<thead>
<tr>
<th align="left">概念</th>
<th align="left">环境</th>
<th align="left">本质</th>
<th align="left">主要用途</th>
<th align="left">特点</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>Stream</strong></td>
<td align="left">Node.js</td>
<td align="left">数据处理的抽象接口</td>
<td align="left">处理大量数据或I&#x2F;O操作</td>
<td align="left">分块处理、内存高效</td>
</tr>
<tr>
<td align="left"><strong>Buffer</strong></td>
<td align="left">Node.js</td>
<td align="left">固定大小的二进制数据块</td>
<td align="left">临时存储原始二进制数据</td>
<td align="left">内存操作、快速访问</td>
</tr>
<tr>
<td align="left"><strong>Blob</strong></td>
<td align="left">浏览器</td>
<td align="left">不可变的类文件对象</td>
<td align="left">表示二进制数据(如图片、文件)</td>
<td align="left">浏览器环境专用、支持切片操作</td>
</tr>
</tbody></table>
<h2 id="二、Node-js-中的流-Stream-详解"><a href="#二、Node-js-中的流-Stream-详解" class="headerlink" title="二、Node.js 中的流(Stream)详解"></a>二、Node.js 中的流(Stream)详解</h2><h3 id="1-四种流类型"><a href="#1-四种流类型" class="headerlink" title="1. 四种流类型"></a>1. 四种流类型</h3><table>
<thead>
<tr>
<th align="left">流类型</th>
<th align="left">描述</th>
<th align="left">示例场景</th>
<th align="left">关键方法&#x2F;事件</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>Readable</strong></td>
<td align="left">可读数据源</td>
<td align="left">文件读取、HTTP请求</td>
<td align="left"><code>read()</code>, <code>data</code>, <code>end</code></td>
</tr>
<tr>
<td align="left"><strong>Writable</strong></td>
<td align="left">可写数据目标</td>
<td align="left">文件写入、HTTP响应</td>
<td align="left"><code>write()</code>, <code>end</code>, <code>drain</code></td>
</tr>
<tr>
<td align="left"><strong>Duplex</strong></td>
<td align="left">双向流(可读可写)</td>
<td align="left">TCP套接字、WebSocket</td>
<td align="left">兼具读写方法</td>
</tr>
<tr>
<td align="left"><strong>Transform</strong></td>
<td align="left">转换流(读写+数据处理)</td>
<td align="left">压缩&#x2F;加密流</td>
<td align="left"><code>_transform()</code>, <code>_flush</code></td>
</tr>
</tbody></table>
<h3 id="2-流的工作模式"><a href="#2-流的工作模式" class="headerlink" title="2. 流的工作模式"></a>2. 流的工作模式</h3><p>javascript</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">const fs = require(&#x27;fs&#x27;);</span><br><span class="line"></span><br><span class="line">// 创建可读流</span><br><span class="line">const readable = fs.createReadStream(&#x27;input.txt&#x27;);</span><br><span class="line"></span><br><span class="line">// 创建可写流</span><br><span class="line">const writable = fs.createWriteStream(&#x27;output.txt&#x27;);</span><br><span class="line"></span><br><span class="line">// 管道连接（自动处理背压）</span><br><span class="line">readable.pipe(writable);</span><br><span class="line"></span><br><span class="line">// 手动处理数据块</span><br><span class="line">readable.on(&#x27;data&#x27;, (chunk) =&gt; &#123;</span><br><span class="line">  console.log(`Received $&#123;chunk.length&#125; bytes`);</span><br><span class="line">  writable.write(chunk);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">readable.on(&#x27;end&#x27;, () =&gt; &#123;</span><br><span class="line">  writable.end();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="三、Node-js-中的缓冲区-Buffer"><a href="#三、Node-js-中的缓冲区-Buffer" class="headerlink" title="三、Node.js 中的缓冲区(Buffer)"></a>三、Node.js 中的缓冲区(Buffer)</h2><h3 id="1-Buffer-核心特性"><a href="#1-Buffer-核心特性" class="headerlink" title="1. Buffer 核心特性"></a>1. Buffer 核心特性</h3><ul>
<li><strong>二进制容器</strong>：存储原始二进制数据</li>
<li><strong>固定大小</strong>：创建时分配固定内存</li>
<li><strong>高效操作</strong>：提供多种数据操作API</li>
</ul>
<h3 id="2-常见使用场景"><a href="#2-常见使用场景" class="headerlink" title="2. 常见使用场景"></a>2. 常见使用场景</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// 创建Buffer</span><br><span class="line">const buf1 = Buffer.alloc(10); // 10字节缓冲区</span><br><span class="line">const buf2 = Buffer.from(&#x27;Hello&#x27;); // 从字符串创建</span><br><span class="line"></span><br><span class="line">// 写入数据</span><br><span class="line">buf1.write(&#x27;Node.js&#x27;);</span><br><span class="line"></span><br><span class="line">// 读取数据</span><br><span class="line">console.log(buf1.toString(&#x27;utf8&#x27;, 0, 6)); // &quot;Node.j&quot;</span><br><span class="line"></span><br><span class="line">// 与流交互</span><br><span class="line">readable.on(&#x27;data&#x27;, (chunk) =&gt; &#123;</span><br><span class="line">  // chunk是Buffer实例</span><br><span class="line">  console.log(chunk.toString());</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="3-Buffer-与-Stream-的关系"><a href="#3-Buffer-与-Stream-的关系" class="headerlink" title="3. Buffer 与 Stream 的关系"></a>3. Buffer 与 Stream 的关系</h3><ul>
<li><p>流处理的数据块默认是Buffer类型</p>
</li>
<li><p>可设置流编码直接处理字符串：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">readable.setEncoding(&#x27;utf8&#x27;);</span><br><span class="line">readable.on(&#x27;data&#x27;, (str) =&gt; &#123;</span><br><span class="line">  // 现在chunk是字符串</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="四、浏览器中的-Blob"><a href="#四、浏览器中的-Blob" class="headerlink" title="四、浏览器中的 Blob"></a>四、浏览器中的 Blob</h2><h3 id="1-Blob-核心特性"><a href="#1-Blob-核心特性" class="headerlink" title="1. Blob 核心特性"></a>1. Blob 核心特性</h3><ul>
<li><strong>类文件对象</strong>：表示原始数据</li>
<li><strong>不可变性</strong>：创建后内容不可更改</li>
<li><strong>浏览器专用</strong>：Node.js 中不可用</li>
</ul>
<h3 id="2-常见使用场景-1"><a href="#2-常见使用场景-1" class="headerlink" title="2. 常见使用场景"></a>2. 常见使用场景</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// 创建Blob</span><br><span class="line">const blob = new Blob([&#x27;Hello, world!&#x27;], &#123; type: &#x27;text/plain&#x27; &#125;);</span><br><span class="line"></span><br><span class="line">// 读取Blob内容</span><br><span class="line">const reader = new FileReader();</span><br><span class="line">reader.onload = () =&gt; &#123;</span><br><span class="line">  console.log(reader.result); // &quot;Hello, world!&quot;</span><br><span class="line">&#125;;</span><br><span class="line">reader.readAsText(blob);</span><br><span class="line"></span><br><span class="line">// 创建URL</span><br><span class="line">const url = URL.createObjectURL(blob);</span><br><span class="line">const a = document.createElement(&#x27;a&#x27;);</span><br><span class="line">a.href = url;</span><br><span class="line">a.download = &#x27;example.txt&#x27;;</span><br><span class="line">a.click();</span><br><span class="line"></span><br><span class="line">// 切片处理大文件</span><br><span class="line">const slice = blob.slice(0, 1024); // 前1KB</span><br></pre></td></tr></table></figure>

<h2 id="五、三者对比与转换"><a href="#五、三者对比与转换" class="headerlink" title="五、三者对比与转换"></a>五、三者对比与转换</h2><h3 id="1-Node-js-环境中的转换"><a href="#1-Node-js-环境中的转换" class="headerlink" title="1. Node.js 环境中的转换"></a>1. Node.js 环境中的转换</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// Buffer 转 Blob (Node.js v15+)</span><br><span class="line">const &#123; Blob &#125; = require(&#x27;buffer&#x27;);</span><br><span class="line">const buffer = Buffer.from(&#x27;Hello&#x27;);</span><br><span class="line">const blob = new Blob([buffer]);</span><br><span class="line"></span><br><span class="line">// Stream 转 Buffer</span><br><span class="line">async function streamToBuffer(stream) &#123;</span><br><span class="line">  const chunks = [];</span><br><span class="line">  for await (const chunk of stream) &#123;</span><br><span class="line">    chunks.push(chunk);</span><br><span class="line">  &#125;</span><br><span class="line">  return Buffer.concat(chunks);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-浏览器环境中的转换"><a href="#2-浏览器环境中的转换" class="headerlink" title="2. 浏览器环境中的转换"></a>2. 浏览器环境中的转换</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// Blob 转 ReadableStream</span><br><span class="line">const readableStream = blob.stream();</span><br><span class="line"></span><br><span class="line">// Fetch 响应转 Blob</span><br><span class="line">fetch(&#x27;image.png&#x27;)</span><br><span class="line">  .then(response =&gt; response.blob())</span><br><span class="line">  .then(blob =&gt; &#123;</span><br><span class="line">    // 使用Blob</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<h1 id="Express、Koa-和-Egg-js"><a href="#Express、Koa-和-Egg-js" class="headerlink" title="Express、Koa 和 Egg.js"></a>Express、Koa 和 Egg.js</h1><p>是 Node.js 生态中三个重要的 Web 框架，它们在设计理念、底层原理和适用场景上有显著差异。以下从核心原理、异步处理、中间件机制、架构设计和适用场景等维度进行综合对比：</p>
<hr>
<h3 id="⚙️-一、核心原理与异步处理"><a href="#⚙️-一、核心原理与异步处理" class="headerlink" title="⚙️ 一、核心原理与异步处理"></a>⚙️ 一、<strong>核心原理与异步处理</strong></h3><ol>
<li><strong>Express</strong><ul>
<li><strong>回调驱动</strong>：基于回调函数处理异步，易导致“回调地狱”（Callback Hell）17。</li>
<li><strong>线性模型</strong>：中间件顺序执行，<code>next()</code> 仅触发下一个中间件，但无法等待后续中间件完成再回溯78。</li>
<li><strong>响应时机</strong>：调用 <code>res.send()</code> 立即结束响应，后续中间件无法修改响应38。</li>
</ul>
</li>
<li><strong>Koa（Koa2）</strong><ul>
<li><strong>Async&#x2F;Await 驱动</strong>：基于 Promise 和 Async&#x2F;Await，支持同步化书写异步代码16。</li>
<li><strong>洋葱模型</strong>：通过 <code>await next()</code> 控制流程，中间件执行两次（请求 → 响应），支持后置处理（如日志记录）18。</li>
<li><strong>延迟响应</strong>：<code>ctx.body</code> 设置响应数据，但实际响应在所有中间件完成后由 Koa 触发38。</li>
</ul>
</li>
<li><strong>Egg.js</strong><ul>
<li><strong>基于 Koa 封装</strong>：继承 Koa 的洋葱模型，但扩展了企业级特性（如插件化、约定式配置）4。</li>
<li><strong>异步处理</strong>：沿用 Async&#x2F;Await，但通过 <code>app/extend</code> 扩展上下文（Context），提供更多工具方法4。</li>
</ul>
</li>
</ol>
<hr>
<h3 id="🔄-二、中间件机制"><a href="#🔄-二、中间件机制" class="headerlink" title="🔄 二、中间件机制"></a>🔄 二、<strong>中间件机制</strong></h3><table>
<thead>
<tr>
<th align="left"><strong>框架</strong></th>
<th align="left"><strong>执行模型</strong></th>
<th align="left"><strong>特点</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>Express</strong></td>
<td align="left">线性模型</td>
<td align="left">中间件顺序执行，无回溯机制；依赖 <code>next()</code> 手动传递控制权78。</td>
</tr>
<tr>
<td align="left"><strong>Koa</strong></td>
<td align="left">洋葱模型</td>
<td align="left">中间件双向执行（请求向下 → 响应向上），支持异步等待回溯18。</td>
</tr>
<tr>
<td align="left"><strong>Egg</strong></td>
<td align="left">洋葱模型（增强版）</td>
<td align="left">继承 Koa 模型，但通过中间件加载顺序和插件机制提供更精细控制4。</td>
</tr>
</tbody></table>
<p><strong>示例对比</strong>：</p>
<p>javascript</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// Express：next() 后无法再次操作响应</span><br><span class="line">app.use((req, res, next) =&gt; &#123;</span><br><span class="line">  console.log(&quot;Start&quot;);</span><br><span class="line">  next();  // 移交控制权</span><br><span class="line">  console.log(&quot;End&quot;);  // 在响应发送后执行</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// Koa：await next() 可等待后续中间件完成</span><br><span class="line">app.use(async (ctx, next) =&gt; &#123;</span><br><span class="line">  console.log(&quot;Start&quot;);</span><br><span class="line">  await next();  // 等待下游中间件执行完毕</span><br><span class="line">  console.log(&quot;End&quot;);  // 响应前可再次修改 ctx</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="🏗️-三、架构设计与扩展性"><a href="#🏗️-三、架构设计与扩展性" class="headerlink" title="🏗️ 三、架构设计与扩展性"></a>🏗️ 三、<strong>架构设计与扩展性</strong></h3><ol>
<li><strong>Express</strong><ul>
<li><strong>大而全</strong>：内置路由、模板引擎、静态文件服务等，开箱即用26。</li>
<li><strong>弱扩展性</strong>：缺少统一的扩展机制，依赖第三方中间件组合6。</li>
</ul>
</li>
<li><strong>Koa</strong><ul>
<li><strong>极简内核</strong>：仅封装 HTTP 上下文（Context），不内置任何中间件（路由需通过 <code>koa-router</code> 添加）26。</li>
<li><strong>高扩展性</strong>：通过 <code>app.context</code> 可灵活扩展全局属性6。</li>
</ul>
</li>
<li><strong>Egg.js</strong><ul>
<li><strong>企业级框架</strong>：基于 Koa 封装，提供插件化架构、约定式目录结构和配置管理4。</li>
<li><strong>扩展点丰富</strong>：支持 <code>app/extend/&#123;application, context, request, response&#125;</code> 扩展原型4。</li>
</ul>
</li>
</ol>
<hr>
<h3 id="🛡️-四、错误处理"><a href="#🛡️-四、错误处理" class="headerlink" title="🛡️ 四、错误处理"></a>🛡️ 四、<strong>错误处理</strong></h3><ul>
<li><p><strong>Express</strong>：需手动捕获异步错误，或在中间件末尾添加错误处理函数7。</p>
</li>
<li><p><strong>Koa</strong>：可通过顶层 <code>try/catch</code> 捕获整个洋葱模型的同步&#x2F;异步错误18：</p>
<p>javascript</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.use(async (ctx, next) =&gt; &#123;</span><br><span class="line">  try &#123; await next(); &#125;</span><br><span class="line">  catch (err) &#123; ctx.status = 500; &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Egg.js</strong>：内置统一错误处理，支持配置错误页面和日志上报4。</p>
</li>
</ul>
<hr>
<h3 id="🎯-五、适用场景总结"><a href="#🎯-五、适用场景总结" class="headerlink" title="🎯 五、适用场景总结"></a>🎯 五、<strong>适用场景总结</strong></h3><table>
<thead>
<tr>
<th align="left"><strong>框架</strong></th>
<th align="left"><strong>场景</strong></th>
<th align="left"><strong>代表用户</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>Express</strong></td>
<td align="left">中小项目快速开发；需兼容旧版 Node.js 或回调风格</td>
<td align="left">传统企业、遗留系统</td>
</tr>
<tr>
<td align="left"><strong>Koa</strong></td>
<td align="left">追求现代异步编程；高自由度定制中间件栈</td>
<td align="left">技术前沿团队、开源项目</td>
</tr>
<tr>
<td align="left"><strong>Egg.js</strong></td>
<td align="left">大型企业应用；需插件化管理、团队协作规范</td>
<td align="left">阿里系产品（如蚂蚁金服）</td>
</tr>
</tbody></table>
<hr>
<h3 id="💎-三框架核心区别总结"><a href="#💎-三框架核心区别总结" class="headerlink" title="💎 三框架核心区别总结"></a>💎 <strong>三框架核心区别总结</strong></h3><table>
<thead>
<tr>
<th align="left"><strong>特性</strong></th>
<th align="left"><strong>Express</strong></th>
<th align="left"><strong>Koa</strong></th>
<th align="left"><strong>Egg.js</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>异步模型</strong></td>
<td align="left">回调函数</td>
<td align="left">Async&#x2F;Await</td>
<td align="left">Async&#x2F;Await</td>
</tr>
<tr>
<td align="left"><strong>中间件机制</strong></td>
<td align="left">线性执行</td>
<td align="left">洋葱模型</td>
<td align="left">洋葱模型（增强）</td>
</tr>
<tr>
<td align="left"><strong>路由&#x2F;视图</strong></td>
<td align="left">内置支持</td>
<td align="left">需插件</td>
<td align="left">内置 + 插件扩展</td>
</tr>
<tr>
<td align="left"><strong>扩展性</strong></td>
<td align="left">低（依赖中间件）</td>
<td align="left">高（自由组合）</td>
<td align="left">极高（插件化）</td>
</tr>
<tr>
<td align="left"><strong>适用规模</strong></td>
<td align="left">中小项目</td>
<td align="left">中小到大型</td>
<td align="left">中大型企业级</td>
</tr>
<tr>
<td align="left"><strong>学习曲线</strong></td>
<td align="left">低</td>
<td align="left">中</td>
<td align="left">中高</td>
</tr>
</tbody></table>
<h1 id="Node-js-全局对象与全局变量详解"><a href="#Node-js-全局对象与全局变量详解" class="headerlink" title="Node.js 全局对象与全局变量详解"></a>Node.js 全局对象与全局变量详解</h1><h2 id="Node-js-全局对象概览"><a href="#Node-js-全局对象概览" class="headerlink" title="Node.js 全局对象概览"></a>Node.js 全局对象概览</h2><p>Node.js 中的全局对象 <code>global</code> 类似于浏览器中的 <code>window</code> 对象，提供对全局变量和函数的访问。以下是核心全局对象和变量：</p>
<h3 id="全局对象"><a href="#全局对象" class="headerlink" title="全局对象"></a>全局对象</h3><table>
<thead>
<tr>
<th align="left">对象名称</th>
<th align="left">描述</th>
<th align="left">使用示例</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>global</code></td>
<td align="left">顶层全局对象，所有全局变量都是它的属性</td>
<td align="left"><code>global.console.log()</code></td>
</tr>
<tr>
<td align="left"><code>process</code></td>
<td align="left">提供当前 Node.js 进程的信息和控制</td>
<td align="left"><code>process.env.NODE_ENV</code></td>
</tr>
<tr>
<td align="left"><code>console</code></td>
<td align="left">提供调试输出功能</td>
<td align="left"><code>console.error(&#39;Error!&#39;)</code></td>
</tr>
<tr>
<td align="left"><code>Buffer</code></td>
<td align="left">处理二进制数据的类</td>
<td align="left"><code>Buffer.from(&#39;hello&#39;)</code></td>
</tr>
<tr>
<td align="left"><code>module</code></td>
<td align="left">当前模块的引用</td>
<td align="left"><code>module.exports = &#123;&#125;</code></td>
</tr>
<tr>
<td align="left"><code>exports</code></td>
<td align="left"><code>module.exports</code> 的引用</td>
<td align="left"><code>exports.func = () =&gt; &#123;&#125;</code></td>
</tr>
<tr>
<td align="left"><code>require()</code></td>
<td align="left">引入模块的函数</td>
<td align="left"><code>const fs = require(&#39;fs&#39;)</code></td>
</tr>
</tbody></table>
<h3 id="全局变量"><a href="#全局变量" class="headerlink" title="全局变量"></a>全局变量</h3><table>
<thead>
<tr>
<th align="left">变量名称</th>
<th align="left">描述</th>
<th align="left">使用示例</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>__filename</code></td>
<td align="left">当前模块文件的绝对路径</td>
<td align="left"><code>console.log(__filename)</code></td>
</tr>
<tr>
<td align="left"><code>__dirname</code></td>
<td align="left">当前模块所在目录的绝对路径</td>
<td align="left"><code>console.log(__dirname)</code></td>
</tr>
<tr>
<td align="left"><code>setTimeout</code></td>
<td align="left">定时执行函数</td>
<td align="left"><code>setTimeout(fn, 1000)</code></td>
</tr>
<tr>
<td align="left"><code>setInterval</code></td>
<td align="left">定时循环执行函数</td>
<td align="left"><code>setInterval(fn, 1000)</code></td>
</tr>
<tr>
<td align="left"><code>setImmediate</code></td>
<td align="left">在当前事件循环结束时执行函数</td>
<td align="left"><code>setImmediate(fn)</code></td>
</tr>
<tr>
<td align="left"><code>clearTimeout</code></td>
<td align="left">取消由 <code>setTimeout()</code> 创建的定时器</td>
<td align="left"><code>clearTimeout(timer)</code></td>
</tr>
<tr>
<td align="left"><code>clearInterval</code></td>
<td align="left">取消由 <code>setInterval()</code> 创建的定时器</td>
<td align="left"><code>clearInterval(timer)</code></td>
</tr>
<tr>
<td align="left"><code>clearImmediate</code></td>
<td align="left">取消由 <code>setImmediate()</code> 创建的定时器</td>
<td align="left"><code>clearImmediate(timer)</code></td>
</tr>
</tbody></table>
<h1 id="CommonJS和ES6-Module的区别时"><a href="#CommonJS和ES6-Module的区别时" class="headerlink" title="CommonJS和ES6 Module的区别时"></a>CommonJS和ES6 Module的区别时</h1><p>我们可以归纳出以下几点：</p>
<ol>
<li><strong>语法差异</strong>：CommonJS使用<code>require</code>和<code>module.exports</code>，ES6 Module使用<code>import</code>和<code>export</code>。</li>
<li><strong>加载机制</strong>：CommonJS是运行时加载，ES6 Module是静态加载。</li>
<li><strong>值的处理</strong>：CommonJS导出的是值的拷贝，ES6 Module导出的是值的引用。</li>
<li><strong>模块对象</strong>：CommonJS使用<code>module.exports</code>，ES6 Module使用<code>export</code>。</li>
<li><strong>this指向</strong>：CommonJS中的<code>this</code>指向模块对象，而ES6 Module中的<code>this</code>是<code>undefined</code>。</li>
<li><strong>文件扩展名</strong>：CommonJS可以省略<code>.js</code>，而ES6 Module必须带扩展名。</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/06/29/Node/" data-id="cmcygiiyo0003vgur37og0cy7" data-title="Node" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Node-js/" rel="tag">Node.js</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-前端工程化" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/06/29/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96/" class="article-date">
  <time class="dt-published" datetime="2025-06-29T09:09:27.000Z" itemprop="datePublished">2025-06-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/06/29/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96/">前端工程化</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="npm、yarn-和-pnpm"><a href="#npm、yarn-和-pnpm" class="headerlink" title="npm、yarn 和 pnpm"></a><code>npm</code>、<code>yarn</code> 和 <code>pnpm</code></h1><hr>
<p> <strong>一、技术原理与核心区别</strong></p>
<ol>
<li><strong>依赖管理机制</strong></li>
</ol>
<ul>
<li><strong>npm</strong><ul>
<li><strong>嵌套结构（v2）</strong>：依赖树深层嵌套，相同依赖重复安装，路径过长易超 Windows 限制。</li>
<li><strong>扁平化（v3+）</strong>：依赖提升至顶层，减少重复。但多个版本时仅提升一个，其余版本仍嵌套安装，导致 <strong>依赖分身</strong>（同一包多版本重复存储）。</li>
</ul>
</li>
<li><strong>yarn</strong><ul>
<li><strong>扁平化 + 缓存</strong>：依赖提升至顶层，通过 <code>yarn.lock</code> 锁定版本；并行下载加速安装，缓存机制减少重复下载26。</li>
<li><strong>问题未根治</strong>：仍存在 <strong>幽灵依赖</strong>（未声明的依赖因提升被访问）和 <strong>依赖分身</strong>。</li>
</ul>
</li>
<li><strong>pnpm</strong><ul>
<li><strong>硬链接 + 符号链接</strong>：<ul>
<li><strong>全局存储</strong>（<code>~/.pnpm-store</code>）：每个依赖版本仅存一份。</li>
<li><strong>硬链接</strong>：项目中的依赖通过硬链接指向全局存储，避免磁盘冗余。</li>
<li><strong>符号链接</strong>：<code>node_modules</code> 中只包含直接依赖的符号链接，子依赖通过 <code>.pnpm</code> 目录的软链接组织，严格隔离依赖。</li>
</ul>
</li>
</ul>
</li>
</ul>
<ol start="2">
<li><strong>性能与磁盘效率</strong></li>
</ol>
<table>
<thead>
<tr>
<th align="left">工具</th>
<th align="left">安装速度</th>
<th align="left">磁盘占用</th>
<th align="left">原理优化</th>
</tr>
</thead>
<tbody><tr>
<td align="left">npm</td>
<td align="left">⚠️ 慢（串行）</td>
<td align="left">❌ 高（重复存储）</td>
<td align="left">扁平化减少嵌套问题</td>
</tr>
<tr>
<td align="left">yarn</td>
<td align="left">✅ 快（并行）</td>
<td align="left">⚠️ 中（缓存共享）</td>
<td align="left">并行下载 + 缓存复用</td>
</tr>
<tr>
<td align="left">pnpm</td>
<td align="left">✅ 极快（链接）</td>
<td align="left">✅ 低（全局单份存储）</td>
<td align="left">硬链接 + 符号链接</td>
</tr>
</tbody></table>
<ol start="3">
<li><strong>安全性 &amp; 一致性</strong></li>
</ol>
<ul>
<li><strong>锁定文件</strong>：<ul>
<li><code>npm</code>：<code>package-lock.json</code>（锁定版本，但早期版本存在安全漏洞）。</li>
<li><code>yarn/pnpm</code>：<code>yarn.lock</code>&#x2F;<code>pnpm-lock.yaml</code>（严格锁定版本及哈希值，防篡改）。</li>
</ul>
</li>
<li><strong>依赖隔离</strong>：<ul>
<li><code>pnpm</code> 仅允许访问显式声明的依赖，彻底杜绝幽灵依赖；<code>npm/yarn</code> 因扁平化无法解决。</li>
</ul>
</li>
</ul>
<hr>
<p> <strong>二、依然存在的问题</strong></p>
<ol>
<li><strong>npm</strong></li>
</ol>
<ul>
<li><strong>依赖不确定性</strong>：扁平化导致依赖结构因安装顺序差异可能不同，需依赖 <code>package-lock.json</code> 补救36。</li>
<li><strong>磁盘冗余</strong>：相同依赖在不同项目中重复存储。</li>
</ul>
<ol start="2">
<li><strong>yarn</strong></li>
</ol>
<ul>
<li><strong>幽灵依赖</strong>：未声明的依赖仍可访问，移除父依赖后可能引发运行时错误58。</li>
<li><strong>依赖分身</strong>：多版本包的非提升版本仍重复安装。</li>
</ul>
<ol start="3">
<li><strong>pnpm</strong></li>
</ol>
<ul>
<li><strong>软链接兼容性</strong>：<ul>
<li>不支持软链接的环境（如部分 Electron 应用、Windows 受限模式）无法使用。</li>
</ul>
</li>
<li><strong>调试与补丁困难</strong>：<ul>
<li>依赖源文件在全局存储，修改需通过 <code>pnpm patch</code> 命令，不如直接修改 <code>node_modules</code> 直观。</li>
</ul>
</li>
<li><strong>生态兼容性</strong>：<ul>
<li>少数依赖路径硬编码的包（如某些 Webpack 插件）可能运行失败</li>
</ul>
</li>
</ul>
<h1 id="webpack"><a href="#webpack" class="headerlink" title="webpack"></a>webpack</h1><p><strong>Webpack是基于模块化打包的⼯具:</strong> ⾃动化处理模块，webpack把⼀切当成模块，当 webpack 处理应⽤程序时，它会递归地构建⼀个依赖关系图 (dependency graph)，其中包含应⽤程序需要的每个模块，然后将所有这些模块打包成⼀个或多个 bundle。 </p>
<h3 id="webpack的构建流程"><a href="#webpack的构建流程" class="headerlink" title="webpack的构建流程**?**"></a><strong>webpack</strong>的构建流程**?**</h3><p>Webpack 的运⾏流程是⼀个串⾏的过程，从启动到结束会依次执⾏以下流程： </p>
<ol>
<li><strong>初始化参数</strong>：从配置⽂件和 Shell 语句中读取与合并参数，得出最终的参数； </li>
<li><strong>开始编译</strong>：⽤上⼀步得到的参数初始化 Compiler 对象，加载所有配置的插件，执⾏对象的 run ⽅法开始执⾏编译； </li>
<li><strong>确定⼊⼝</strong>：根据配置中的 entry 找出所有的⼊⼝⽂件； </li>
<li><strong>编译模块</strong>：从⼊⼝⽂件出发，调⽤所有配置的 Loader 对模块进⾏翻译，再找出该模块依赖的模块，再递归本步骤直到所有⼊⼝依赖的⽂件都经过了本步骤的处理； </li>
<li><strong>完成模块编译</strong>：在经过第4步使⽤ Loader 翻译完所有模块后，得到了每个模块被翻译后的最终内容以及它们之间的依赖关系； </li>
<li><strong>输出资源</strong>：根据⼊⼝和模块之间的依赖关系，组装成⼀个个包含多个模块的 Chunk，再把每个 Chunk 转换成⼀个单独的⽂件加⼊到输出列表，这步是可以修改输出内容的最后机会； </li>
<li><strong>输出完成</strong>：在确定好输出内容后，根据配置确定输出的路径和⽂件名，把⽂件内容写⼊到⽂件系统。</li>
</ol>
<p>在以上过程中，Webpack 会在特定的时间点⼴播出特定的事件，插件在监听到感兴趣的事件后会执⾏特定的逻辑，并且插件可以调⽤ Webpack 提供的 API 改变 Webpack 的运⾏结果。</p>
<h3 id="常⻅的Loader"><a href="#常⻅的Loader" class="headerlink" title="常⻅的Loader"></a>常⻅的<strong>Loader</strong></h3><ul>
<li>file-loader：把⽂件输出到⼀个⽂件夹中，在代码中通过相对 URL 去引⽤输出的⽂件 </li>
<li>url-loader：和 file-loader 类似，但是能在⽂件很⼩的情况下以 base64 的⽅式把⽂件内容注⼊到代码中去 </li>
<li>source-map-loader：加载额外的 Source Map ⽂件，以⽅便断点调试 </li>
<li>image-loader：加载并且压缩图⽚⽂件 </li>
<li>babel-loader：把 ES6 转换成 ES5 </li>
<li>css-loader：加载 CSS，⽀持模块化、压缩、⽂件导⼊等特性 </li>
<li>style-loader：把 CSS 代码注⼊到 JavaScript 中，通过 DOM 操作去加载 CSS。 </li>
<li>eslint-loader：通过 ESLint 检查 JavaScript 代码</li>
</ul>
<p><strong>注意：<strong>在Webpack中，loader的执行顺序是</strong>从右向左</strong>执行的。因为webpack选择了<strong>compose这样的函数式编程方式</strong>，这种方式的表达式执行是从右向左的。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">    <span class="attr">rules</span>: [</span><br><span class="line">      <span class="comment">// 处理 JavaScript/TypeScript 文件</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.(js|jsx|ts|tsx)$/</span>,</span><br><span class="line">        <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        <span class="attr">use</span>: &#123;</span><br><span class="line">          <span class="attr">loader</span>: <span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">          <span class="attr">options</span>: &#123;</span><br><span class="line">            <span class="attr">presets</span>: [<span class="string">&#x27;@babel/preset-env&#x27;</span>, <span class="string">&#x27;@babel/preset-react&#x27;</span>]</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// 处理 CSS 文件</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        <span class="attr">use</span>: [<span class="string">&#x27;style-loader&#x27;</span>, <span class="string">&#x27;css-loader&#x27;</span>] <span class="comment">// 从右到左执行</span></span><br><span class="line">      &#125;,</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// 处理 SCSS 文件</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.scss$/</span>,</span><br><span class="line">        <span class="attr">use</span>: [<span class="string">&#x27;style-loader&#x27;</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;sass-loader&#x27;</span>]</span><br><span class="line">      &#125;,</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// 处理图片文件</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.(png|jpe?g|gif|svg)$/</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;asset/resource&#x27;</span>,</span><br><span class="line">        <span class="attr">generator</span>: &#123;</span><br><span class="line">          <span class="attr">filename</span>: <span class="string">&#x27;images/[hash][ext][query]&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// 处理字体文件</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.(woff|woff2|eot|ttf|otf)$/</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;asset/resource&#x27;</span>,</span><br><span class="line">        <span class="attr">generator</span>: &#123;</span><br><span class="line">          <span class="attr">filename</span>: <span class="string">&#x27;fonts/[hash][ext][query]&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="常⻅的Plugin"><a href="#常⻅的Plugin" class="headerlink" title="常⻅的Plugin"></a>常⻅的<strong>Plugin</strong></h3><ul>
<li>define-plugin：定义环境变量 </li>
<li>html-webpack-plugin：简化html⽂件创建 </li>
<li>uglifyjs-webpack-plugin：通过 UglifyES 压缩 ES6 代码 </li>
<li>webpack-parallel-uglify-plugin: 多核压缩，提⾼压缩速度 </li>
<li>webpack-bundle-analyzer: 可视化webpack输出⽂件的体积 </li>
<li>mini-css-extract-plugin: CSS提取到单独的⽂件中，⽀持按需加载</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">HtmlWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">CleanWebpackPlugin</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;clean-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MiniCssExtractPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;mini-css-extract-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">BundleAnalyzerPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;webpack-bundle-analyzer&#x27;</span>).<span class="property">BundleAnalyzerPlugin</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="comment">// 自动清理输出目录</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">CleanWebpackPlugin</span>(),</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 自动生成 HTML 文件并注入打包后的资源</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>(&#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;My App&#x27;</span>,</span><br><span class="line">      <span class="attr">template</span>: <span class="string">&#x27;./src/index.html&#x27;</span></span><br><span class="line">    &#125;),</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 提取 CSS 到单独文件</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">MiniCssExtractPlugin</span>(&#123;</span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&#x27;css/[name].[contenthash:8].css&#x27;</span></span><br><span class="line">    &#125;),</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 打包分析工具</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">BundleAnalyzerPlugin</span>(&#123;</span><br><span class="line">      <span class="attr">analyzerMode</span>: <span class="string">&#x27;disabled&#x27;</span>, <span class="comment">// 不自动打开</span></span><br><span class="line">      <span class="attr">generateStatsFile</span>: <span class="literal">true</span> <span class="comment">// 生成 stats.json 文件</span></span><br><span class="line">    &#125;),</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 定义环境变量</span></span><br><span class="line">    <span class="keyword">new</span> webpack.<span class="title class_">DefinePlugin</span>(&#123;</span><br><span class="line">      <span class="string">&#x27;process.env.NODE_ENV&#x27;</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(process.<span class="property">env</span>.<span class="property">NODE_ENV</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="Tree-shaking-基本原理"><a href="#Tree-shaking-基本原理" class="headerlink" title="Tree shaking 基本原理"></a>Tree shaking 基本原理</h3><ol>
<li><strong>静态分析</strong>：<ul>
<li>在编译阶段（而非运行时）分析代码的导入导出关系</li>
<li>通过 ES6 模块的静态结构特性（<code>import/export</code> 必须在顶层作用域）实现</li>
</ul>
</li>
<li><strong>标记-清除</strong>过程：<ul>
<li><strong>标记阶段</strong>：从入口文件开始，标记所有被使用的导出</li>
<li><strong>清除阶段</strong>：删除所有未被标记的导出代码</li>
</ul>
</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;production&#x27;</span>, <span class="comment">// 生产模式自动开启 Tree Shaking</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">optimization</span>: &#123;</span><br><span class="line">    <span class="attr">usedExports</span>: <span class="literal">true</span>, <span class="comment">// 标记未使用的导出</span></span><br><span class="line">    <span class="attr">minimize</span>: <span class="literal">true</span>,    <span class="comment">// 启用代码压缩</span></span><br><span class="line">    <span class="attr">minimizer</span>: [</span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">TerserPlugin</span>(), <span class="comment">// 使用 Terser 进行压缩</span></span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">CssMinimizerPlugin</span>() <span class="comment">// 压缩 CSS</span></span><br><span class="line">    ],</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 代码分割配置</span></span><br><span class="line">    <span class="attr">splitChunks</span>: &#123;</span><br><span class="line">      <span class="attr">chunks</span>: <span class="string">&#x27;all&#x27;</span>,</span><br><span class="line">      <span class="attr">cacheGroups</span>: &#123;</span><br><span class="line">        <span class="attr">vendors</span>: &#123;</span><br><span class="line">          <span class="attr">test</span>: <span class="regexp">/[\\/]node_modules[\\/]/</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;vendors&#x27;</span>,</span><br><span class="line">          <span class="attr">chunks</span>: <span class="string">&#x27;all&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>





<h2 id="前端工程化"><a href="#前端工程化" class="headerlink" title="前端工程化"></a>前端工程化</h2><blockquote>
<p>首先这就涉及到我们程序员编写代码的思路和方式了</p>
</blockquote>
<blockquote>
<p>我们都喜欢多模块，SASS&#x2F;LESS预编译器，前沿语法，前言API，命名友好，资源分组，有注释的方式</p>
</blockquote>
<blockquote>
<p>而浏览器喜欢的是少量文件，CSS，兼容语法，兼容API，单字节命名，资源集中，无注释的方式。</p>
</blockquote>
<p><img src="https://ucc.alicdn.com/pic/developer-ecology/c7qqzppjlk64c_4fa1deb056684296a4303053b7227c8b.png" alt="image"></p>
<blockquote>
<p>所以我们前端工程化的意义和作用就来了。使用webpack和vite来帮助我们把我们写的代码转换成浏览器能够读写的模式。让我们可以随意的编写我们喜欢的格式的代码</p>
</blockquote>
<h2 id="webpack的构建流程-1"><a href="#webpack的构建流程-1" class="headerlink" title="webpack的构建流程"></a>webpack的构建流程</h2><p><img src="https://ucc.alicdn.com/pic/developer-ecology/c7qqzppjlk64c_4cedd31a7a1444e0a62cfd5ae7ae2b94.png" alt="image"></p>
<ul>
<li><strong>初始化参数：</strong> 从配置文件和shell语句中读取合并参数，得出最终的配置参数。</li>
<li><strong>开始编译：</strong> 从上一步得到的参数初始化compiler对象，加载所有配置插件，执行对象的run方法开始编译</li>
<li><strong>确定入口：</strong> 通过entry找出入口文件</li>
<li><strong>编译模块：</strong> 从入口文件出发，调用所有配置的 <code>loader</code> 对模块进行翻译，再找出该模块依赖的模块，这个步骤是递归执行的，直至所有入口依赖的模块文件都经过本步骤的处理。</li>
<li><strong>完成模块编译：</strong> 经过第 4 步使用 loader 翻译完所有模块后，得到了每个模块被翻译后的最终内容以及它们之间的依赖关系。</li>
<li><strong>输出资源：</strong> 根据入口和模块之间的依赖关系，组装成一个个包含多个模块的 <code>chunk</code>，再把每个 <code>chunk</code> 转换成一个单独的文件加入到输出列表，这一步是可以修改输出内容的最后机会。</li>
<li><strong>输出完成：</strong> 在确定好输出内容后，根据配置确定输出的路径和文件名，把文件内容写入到文件系统。</li>
</ul>
<p><img src="https://ucc.alicdn.com/pic/developer-ecology/c7qqzppjlk64c_846b80577af74866b212694e710cb593.png" alt="image"></p>
<h2 id="vite的构建流程"><a href="#vite的构建流程" class="headerlink" title="vite的构建流程"></a>vite的构建流程</h2><p>Vite 的构建流程与传统的打包工具（如Webpack）有所不同，主要体现在开发阶段和生产环境阶段。以下是 Vite 的构建流程：</p>
<p><strong>开发阶段：</strong></p>
<ul>
<li><strong>启动开发服务器：</strong> 当你启动 Vite 时，它会启动一个开发服务器来为你提供服务。这个开发服务器利用现代浏览器对 ES 模块的本地支持，实现了快速的冷启动和热模块替换（HMR）。</li>
<li><strong>解析并提供文件：</strong> 当浏览器请求某个文件时，Vite 会解析这个文件，并根据需要进行转换。例如，对于 Vue 单文件组件（SFC），Vite 会将其实时编译成 JavaScript，然后返回给浏览器。</li>
<li><strong>处理依赖关系：</strong> 当浏览器中的代码引入其他模块时，Vite 会分析这些依赖关系，并通过浏览器原生的 ES 模块加载功能来动态地获取这些模块。</li>
</ul>
<p><strong>生产环境阶段：</strong></p>
<ul>
<li><strong>预构建：</strong> 在生产环境中，Vite 会预先构建你的应用程序，以便在部署时能够提供尽可能高效的代码。</li>
<li><strong>优化和压缩：</strong> Vite 会对代码进行优化和压缩，以提高应用程序的性能，并生成适合生产环境部署的静态资源。</li>
<li><strong>输出：</strong> 完成构建后，Vite 会将最终的生产代码输出到指定的目录，准备用于部署到生产环境。</li>
</ul>
<h2 id="webpack和vite的对比"><a href="#webpack和vite的对比" class="headerlink" title="webpack和vite的对比"></a>webpack和vite的对比</h2><h3 id="服务器启动区别"><a href="#服务器启动区别" class="headerlink" title="服务器启动区别"></a>服务器启动区别</h3><ul>
<li><strong>wepack:</strong> 当冷启动开发服务器时，基于打包器的方式是在提供服务前去急切地抓取和构建你的整个应用。</li>
</ul>
<blockquote>
<p>而 Vite 是通过在一开始将应用中的模块区分为 <strong>依赖</strong> 和 <strong>源码</strong> 两类，改进了开发服务器启动时间。</p>
</blockquote>
<blockquote>
<p><strong>依赖</strong> 大多为纯 JavaScript 并在开发时不会变动。一些较大的依赖（例如有上百个模块的组件库）处理的代价也很高。依赖也通常会以某些方式（例如 ESM 或者 CommonJS）被拆分到大量小模块中。</p>
</blockquote>
<blockquote>
<p>Vite 将会使用 esbuild 预构建依赖。<strong>Esbuild 使用 Go 编写</strong>，并且比以 JavaScript 编写的打包器预构建依赖快 10-100 倍。</p>
</blockquote>
<blockquote>
<p>源码 通常包含一些并非直接是 <strong>JavaScript</strong> 的文件，需要转换（例如 JSX，CSS 或者 Vue&#x2F;Svelte 组件），时常会被编辑。同时，并不是所有的源码都需要同时被加载。（例如基于路由拆分的代码模块）。</p>
</blockquote>
<blockquote>
<p>Vite 以 原生 <strong>ESM</strong> 方式服务源码。这实际上是让浏览器接管了打包程序的部分工作：Vite 只需要在浏览器请求源码时进行转换并<strong>按需提供源码</strong>。根据情景动态导入的代码，即只在当前屏幕上实际使用时才会被处理。</p>
</blockquote>
<h3 id="热更新的区别"><a href="#热更新的区别" class="headerlink" title="热更新的区别"></a>热更新的区别</h3><blockquote>
<p>webpack</p>
</blockquote>
<p><strong>全局刷新：</strong> Webpack 的 HMR 通常会在代码发生变化时替换整个模块，然后通过 HMR runtime 来触发页面级别的刷新或重新渲染，这可能导致部分页面状态的丢失。</p>
<p><strong>较慢的冷启动：</strong> Webpack 的开发模式下，由于整个应用程序需要被打包和构建，因此冷启动时间相对较长，尤其是随着项目规模的增大，冷启动时间会进一步延长。</p>
<p><strong>配置复杂：</strong> 在使用 Webpack 进行 HMR 时，需要进行一定的配置，包括设置 HMR 插件、编写 HMR 相关的代码等，相对来说略显复杂。</p>
<blockquote>
<p><strong>vite</strong></p>
</blockquote>
<ul>
<li><p><strong>局部更新：</strong> Vite 的 HMR 实现了更细粒度的模块更新，可以实现局部模块的更新而无需刷新整个页面，从而减少页面状态的丢失。</p>
</li>
<li><p><strong>快速冷启动：</strong> Vite 利用现代浏览器的原生 ES 模块加载能力，实现了快速的冷启动时间，因为它不需要将整个应用程序打包成一个或多个文件。</p>
</li>
<li><p><strong>无需额外配置：</strong> 在 Vite 中，HMR 是开箱即用的，无需额外配置。Vite 会自动处理模块的更新和热替换，让开发者专注于业务逻辑的开发。</p>
</li>
</ul>
<h3 id="底层代码实现的区别？"><a href="#底层代码实现的区别？" class="headerlink" title="底层代码实现的区别？"></a>底层代码实现的区别？</h3><blockquote>
<p>webpack是用的node.js来实现的，node.js支持的生态库更多，前后端的一致性比较高，对于异步编程有着很好的支持，node.js的跨平台性比较好，在window，Mac,和linux等不同操作系统上都可以运行</p>
</blockquote>
<blockquote>
<p>vite是使用的 esbuild，esbuild 是用 Go 语言编写的，专注于快速的构建和打包，它的底层实现经过了高度优化，能够充分利用多核处理器和其他硬件资源，以及高效的算法和数据结构，从而实现了极快的构建速度。</p>
</blockquote>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><blockquote>
<p>webpack服务器启动速度比vite慢：由于vite启动的时候不需要打包，也就<strong>无需分析模块依赖、编译</strong>，所以启动速度<strong>非常快</strong>。当浏览器请求需要的模块时，再对模块进行编译，这种按需动态编译的模式，极大缩短了编译时间，当项目越大，文件越多时，vite的开发时优势越明显</p>
</blockquote>
<blockquote>
<p>vite热更新比webpack快:vite在<strong>HRM</strong>方面，当某个模块内容改变时，让浏览器去<strong>重新请求该模块</strong>即可，而不是像webpack重新将该模块的所有依赖<strong>重新编译</strong>；</p>
</blockquote>
<blockquote>
<p>vite使用<strong>esbuild(Go 编写)</strong> 预构建依赖，而webpack基于<strong>nodejs</strong>, esbuild比node快 10-100 倍</p>
</blockquote>
<blockquote>
<p>vite生态不及webpack，加载器、插件不够丰富</p>
</blockquote>
<h2 id="vite的缺点是什么？"><a href="#vite的缺点是什么？" class="headerlink" title="vite的缺点是什么？"></a>vite的缺点是什么？</h2><ul>
<li><strong>生态，生态，生态不如webpack</strong></li>
</ul>
<blockquote>
<p>wepback厉害之处在于loader和plugin非常丰富,不过我认为生态只是时间问题，现在的vite,更像是当时刚出来的M1芯片Mac，作者当时非常喜欢M1的Mac，毫不犹豫买了，现在也没什么问题，相信vite后续更新会更好</p>
</blockquote>
<ul>
<li><strong>prod环境的构建，目前用的Rollup</strong></li>
</ul>
<blockquote>
<p>原因在于esbuild对于css和代码分割不是很友好</p>
</blockquote>
<ul>
<li><strong>还没有被大规模使用,很多问题或者诉求没有真正暴露出来</strong></li>
</ul>
<blockquote>
<p>vite真正崛起那一天，是跟vue3有关系的,当vue3广泛开始使用在生产环境的时候，vite也就大概率意味着被大家慢慢开始接受了</p>
</blockquote>
<h2 id="vite一定比webpack快吗"><a href="#vite一定比webpack快吗" class="headerlink" title="vite一定比webpack快吗?"></a>vite一定比webpack快吗?</h2><blockquote>
<p>不能说vite一定比webpack快，相对于不同的场景，webpack和vite有不同的速度优势吧。</p>
</blockquote>
<blockquote>
<p>vite相对于webpack在开发环境下有着更快的启动速度，因为vite底层是用的esbuild,这种设计使得 Vite 能够以非常低的延迟启动开发服务器，并且在修改文件时能够实现近乎即时的重新加载。</p>
</blockquote>
<blockquote>
<p>然而，在生产环境中，Vite 和 Webpack 的性能差异可能会变得不那么明显。Webpack 通过使用高度优化的构建算法和各种插件来提供出色的打包性能，尤其适用于复杂的项目和大规模的应用程序。</p>
</blockquote>
<blockquote>
<p>因此，是否可以说 Vite 一定比 Webpack 快，取决于具体的使用场景和项目需求。对于简单的小型项目，特别是新项目，Vite 通常会具有更快的启动和开发速度。而对于复杂的项目或需要更多自定义配置和功能的情况，Webpack 可能会更适合，因为它提供了更多的灵活性和扩展性。</p>
</blockquote>
<h2 id="后言"><a href="#后言" class="headerlink" title="后言"></a>后言</h2><h1 id="Babel的原理"><a href="#Babel的原理" class="headerlink" title="Babel的原理"></a><strong>Babel</strong>的原理</h1><p>babel 的转译过程也分为三个阶段，这三步具体是： </p>
<ul>
<li><strong>解析 Parse</strong>: 将代码解析⽣成抽象语法树（AST），即词法分析与语法分析的过程；</li>
<li><strong>转换 Transform</strong>: 对于 AST 进⾏变换⼀系列的操作，babel 接受得到 AST 并通过 babel-traverse 对其进⾏遍历，在此过程中进⾏添加、更新及移除等操作；</li>
<li><strong>⽣成 Generate</strong>: 将变换后的 AST 再转换为 JS 代码, 使⽤到的模块是 babel-generator。</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/06/29/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96/" data-id="cmcygiiyw000hvgur5vjyhqrw" data-title="前端工程化" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E3%80%81%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8/" rel="tag">前端工程、包管理器</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node-js/" rel="tag">Node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React/" rel="tag">React</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/html-css-javascript/" rel="tag">html css javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/typescript/" rel="tag">typescript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E3%80%81%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8/" rel="tag">前端工程、包管理器</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E3%80%81%E9%94%99%E8%AF%AF%E7%9B%91%E6%8E%A7%E3%80%81/" rel="tag">前端页面、错误监控、</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8E%9F%E7%90%86/" rel="tag">原理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9C%BA%E6%99%AF%E8%AE%BE%E8%AE%A1/" rel="tag">场景设计</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%A7%E6%A8%A1%E5%9E%8B/" rel="tag">大模型</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%EF%BC%8C%E6%B5%8F%E8%A7%88%E5%99%A8%E5%8E%9F%E7%90%86/" rel="tag">计算机网络，浏览器原理</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Node-js/" style="font-size: 10px;">Node.js</a> <a href="/tags/React/" style="font-size: 10px;">React</a> <a href="/tags/html-css-javascript/" style="font-size: 10px;">html css javascript</a> <a href="/tags/typescript/" style="font-size: 10px;">typescript</a> <a href="/tags/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E3%80%81%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8/" style="font-size: 10px;">前端工程、包管理器</a> <a href="/tags/%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E3%80%81%E9%94%99%E8%AF%AF%E7%9B%91%E6%8E%A7%E3%80%81/" style="font-size: 10px;">前端页面、错误监控、</a> <a href="/tags/%E5%8E%9F%E7%90%86/" style="font-size: 10px;">原理</a> <a href="/tags/%E5%9C%BA%E6%99%AF%E8%AE%BE%E8%AE%A1/" style="font-size: 10px;">场景设计</a> <a href="/tags/%E5%A4%A7%E6%A8%A1%E5%9E%8B/" style="font-size: 10px;">大模型</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%EF%BC%8C%E6%B5%8F%E8%A7%88%E5%99%A8%E5%8E%9F%E7%90%86/" style="font-size: 10px;">计算机网络，浏览器原理</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/07/">July 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/06/">June 2025</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/07/13/Koa/">Koa</a>
          </li>
        
          <li>
            <a href="/2025/07/12/React-Native/">React Native</a>
          </li>
        
          <li>
            <a href="/2025/07/04/%E4%B8%9A%E5%8A%A1/">业务</a>
          </li>
        
          <li>
            <a href="/2025/07/03/Vue/">Vue</a>
          </li>
        
          <li>
            <a href="/2025/07/01/AI/">AI</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>